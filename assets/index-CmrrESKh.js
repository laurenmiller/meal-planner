(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))o(u);new MutationObserver(u=>{for(const d of u)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function r(u){const d={};return u.integrity&&(d.integrity=u.integrity),u.referrerPolicy&&(d.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?d.credentials="include":u.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(u){if(u.ep)return;u.ep=!0;const d=r(u);fetch(u.href,d)}})();var xl={exports:{}},Zs={},bl={exports:{}},We={};var xd;function wp(){if(xd)return We;xd=1;var s=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),d=Symbol.for("react.provider"),f=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),E=Symbol.iterator;function j(k){return k===null||typeof k!="object"?null:(k=E&&k[E]||k["@@iterator"],typeof k=="function"?k:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,P={};function D(k,C,ce){this.props=k,this.context=C,this.refs=P,this.updater=ce||x}D.prototype.isReactComponent={},D.prototype.setState=function(k,C){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,C,"setState")},D.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function M(){}M.prototype=D.prototype;function W(k,C,ce){this.props=k,this.context=C,this.refs=P,this.updater=ce||x}var F=W.prototype=new M;F.constructor=W,A(F,D.prototype),F.isPureReactComponent=!0;var H=Array.isArray,ae=Object.prototype.hasOwnProperty,le={current:null},ie={key:!0,ref:!0,__self:!0,__source:!0};function be(k,C,ce){var pe,$={},oe=null,de=null;if(C!=null)for(pe in C.ref!==void 0&&(de=C.ref),C.key!==void 0&&(oe=""+C.key),C)ae.call(C,pe)&&!ie.hasOwnProperty(pe)&&($[pe]=C[pe]);var Ee=arguments.length-2;if(Ee===1)$.children=ce;else if(1<Ee){for(var Ne=Array(Ee),K=0;K<Ee;K++)Ne[K]=arguments[K+2];$.children=Ne}if(k&&k.defaultProps)for(pe in Ee=k.defaultProps,Ee)$[pe]===void 0&&($[pe]=Ee[pe]);return{$$typeof:s,type:k,key:oe,ref:de,props:$,_owner:le.current}}function je(k,C){return{$$typeof:s,type:k.type,key:C,ref:k.ref,props:k.props,_owner:k._owner}}function ye(k){return typeof k=="object"&&k!==null&&k.$$typeof===s}function Oe(k){var C={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(ce){return C[ce]})}var Le=/\/+/g;function ke(k,C){return typeof k=="object"&&k!==null&&k.key!=null?Oe(""+k.key):C.toString(36)}function Ue(k,C,ce,pe,$){var oe=typeof k;(oe==="undefined"||oe==="boolean")&&(k=null);var de=!1;if(k===null)de=!0;else switch(oe){case"string":case"number":de=!0;break;case"object":switch(k.$$typeof){case s:case n:de=!0}}if(de)return de=k,$=$(de),k=pe===""?"."+ke(de,0):pe,H($)?(ce="",k!=null&&(ce=k.replace(Le,"$&/")+"/"),Ue($,C,ce,"",function(K){return K})):$!=null&&(ye($)&&($=je($,ce+(!$.key||de&&de.key===$.key?"":(""+$.key).replace(Le,"$&/")+"/")+k)),C.push($)),1;if(de=0,pe=pe===""?".":pe+":",H(k))for(var Ee=0;Ee<k.length;Ee++){oe=k[Ee];var Ne=pe+ke(oe,Ee);de+=Ue(oe,C,ce,Ne,$)}else if(Ne=j(k),typeof Ne=="function")for(k=Ne.call(k),Ee=0;!(oe=k.next()).done;)oe=oe.value,Ne=pe+ke(oe,Ee++),de+=Ue(oe,C,ce,Ne,$);else if(oe==="object")throw C=String(k),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.");return de}function G(k,C,ce){if(k==null)return k;var pe=[],$=0;return Ue(k,pe,"","",function(oe){return C.call(ce,oe,$++)}),pe}function we(k){if(k._status===-1){var C=k._result;C=C(),C.then(function(ce){(k._status===0||k._status===-1)&&(k._status=1,k._result=ce)},function(ce){(k._status===0||k._status===-1)&&(k._status=2,k._result=ce)}),k._status===-1&&(k._status=0,k._result=C)}if(k._status===1)return k._result.default;throw k._result}var me={current:null},q={transition:null},ee={ReactCurrentDispatcher:me,ReactCurrentBatchConfig:q,ReactCurrentOwner:le};function R(){throw Error("act(...) is not supported in production builds of React.")}return We.Children={map:G,forEach:function(k,C,ce){G(k,function(){C.apply(this,arguments)},ce)},count:function(k){var C=0;return G(k,function(){C++}),C},toArray:function(k){return G(k,function(C){return C})||[]},only:function(k){if(!ye(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},We.Component=D,We.Fragment=r,We.Profiler=u,We.PureComponent=W,We.StrictMode=o,We.Suspense=g,We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,We.act=R,We.cloneElement=function(k,C,ce){if(k==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+k+".");var pe=A({},k.props),$=k.key,oe=k.ref,de=k._owner;if(C!=null){if(C.ref!==void 0&&(oe=C.ref,de=le.current),C.key!==void 0&&($=""+C.key),k.type&&k.type.defaultProps)var Ee=k.type.defaultProps;for(Ne in C)ae.call(C,Ne)&&!ie.hasOwnProperty(Ne)&&(pe[Ne]=C[Ne]===void 0&&Ee!==void 0?Ee[Ne]:C[Ne])}var Ne=arguments.length-2;if(Ne===1)pe.children=ce;else if(1<Ne){Ee=Array(Ne);for(var K=0;K<Ne;K++)Ee[K]=arguments[K+2];pe.children=Ee}return{$$typeof:s,type:k.type,key:$,ref:oe,props:pe,_owner:de}},We.createContext=function(k){return k={$$typeof:f,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},k.Provider={$$typeof:d,_context:k},k.Consumer=k},We.createElement=be,We.createFactory=function(k){var C=be.bind(null,k);return C.type=k,C},We.createRef=function(){return{current:null}},We.forwardRef=function(k){return{$$typeof:p,render:k}},We.isValidElement=ye,We.lazy=function(k){return{$$typeof:y,_payload:{_status:-1,_result:k},_init:we}},We.memo=function(k,C){return{$$typeof:v,type:k,compare:C===void 0?null:C}},We.startTransition=function(k){var C=q.transition;q.transition={};try{k()}finally{q.transition=C}},We.unstable_act=R,We.useCallback=function(k,C){return me.current.useCallback(k,C)},We.useContext=function(k){return me.current.useContext(k)},We.useDebugValue=function(){},We.useDeferredValue=function(k){return me.current.useDeferredValue(k)},We.useEffect=function(k,C){return me.current.useEffect(k,C)},We.useId=function(){return me.current.useId()},We.useImperativeHandle=function(k,C,ce){return me.current.useImperativeHandle(k,C,ce)},We.useInsertionEffect=function(k,C){return me.current.useInsertionEffect(k,C)},We.useLayoutEffect=function(k,C){return me.current.useLayoutEffect(k,C)},We.useMemo=function(k,C){return me.current.useMemo(k,C)},We.useReducer=function(k,C,ce){return me.current.useReducer(k,C,ce)},We.useRef=function(k){return me.current.useRef(k)},We.useState=function(k){return me.current.useState(k)},We.useSyncExternalStore=function(k,C,ce){return me.current.useSyncExternalStore(k,C,ce)},We.useTransition=function(){return me.current.useTransition()},We.version="18.3.1",We}var bd;function Jl(){return bd||(bd=1,bl.exports=wp()),bl.exports}var jd;function _p(){if(jd)return Zs;jd=1;var s=Jl(),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function f(p,g,v){var y,E={},j=null,x=null;v!==void 0&&(j=""+v),g.key!==void 0&&(j=""+g.key),g.ref!==void 0&&(x=g.ref);for(y in g)o.call(g,y)&&!d.hasOwnProperty(y)&&(E[y]=g[y]);if(p&&p.defaultProps)for(y in g=p.defaultProps,g)E[y]===void 0&&(E[y]=g[y]);return{$$typeof:n,type:p,key:j,ref:x,props:E,_owner:u.current}}return Zs.Fragment=r,Zs.jsx=f,Zs.jsxs=f,Zs}var Nd;function kp(){return Nd||(Nd=1,xl.exports=_p()),xl.exports}var l=kp(),O=Jl(),Sa={},jl={exports:{}},Mt={},Nl={exports:{}},El={};var Ed;function Sp(){return Ed||(Ed=1,(function(s){function n(q,ee){var R=q.length;q.push(ee);e:for(;0<R;){var k=R-1>>>1,C=q[k];if(0<u(C,ee))q[k]=ee,q[R]=C,R=k;else break e}}function r(q){return q.length===0?null:q[0]}function o(q){if(q.length===0)return null;var ee=q[0],R=q.pop();if(R!==ee){q[0]=R;e:for(var k=0,C=q.length,ce=C>>>1;k<ce;){var pe=2*(k+1)-1,$=q[pe],oe=pe+1,de=q[oe];if(0>u($,R))oe<C&&0>u(de,$)?(q[k]=de,q[oe]=R,k=oe):(q[k]=$,q[pe]=R,k=pe);else if(oe<C&&0>u(de,R))q[k]=de,q[oe]=R,k=oe;else break e}}return ee}function u(q,ee){var R=q.sortIndex-ee.sortIndex;return R!==0?R:q.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;s.unstable_now=function(){return d.now()}}else{var f=Date,p=f.now();s.unstable_now=function(){return f.now()-p}}var g=[],v=[],y=1,E=null,j=3,x=!1,A=!1,P=!1,D=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(q){for(var ee=r(v);ee!==null;){if(ee.callback===null)o(v);else if(ee.startTime<=q)o(v),ee.sortIndex=ee.expirationTime,n(g,ee);else break;ee=r(v)}}function H(q){if(P=!1,F(q),!A)if(r(g)!==null)A=!0,we(ae);else{var ee=r(v);ee!==null&&me(H,ee.startTime-q)}}function ae(q,ee){A=!1,P&&(P=!1,M(be),be=-1),x=!0;var R=j;try{for(F(ee),E=r(g);E!==null&&(!(E.expirationTime>ee)||q&&!Oe());){var k=E.callback;if(typeof k=="function"){E.callback=null,j=E.priorityLevel;var C=k(E.expirationTime<=ee);ee=s.unstable_now(),typeof C=="function"?E.callback=C:E===r(g)&&o(g),F(ee)}else o(g);E=r(g)}if(E!==null)var ce=!0;else{var pe=r(v);pe!==null&&me(H,pe.startTime-ee),ce=!1}return ce}finally{E=null,j=R,x=!1}}var le=!1,ie=null,be=-1,je=5,ye=-1;function Oe(){return!(s.unstable_now()-ye<je)}function Le(){if(ie!==null){var q=s.unstable_now();ye=q;var ee=!0;try{ee=ie(!0,q)}finally{ee?ke():(le=!1,ie=null)}}else le=!1}var ke;if(typeof W=="function")ke=function(){W(Le)};else if(typeof MessageChannel<"u"){var Ue=new MessageChannel,G=Ue.port2;Ue.port1.onmessage=Le,ke=function(){G.postMessage(null)}}else ke=function(){D(Le,0)};function we(q){ie=q,le||(le=!0,ke())}function me(q,ee){be=D(function(){q(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(q){q.callback=null},s.unstable_continueExecution=function(){A||x||(A=!0,we(ae))},s.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):je=0<q?Math.floor(1e3/q):5},s.unstable_getCurrentPriorityLevel=function(){return j},s.unstable_getFirstCallbackNode=function(){return r(g)},s.unstable_next=function(q){switch(j){case 1:case 2:case 3:var ee=3;break;default:ee=j}var R=j;j=ee;try{return q()}finally{j=R}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(q,ee){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var R=j;j=q;try{return ee()}finally{j=R}},s.unstable_scheduleCallback=function(q,ee,R){var k=s.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?k+R:k):R=k,q){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=R+C,q={id:y++,callback:ee,priorityLevel:q,startTime:R,expirationTime:C,sortIndex:-1},R>k?(q.sortIndex=R,n(v,q),r(g)===null&&q===r(v)&&(P?(M(be),be=-1):P=!0,me(H,R-k))):(q.sortIndex=C,n(g,q),A||x||(A=!0,we(ae))),q},s.unstable_shouldYield=Oe,s.unstable_wrapCallback=function(q){var ee=j;return function(){var R=j;j=ee;try{return q.apply(this,arguments)}finally{j=R}}}})(El)),El}var Cd;function xp(){return Cd||(Cd=1,Nl.exports=Sp()),Nl.exports}var Td;function bp(){if(Td)return Mt;Td=1;var s=Jl(),n=xp();function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function d(e,t){f(e,t),f(e+"Capture",t)}function f(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var p=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),g=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},E={};function j(e){return g.call(E,e)?!0:g.call(y,e)?!1:v.test(e)?E[e]=!0:(y[e]=!0,!1)}function x(e,t,i,a){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function A(e,t,i,a){if(t===null||typeof t>"u"||x(e,t,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function P(e,t,i,a,c,h,m){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=c,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=h,this.removeEmptyString=m}var D={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){D[e]=new P(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];D[t]=new P(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){D[e]=new P(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){D[e]=new P(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){D[e]=new P(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){D[e]=new P(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){D[e]=new P(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){D[e]=new P(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){D[e]=new P(e,5,!1,e.toLowerCase(),null,!1,!1)});var M=/[\-:]([a-z])/g;function W(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(M,W);D[t]=new P(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(M,W);D[t]=new P(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(M,W);D[t]=new P(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){D[e]=new P(e,1,!1,e.toLowerCase(),null,!1,!1)}),D.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){D[e]=new P(e,1,!1,e.toLowerCase(),null,!0,!0)});function F(e,t,i,a){var c=D.hasOwnProperty(t)?D[t]:null;(c!==null?c.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(A(t,i,c,a)&&(i=null),a||c===null?j(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):c.mustUseProperty?e[c.propertyName]=i===null?c.type===3?!1:"":i:(t=c.attributeName,a=c.attributeNamespace,i===null?e.removeAttribute(t):(c=c.type,i=c===3||c===4&&i===!0?"":""+i,a?e.setAttributeNS(a,t,i):e.setAttribute(t,i))))}var H=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ae=Symbol.for("react.element"),le=Symbol.for("react.portal"),ie=Symbol.for("react.fragment"),be=Symbol.for("react.strict_mode"),je=Symbol.for("react.profiler"),ye=Symbol.for("react.provider"),Oe=Symbol.for("react.context"),Le=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),Ue=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),we=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),q=Symbol.iterator;function ee(e){return e===null||typeof e!="object"?null:(e=q&&e[q]||e["@@iterator"],typeof e=="function"?e:null)}var R=Object.assign,k;function C(e){if(k===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);k=t&&t[1]||""}return`
`+k+e}var ce=!1;function pe(e,t){if(!e||ce)return"";ce=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(L){var a=L}Reflect.construct(e,[],t)}else{try{t.call()}catch(L){a=L}e.call(t.prototype)}else{try{throw Error()}catch(L){a=L}e()}}catch(L){if(L&&a&&typeof L.stack=="string"){for(var c=L.stack.split(`
`),h=a.stack.split(`
`),m=c.length-1,w=h.length-1;1<=m&&0<=w&&c[m]!==h[w];)w--;for(;1<=m&&0<=w;m--,w--)if(c[m]!==h[w]){if(m!==1||w!==1)do if(m--,w--,0>w||c[m]!==h[w]){var S=`
`+c[m].replace(" at new "," at ");return e.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",e.displayName)),S}while(1<=m&&0<=w);break}}}finally{ce=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?C(e):""}function $(e){switch(e.tag){case 5:return C(e.type);case 16:return C("Lazy");case 13:return C("Suspense");case 19:return C("SuspenseList");case 0:case 2:case 15:return e=pe(e.type,!1),e;case 11:return e=pe(e.type.render,!1),e;case 1:return e=pe(e.type,!0),e;default:return""}}function oe(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ie:return"Fragment";case le:return"Portal";case je:return"Profiler";case be:return"StrictMode";case ke:return"Suspense";case Ue:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Oe:return(e.displayName||"Context")+".Consumer";case ye:return(e._context.displayName||"Context")+".Provider";case Le:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case G:return t=e.displayName||null,t!==null?t:oe(e.type)||"Memo";case we:t=e._payload,e=e._init;try{return oe(e(t))}catch{}}return null}function de(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oe(t);case 8:return t===be?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ee(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ne(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function K(e){var t=Ne(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var c=i.get,h=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(m){a=""+m,h.call(this,m)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(m){a=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function he(e){e._valueTracker||(e._valueTracker=K(e))}function V(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),a="";return e&&(a=Ne(e)?e.checked?"true":"false":e.value),e=a,e!==i?(t.setValue(e),!0):!1}function re(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function X(e,t){var i=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function se(e,t){var i=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;i=Ee(t.value!=null?t.value:i),e._wrapperState={initialChecked:a,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fe(e,t){t=t.checked,t!=null&&F(e,"checked",t,!1)}function ot(e,t){Fe(e,t);var i=Ee(t.value),a=t.type;if(i!=null)a==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?St(e,t.type,i):t.hasOwnProperty("defaultValue")&&St(e,t.type,Ee(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Rt(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function St(e,t,i){(t!=="number"||re(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var mt=Array.isArray;function z(e,t,i,a){if(e=e.options,t){t={};for(var c=0;c<i.length;c++)t["$"+i[c]]=!0;for(i=0;i<e.length;i++)c=t.hasOwnProperty("$"+e[i].value),e[i].selected!==c&&(e[i].selected=c),c&&a&&(e[i].defaultSelected=!0)}else{for(i=""+Ee(i),t=null,c=0;c<e.length;c++){if(e[c].value===i){e[c].selected=!0,a&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Ie(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(r(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Be(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(r(92));if(mt(i)){if(1<i.length)throw Error(r(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Ee(i)}}function Ge(e,t){var i=Ee(t.value),a=Ee(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),a!=null&&(e.defaultValue=""+a)}function Ze(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sn(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bn(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sn(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var an,$n=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,a,c){MSApp.execUnsafeLocalFunction(function(){return e(t,i,a,c)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(an=an||document.createElement("div"),an.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=an.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qt(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var Wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jn=["Webkit","ms","Moz","O"];Object.keys(Wt).forEach(function(e){jn.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wt[t]=Wt[e]})});function zn(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||Wt.hasOwnProperty(e)&&Wt[e]?(""+t).trim():t+"px"}function Q(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var a=i.indexOf("--")===0,c=zn(i,t[i],a);i==="float"&&(i="cssFloat"),a?e.setProperty(i,c):e[i]=c}}var Te=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ve(e,t){if(t){if(Te[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(r(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(r(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(t.style!=null&&typeof t.style!="object")throw Error(r(62))}}function Je(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nn=null;function on(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ur=null,vn=null,yn=null;function dr(e){if(e=$s(e)){if(typeof ur!="function")throw Error(r(280));var t=e.stateNode;t&&(t=Ui(t),ur(e.stateNode,e.type,t))}}function hr(e){vn?yn?yn.push(e):yn=[e]:vn=e}function fr(){if(vn){var e=vn,t=yn;if(yn=vn=null,dr(e),t)for(e=0;e<t.length;e++)dr(t[e])}}function Fn(e,t){return e(t)}function Bn(){}var pr=!1;function B(e,t,i){if(pr)return e(t,i);pr=!0;try{return Fn(e,t,i)}finally{pr=!1,(vn!==null||yn!==null)&&(Bn(),fr())}}function Ce(e,t){var i=e.stateNode;if(i===null)return null;var a=Ui(i);if(a===null)return null;i=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(r(231,t,typeof i));return i}var Me=!1;if(p)try{var Xe={};Object.defineProperty(Xe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Xe,Xe),window.removeEventListener("test",Xe,Xe)}catch{Me=!1}function wn(e,t,i,a,c,h,m,w,S){var L=Array.prototype.slice.call(arguments,3);try{t.apply(i,L)}catch(Y){this.onError(Y)}}var yt=!1,Ur=null,mr=!1,$r=null,hi={onError:function(e){yt=!0,Ur=e}};function fi(e,t,i,a,c,h,m,w,S){yt=!1,Ur=null,wn.apply(hi,arguments)}function pi(e,t,i,a,c,h,m,w,S){if(fi.apply(this,arguments),yt){if(yt){var L=Ur;yt=!1,Ur=null}else throw Error(r(198));mr||(mr=!0,$r=L)}}function En(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function mi(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gi(e){if(En(e)!==e)throw Error(r(188))}function $a(e){var t=e.alternate;if(!t){if(t=En(e),t===null)throw Error(r(188));return t!==e?null:e}for(var i=e,a=t;;){var c=i.return;if(c===null)break;var h=c.alternate;if(h===null){if(a=c.return,a!==null){i=a;continue}break}if(c.child===h.child){for(h=c.child;h;){if(h===i)return gi(c),e;if(h===a)return gi(c),t;h=h.sibling}throw Error(r(188))}if(i.return!==a.return)i=c,a=h;else{for(var m=!1,w=c.child;w;){if(w===i){m=!0,i=c,a=h;break}if(w===a){m=!0,a=c,i=h;break}w=w.sibling}if(!m){for(w=h.child;w;){if(w===i){m=!0,i=h,a=c;break}if(w===a){m=!0,a=h,i=c;break}w=w.sibling}if(!m)throw Error(r(189))}}if(i.alternate!==a)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?e:t}function vi(e){return e=$a(e),e!==null?yi(e):null}function yi(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yi(e);if(t!==null)return t;e=e.sibling}return null}var wi=n.unstable_scheduleCallback,_s=n.unstable_cancelCallback,_i=n.unstable_shouldYield,za=n.unstable_requestPaint,_=n.unstable_now,N=n.unstable_getCurrentPriorityLevel,U=n.unstable_ImmediatePriority,te=n.unstable_UserBlockingPriority,$e=n.unstable_NormalPriority,rt=n.unstable_LowPriority,Qe=n.unstable_IdlePriority,qe=null,Ke=null;function Yt(e){if(Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(qe,e,void 0,(e.current.flags&128)===128)}catch{}}var ft=Math.clz32?Math.clz32:Ma,Fa=Math.log,Ba=Math.LN2;function Ma(e){return e>>>=0,e===0?32:31-(Fa(e)/Ba|0)|0}var zr=64,gr=4194304;function vr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ki(e,t){var i=e.pendingLanes;if(i===0)return 0;var a=0,c=e.suspendedLanes,h=e.pingedLanes,m=i&268435455;if(m!==0){var w=m&~c;w!==0?a=vr(w):(h&=m,h!==0&&(a=vr(h)))}else m=i&~c,m!==0?a=vr(m):h!==0&&(a=vr(h));if(a===0)return 0;if(t!==0&&t!==a&&(t&c)===0&&(c=a&-a,h=t&-t,c>=h||c===16&&(h&4194240)!==0))return t;if((a&4)!==0&&(a|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)i=31-ft(t),c=1<<i,a|=e[i],t&=~c;return a}function Uh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $h(e,t){for(var i=e.suspendedLanes,a=e.pingedLanes,c=e.expirationTimes,h=e.pendingLanes;0<h;){var m=31-ft(h),w=1<<m,S=c[m];S===-1?((w&i)===0||(w&a)!==0)&&(c[m]=Uh(w,t)):S<=t&&(e.expiredLanes|=w),h&=~w}}function Wa(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ec(){var e=zr;return zr<<=1,(zr&4194240)===0&&(zr=64),e}function qa(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function ks(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ft(t),e[t]=i}function zh(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<i;){var c=31-ft(i),h=1<<c;t[c]=0,a[c]=-1,e[c]=-1,i&=~h}}function Ka(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var a=31-ft(i),c=1<<a;c&t|e[a]&t&&(e[a]|=t),i&=~c}}var et=0;function tc(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var nc,Va,rc,sc,ic,Ha=!1,Si=[],Mn=null,Wn=null,qn=null,Ss=new Map,xs=new Map,Kn=[],Fh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ac(e,t){switch(e){case"focusin":case"focusout":Mn=null;break;case"dragenter":case"dragleave":Wn=null;break;case"mouseover":case"mouseout":qn=null;break;case"pointerover":case"pointerout":Ss.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xs.delete(t.pointerId)}}function bs(e,t,i,a,c,h){return e===null||e.nativeEvent!==h?(e={blockedOn:t,domEventName:i,eventSystemFlags:a,nativeEvent:h,targetContainers:[c]},t!==null&&(t=$s(t),t!==null&&Va(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function Bh(e,t,i,a,c){switch(t){case"focusin":return Mn=bs(Mn,e,t,i,a,c),!0;case"dragenter":return Wn=bs(Wn,e,t,i,a,c),!0;case"mouseover":return qn=bs(qn,e,t,i,a,c),!0;case"pointerover":var h=c.pointerId;return Ss.set(h,bs(Ss.get(h)||null,e,t,i,a,c)),!0;case"gotpointercapture":return h=c.pointerId,xs.set(h,bs(xs.get(h)||null,e,t,i,a,c)),!0}return!1}function oc(e){var t=yr(e.target);if(t!==null){var i=En(t);if(i!==null){if(t=i.tag,t===13){if(t=mi(i),t!==null){e.blockedOn=t,ic(e.priority,function(){rc(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=Ja(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var a=new i.constructor(i.type,i);Nn=a,i.target.dispatchEvent(a),Nn=null}else return t=$s(i),t!==null&&Va(t),e.blockedOn=i,!1;t.shift()}return!0}function lc(e,t,i){xi(e)&&i.delete(t)}function Mh(){Ha=!1,Mn!==null&&xi(Mn)&&(Mn=null),Wn!==null&&xi(Wn)&&(Wn=null),qn!==null&&xi(qn)&&(qn=null),Ss.forEach(lc),xs.forEach(lc)}function js(e,t){e.blockedOn===t&&(e.blockedOn=null,Ha||(Ha=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Mh)))}function Ns(e){function t(c){return js(c,e)}if(0<Si.length){js(Si[0],e);for(var i=1;i<Si.length;i++){var a=Si[i];a.blockedOn===e&&(a.blockedOn=null)}}for(Mn!==null&&js(Mn,e),Wn!==null&&js(Wn,e),qn!==null&&js(qn,e),Ss.forEach(t),xs.forEach(t),i=0;i<Kn.length;i++)a=Kn[i],a.blockedOn===e&&(a.blockedOn=null);for(;0<Kn.length&&(i=Kn[0],i.blockedOn===null);)oc(i),i.blockedOn===null&&Kn.shift()}var Fr=H.ReactCurrentBatchConfig,bi=!0;function Wh(e,t,i,a){var c=et,h=Fr.transition;Fr.transition=null;try{et=1,Ga(e,t,i,a)}finally{et=c,Fr.transition=h}}function qh(e,t,i,a){var c=et,h=Fr.transition;Fr.transition=null;try{et=4,Ga(e,t,i,a)}finally{et=c,Fr.transition=h}}function Ga(e,t,i,a){if(bi){var c=Ja(e,t,i,a);if(c===null)fo(e,t,a,ji,i),ac(e,a);else if(Bh(c,e,t,i,a))a.stopPropagation();else if(ac(e,a),t&4&&-1<Fh.indexOf(e)){for(;c!==null;){var h=$s(c);if(h!==null&&nc(h),h=Ja(e,t,i,a),h===null&&fo(e,t,a,ji,i),h===c)break;c=h}c!==null&&a.stopPropagation()}else fo(e,t,a,null,i)}}var ji=null;function Ja(e,t,i,a){if(ji=null,e=on(a),e=yr(e),e!==null)if(t=En(e),t===null)e=null;else if(i=t.tag,i===13){if(e=mi(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ji=e,null}function cc(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(N()){case U:return 1;case te:return 4;case $e:case rt:return 16;case Qe:return 536870912;default:return 16}default:return 16}}var Vn=null,Qa=null,Ni=null;function uc(){if(Ni)return Ni;var e,t=Qa,i=t.length,a,c="value"in Vn?Vn.value:Vn.textContent,h=c.length;for(e=0;e<i&&t[e]===c[e];e++);var m=i-e;for(a=1;a<=m&&t[i-a]===c[h-a];a++);return Ni=c.slice(e,1<a?1-a:void 0)}function Ei(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ci(){return!0}function dc(){return!1}function qt(e){function t(i,a,c,h,m){this._reactName=i,this._targetInst=c,this.type=a,this.nativeEvent=h,this.target=m,this.currentTarget=null;for(var w in e)e.hasOwnProperty(w)&&(i=e[w],this[w]=i?i(h):h[w]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?Ci:dc,this.isPropagationStopped=dc,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Ci)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Ci)},persist:function(){},isPersistent:Ci}),t}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ya=qt(Br),Es=R({},Br,{view:0,detail:0}),Kh=qt(Es),Xa,Za,Cs,Ti=R({},Es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:to,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Cs&&(Cs&&e.type==="mousemove"?(Xa=e.screenX-Cs.screenX,Za=e.screenY-Cs.screenY):Za=Xa=0,Cs=e),Xa)},movementY:function(e){return"movementY"in e?e.movementY:Za}}),hc=qt(Ti),Vh=R({},Ti,{dataTransfer:0}),Hh=qt(Vh),Gh=R({},Es,{relatedTarget:0}),eo=qt(Gh),Jh=R({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),Qh=qt(Jh),Yh=R({},Br,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xh=qt(Yh),Zh=R({},Br,{data:0}),fc=qt(Zh),ef={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rf(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=nf[e])?!!t[e]:!1}function to(){return rf}var sf=R({},Es,{key:function(e){if(e.key){var t=ef[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ei(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?tf[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:to,charCode:function(e){return e.type==="keypress"?Ei(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ei(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),af=qt(sf),of=R({},Ti,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pc=qt(of),lf=R({},Es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:to}),cf=qt(lf),uf=R({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),df=qt(uf),hf=R({},Ti,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ff=qt(hf),pf=[9,13,27,32],no=p&&"CompositionEvent"in window,Ts=null;p&&"documentMode"in document&&(Ts=document.documentMode);var mf=p&&"TextEvent"in window&&!Ts,mc=p&&(!no||Ts&&8<Ts&&11>=Ts),gc=" ",vc=!1;function yc(e,t){switch(e){case"keyup":return pf.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wc(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mr=!1;function gf(e,t){switch(e){case"compositionend":return wc(t);case"keypress":return t.which!==32?null:(vc=!0,gc);case"textInput":return e=t.data,e===gc&&vc?null:e;default:return null}}function vf(e,t){if(Mr)return e==="compositionend"||!no&&yc(e,t)?(e=uc(),Ni=Qa=Vn=null,Mr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mc&&t.locale!=="ko"?null:t.data;default:return null}}var yf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _c(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!yf[e.type]:t==="textarea"}function kc(e,t,i,a){hr(a),t=Ai(t,"onChange"),0<t.length&&(i=new Ya("onChange","change",null,i,a),e.push({event:i,listeners:t}))}var Rs=null,Ps=null;function wf(e){zc(e,0)}function Ri(e){var t=Hr(e);if(V(t))return e}function _f(e,t){if(e==="change")return t}var Sc=!1;if(p){var ro;if(p){var so="oninput"in document;if(!so){var xc=document.createElement("div");xc.setAttribute("oninput","return;"),so=typeof xc.oninput=="function"}ro=so}else ro=!1;Sc=ro&&(!document.documentMode||9<document.documentMode)}function bc(){Rs&&(Rs.detachEvent("onpropertychange",jc),Ps=Rs=null)}function jc(e){if(e.propertyName==="value"&&Ri(Ps)){var t=[];kc(t,Ps,e,on(e)),B(wf,t)}}function kf(e,t,i){e==="focusin"?(bc(),Rs=t,Ps=i,Rs.attachEvent("onpropertychange",jc)):e==="focusout"&&bc()}function Sf(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ri(Ps)}function xf(e,t){if(e==="click")return Ri(t)}function bf(e,t){if(e==="input"||e==="change")return Ri(t)}function jf(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ln=typeof Object.is=="function"?Object.is:jf;function Os(e,t){if(ln(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var c=i[a];if(!g.call(t,c)||!ln(e[c],t[c]))return!1}return!0}function Nc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ec(e,t){var i=Nc(e);e=0;for(var a;i;){if(i.nodeType===3){if(a=e+i.textContent.length,e<=t&&a>=t)return{node:i,offset:t-e};e=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Nc(i)}}function Cc(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cc(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Tc(){for(var e=window,t=re();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=re(e.document)}return t}function io(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Nf(e){var t=Tc(),i=e.focusedElem,a=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&Cc(i.ownerDocument.documentElement,i)){if(a!==null&&io(i)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var c=i.textContent.length,h=Math.min(a.start,c);a=a.end===void 0?h:Math.min(a.end,c),!e.extend&&h>a&&(c=a,a=h,h=c),c=Ec(i,h);var m=Ec(i,a);c&&m&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==m.node||e.focusOffset!==m.offset)&&(t=t.createRange(),t.setStart(c.node,c.offset),e.removeAllRanges(),h>a?(e.addRange(t),e.extend(m.node,m.offset)):(t.setEnd(m.node,m.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ef=p&&"documentMode"in document&&11>=document.documentMode,Wr=null,ao=null,Is=null,oo=!1;function Rc(e,t,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;oo||Wr==null||Wr!==re(a)||(a=Wr,"selectionStart"in a&&io(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Is&&Os(Is,a)||(Is=a,a=Ai(ao,"onSelect"),0<a.length&&(t=new Ya("onSelect","select",null,t,i),e.push({event:t,listeners:a}),t.target=Wr)))}function Pi(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var qr={animationend:Pi("Animation","AnimationEnd"),animationiteration:Pi("Animation","AnimationIteration"),animationstart:Pi("Animation","AnimationStart"),transitionend:Pi("Transition","TransitionEnd")},lo={},Pc={};p&&(Pc=document.createElement("div").style,"AnimationEvent"in window||(delete qr.animationend.animation,delete qr.animationiteration.animation,delete qr.animationstart.animation),"TransitionEvent"in window||delete qr.transitionend.transition);function Oi(e){if(lo[e])return lo[e];if(!qr[e])return e;var t=qr[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in Pc)return lo[e]=t[i];return e}var Oc=Oi("animationend"),Ic=Oi("animationiteration"),Ac=Oi("animationstart"),Lc=Oi("transitionend"),Dc=new Map,Uc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hn(e,t){Dc.set(e,t),d(t,[e])}for(var co=0;co<Uc.length;co++){var uo=Uc[co],Cf=uo.toLowerCase(),Tf=uo[0].toUpperCase()+uo.slice(1);Hn(Cf,"on"+Tf)}Hn(Oc,"onAnimationEnd"),Hn(Ic,"onAnimationIteration"),Hn(Ac,"onAnimationStart"),Hn("dblclick","onDoubleClick"),Hn("focusin","onFocus"),Hn("focusout","onBlur"),Hn(Lc,"onTransitionEnd"),f("onMouseEnter",["mouseout","mouseover"]),f("onMouseLeave",["mouseout","mouseover"]),f("onPointerEnter",["pointerout","pointerover"]),f("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var As="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rf=new Set("cancel close invalid load scroll toggle".split(" ").concat(As));function $c(e,t,i){var a=e.type||"unknown-event";e.currentTarget=i,pi(a,t,void 0,e),e.currentTarget=null}function zc(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var a=e[i],c=a.event;a=a.listeners;e:{var h=void 0;if(t)for(var m=a.length-1;0<=m;m--){var w=a[m],S=w.instance,L=w.currentTarget;if(w=w.listener,S!==h&&c.isPropagationStopped())break e;$c(c,w,L),h=S}else for(m=0;m<a.length;m++){if(w=a[m],S=w.instance,L=w.currentTarget,w=w.listener,S!==h&&c.isPropagationStopped())break e;$c(c,w,L),h=S}}}if(mr)throw e=$r,mr=!1,$r=null,e}function st(e,t){var i=t[wo];i===void 0&&(i=t[wo]=new Set);var a=e+"__bubble";i.has(a)||(Fc(t,e,2,!1),i.add(a))}function ho(e,t,i){var a=0;t&&(a|=4),Fc(i,e,a,t)}var Ii="_reactListening"+Math.random().toString(36).slice(2);function Ls(e){if(!e[Ii]){e[Ii]=!0,o.forEach(function(i){i!=="selectionchange"&&(Rf.has(i)||ho(i,!1,e),ho(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ii]||(t[Ii]=!0,ho("selectionchange",!1,t))}}function Fc(e,t,i,a){switch(cc(t)){case 1:var c=Wh;break;case 4:c=qh;break;default:c=Ga}i=c.bind(null,t,i,e),c=void 0,!Me||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),a?c!==void 0?e.addEventListener(t,i,{capture:!0,passive:c}):e.addEventListener(t,i,!0):c!==void 0?e.addEventListener(t,i,{passive:c}):e.addEventListener(t,i,!1)}function fo(e,t,i,a,c){var h=a;if((t&1)===0&&(t&2)===0&&a!==null)e:for(;;){if(a===null)return;var m=a.tag;if(m===3||m===4){var w=a.stateNode.containerInfo;if(w===c||w.nodeType===8&&w.parentNode===c)break;if(m===4)for(m=a.return;m!==null;){var S=m.tag;if((S===3||S===4)&&(S=m.stateNode.containerInfo,S===c||S.nodeType===8&&S.parentNode===c))return;m=m.return}for(;w!==null;){if(m=yr(w),m===null)return;if(S=m.tag,S===5||S===6){a=h=m;continue e}w=w.parentNode}}a=a.return}B(function(){var L=h,Y=on(i),Z=[];e:{var J=Dc.get(e);if(J!==void 0){var fe=Ya,ve=e;switch(e){case"keypress":if(Ei(i)===0)break e;case"keydown":case"keyup":fe=af;break;case"focusin":ve="focus",fe=eo;break;case"focusout":ve="blur",fe=eo;break;case"beforeblur":case"afterblur":fe=eo;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Hh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=cf;break;case Oc:case Ic:case Ac:fe=Qh;break;case Lc:fe=df;break;case"scroll":fe=Kh;break;case"wheel":fe=ff;break;case"copy":case"cut":case"paste":fe=Xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=pc}var _e=(t&4)!==0,pt=!_e&&e==="scroll",T=_e?J!==null?J+"Capture":null:J;_e=[];for(var b=L,I;b!==null;){I=b;var ne=I.stateNode;if(I.tag===5&&ne!==null&&(I=ne,T!==null&&(ne=Ce(b,T),ne!=null&&_e.push(Ds(b,ne,I)))),pt)break;b=b.return}0<_e.length&&(J=new fe(J,ve,null,i,Y),Z.push({event:J,listeners:_e}))}}if((t&7)===0){e:{if(J=e==="mouseover"||e==="pointerover",fe=e==="mouseout"||e==="pointerout",J&&i!==Nn&&(ve=i.relatedTarget||i.fromElement)&&(yr(ve)||ve[Cn]))break e;if((fe||J)&&(J=Y.window===Y?Y:(J=Y.ownerDocument)?J.defaultView||J.parentWindow:window,fe?(ve=i.relatedTarget||i.toElement,fe=L,ve=ve?yr(ve):null,ve!==null&&(pt=En(ve),ve!==pt||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(fe=null,ve=L),fe!==ve)){if(_e=hc,ne="onMouseLeave",T="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(_e=pc,ne="onPointerLeave",T="onPointerEnter",b="pointer"),pt=fe==null?J:Hr(fe),I=ve==null?J:Hr(ve),J=new _e(ne,b+"leave",fe,i,Y),J.target=pt,J.relatedTarget=I,ne=null,yr(Y)===L&&(_e=new _e(T,b+"enter",ve,i,Y),_e.target=I,_e.relatedTarget=pt,ne=_e),pt=ne,fe&&ve)t:{for(_e=fe,T=ve,b=0,I=_e;I;I=Kr(I))b++;for(I=0,ne=T;ne;ne=Kr(ne))I++;for(;0<b-I;)_e=Kr(_e),b--;for(;0<I-b;)T=Kr(T),I--;for(;b--;){if(_e===T||T!==null&&_e===T.alternate)break t;_e=Kr(_e),T=Kr(T)}_e=null}else _e=null;fe!==null&&Bc(Z,J,fe,_e,!1),ve!==null&&pt!==null&&Bc(Z,pt,ve,_e,!0)}}e:{if(J=L?Hr(L):window,fe=J.nodeName&&J.nodeName.toLowerCase(),fe==="select"||fe==="input"&&J.type==="file")var Se=_f;else if(_c(J))if(Sc)Se=bf;else{Se=Sf;var Re=kf}else(fe=J.nodeName)&&fe.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(Se=xf);if(Se&&(Se=Se(e,L))){kc(Z,Se,i,Y);break e}Re&&Re(e,J,L),e==="focusout"&&(Re=J._wrapperState)&&Re.controlled&&J.type==="number"&&St(J,"number",J.value)}switch(Re=L?Hr(L):window,e){case"focusin":(_c(Re)||Re.contentEditable==="true")&&(Wr=Re,ao=L,Is=null);break;case"focusout":Is=ao=Wr=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,Rc(Z,i,Y);break;case"selectionchange":if(Ef)break;case"keydown":case"keyup":Rc(Z,i,Y)}var Pe;if(no)e:{switch(e){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else Mr?yc(e,i)&&(ze="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(ze="onCompositionStart");ze&&(mc&&i.locale!=="ko"&&(Mr||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&Mr&&(Pe=uc()):(Vn=Y,Qa="value"in Vn?Vn.value:Vn.textContent,Mr=!0)),Re=Ai(L,ze),0<Re.length&&(ze=new fc(ze,e,null,i,Y),Z.push({event:ze,listeners:Re}),Pe?ze.data=Pe:(Pe=wc(i),Pe!==null&&(ze.data=Pe)))),(Pe=mf?gf(e,i):vf(e,i))&&(L=Ai(L,"onBeforeInput"),0<L.length&&(Y=new fc("onBeforeInput","beforeinput",null,i,Y),Z.push({event:Y,listeners:L}),Y.data=Pe))}zc(Z,t)})}function Ds(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Ai(e,t){for(var i=t+"Capture",a=[];e!==null;){var c=e,h=c.stateNode;c.tag===5&&h!==null&&(c=h,h=Ce(e,i),h!=null&&a.unshift(Ds(e,h,c)),h=Ce(e,t),h!=null&&a.push(Ds(e,h,c))),e=e.return}return a}function Kr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Bc(e,t,i,a,c){for(var h=t._reactName,m=[];i!==null&&i!==a;){var w=i,S=w.alternate,L=w.stateNode;if(S!==null&&S===a)break;w.tag===5&&L!==null&&(w=L,c?(S=Ce(i,h),S!=null&&m.unshift(Ds(i,S,w))):c||(S=Ce(i,h),S!=null&&m.push(Ds(i,S,w)))),i=i.return}m.length!==0&&e.push({event:t,listeners:m})}var Pf=/\r\n?/g,Of=/\u0000|\uFFFD/g;function Mc(e){return(typeof e=="string"?e:""+e).replace(Pf,`
`).replace(Of,"")}function Li(e,t,i){if(t=Mc(t),Mc(e)!==t&&i)throw Error(r(425))}function Di(){}var po=null,mo=null;function go(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var vo=typeof setTimeout=="function"?setTimeout:void 0,If=typeof clearTimeout=="function"?clearTimeout:void 0,Wc=typeof Promise=="function"?Promise:void 0,Af=typeof queueMicrotask=="function"?queueMicrotask:typeof Wc<"u"?function(e){return Wc.resolve(null).then(e).catch(Lf)}:vo;function Lf(e){setTimeout(function(){throw e})}function yo(e,t){var i=t,a=0;do{var c=i.nextSibling;if(e.removeChild(i),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(a===0){e.removeChild(c),Ns(t);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=c}while(i);Ns(t)}function Gn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Vr=Math.random().toString(36).slice(2),_n="__reactFiber$"+Vr,Us="__reactProps$"+Vr,Cn="__reactContainer$"+Vr,wo="__reactEvents$"+Vr,Df="__reactListeners$"+Vr,Uf="__reactHandles$"+Vr;function yr(e){var t=e[_n];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Cn]||i[_n]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=qc(e);e!==null;){if(i=e[_n])return i;e=qc(e)}return t}e=i,i=e.parentNode}return null}function $s(e){return e=e[_n]||e[Cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Hr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(r(33))}function Ui(e){return e[Us]||null}var _o=[],Gr=-1;function Jn(e){return{current:e}}function it(e){0>Gr||(e.current=_o[Gr],_o[Gr]=null,Gr--)}function tt(e,t){Gr++,_o[Gr]=e.current,e.current=t}var Qn={},Pt=Jn(Qn),Ut=Jn(!1),wr=Qn;function Jr(e,t){var i=e.type.contextTypes;if(!i)return Qn;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var c={},h;for(h in i)c[h]=t[h];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=c),c}function $t(e){return e=e.childContextTypes,e!=null}function $i(){it(Ut),it(Pt)}function Kc(e,t,i){if(Pt.current!==Qn)throw Error(r(168));tt(Pt,t),tt(Ut,i)}function Vc(e,t,i){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var c in a)if(!(c in t))throw Error(r(108,de(e)||"Unknown",c));return R({},i,a)}function zi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qn,wr=Pt.current,tt(Pt,e),tt(Ut,Ut.current),!0}function Hc(e,t,i){var a=e.stateNode;if(!a)throw Error(r(169));i?(e=Vc(e,t,wr),a.__reactInternalMemoizedMergedChildContext=e,it(Ut),it(Pt),tt(Pt,e)):it(Ut),tt(Ut,i)}var Tn=null,Fi=!1,ko=!1;function Gc(e){Tn===null?Tn=[e]:Tn.push(e)}function $f(e){Fi=!0,Gc(e)}function Yn(){if(!ko&&Tn!==null){ko=!0;var e=0,t=et;try{var i=Tn;for(et=1;e<i.length;e++){var a=i[e];do a=a(!0);while(a!==null)}Tn=null,Fi=!1}catch(c){throw Tn!==null&&(Tn=Tn.slice(e+1)),wi(U,Yn),c}finally{et=t,ko=!1}}return null}var Qr=[],Yr=0,Bi=null,Mi=0,Xt=[],Zt=0,_r=null,Rn=1,Pn="";function kr(e,t){Qr[Yr++]=Mi,Qr[Yr++]=Bi,Bi=e,Mi=t}function Jc(e,t,i){Xt[Zt++]=Rn,Xt[Zt++]=Pn,Xt[Zt++]=_r,_r=e;var a=Rn;e=Pn;var c=32-ft(a)-1;a&=~(1<<c),i+=1;var h=32-ft(t)+c;if(30<h){var m=c-c%5;h=(a&(1<<m)-1).toString(32),a>>=m,c-=m,Rn=1<<32-ft(t)+c|i<<c|a,Pn=h+e}else Rn=1<<h|i<<c|a,Pn=e}function So(e){e.return!==null&&(kr(e,1),Jc(e,1,0))}function xo(e){for(;e===Bi;)Bi=Qr[--Yr],Qr[Yr]=null,Mi=Qr[--Yr],Qr[Yr]=null;for(;e===_r;)_r=Xt[--Zt],Xt[Zt]=null,Pn=Xt[--Zt],Xt[Zt]=null,Rn=Xt[--Zt],Xt[Zt]=null}var Kt=null,Vt=null,at=!1,cn=null;function Qc(e,t){var i=rn(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function Yc(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kt=e,Vt=Gn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kt=e,Vt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=_r!==null?{id:Rn,overflow:Pn}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=rn(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,Kt=e,Vt=null,!0):!1;default:return!1}}function bo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jo(e){if(at){var t=Vt;if(t){var i=t;if(!Yc(e,t)){if(bo(e))throw Error(r(418));t=Gn(i.nextSibling);var a=Kt;t&&Yc(e,t)?Qc(a,i):(e.flags=e.flags&-4097|2,at=!1,Kt=e)}}else{if(bo(e))throw Error(r(418));e.flags=e.flags&-4097|2,at=!1,Kt=e}}}function Xc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kt=e}function Wi(e){if(e!==Kt)return!1;if(!at)return Xc(e),at=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!go(e.type,e.memoizedProps)),t&&(t=Vt)){if(bo(e))throw Zc(),Error(r(418));for(;t;)Qc(e,t),t=Gn(t.nextSibling)}if(Xc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){Vt=Gn(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}Vt=null}}else Vt=Kt?Gn(e.stateNode.nextSibling):null;return!0}function Zc(){for(var e=Vt;e;)e=Gn(e.nextSibling)}function Xr(){Vt=Kt=null,at=!1}function No(e){cn===null?cn=[e]:cn.push(e)}var zf=H.ReactCurrentBatchConfig;function zs(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(r(309));var a=i.stateNode}if(!a)throw Error(r(147,e));var c=a,h=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===h?t.ref:(t=function(m){var w=c.refs;m===null?delete w[h]:w[h]=m},t._stringRef=h,t)}if(typeof e!="string")throw Error(r(284));if(!i._owner)throw Error(r(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function eu(e){var t=e._init;return t(e._payload)}function tu(e){function t(T,b){if(e){var I=T.deletions;I===null?(T.deletions=[b],T.flags|=16):I.push(b)}}function i(T,b){if(!e)return null;for(;b!==null;)t(T,b),b=b.sibling;return null}function a(T,b){for(T=new Map;b!==null;)b.key!==null?T.set(b.key,b):T.set(b.index,b),b=b.sibling;return T}function c(T,b){return T=ir(T,b),T.index=0,T.sibling=null,T}function h(T,b,I){return T.index=I,e?(I=T.alternate,I!==null?(I=I.index,I<b?(T.flags|=2,b):I):(T.flags|=2,b)):(T.flags|=1048576,b)}function m(T){return e&&T.alternate===null&&(T.flags|=2),T}function w(T,b,I,ne){return b===null||b.tag!==6?(b=vl(I,T.mode,ne),b.return=T,b):(b=c(b,I),b.return=T,b)}function S(T,b,I,ne){var Se=I.type;return Se===ie?Y(T,b,I.props.children,ne,I.key):b!==null&&(b.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===we&&eu(Se)===b.type)?(ne=c(b,I.props),ne.ref=zs(T,b,I),ne.return=T,ne):(ne=pa(I.type,I.key,I.props,null,T.mode,ne),ne.ref=zs(T,b,I),ne.return=T,ne)}function L(T,b,I,ne){return b===null||b.tag!==4||b.stateNode.containerInfo!==I.containerInfo||b.stateNode.implementation!==I.implementation?(b=yl(I,T.mode,ne),b.return=T,b):(b=c(b,I.children||[]),b.return=T,b)}function Y(T,b,I,ne,Se){return b===null||b.tag!==7?(b=Tr(I,T.mode,ne,Se),b.return=T,b):(b=c(b,I),b.return=T,b)}function Z(T,b,I){if(typeof b=="string"&&b!==""||typeof b=="number")return b=vl(""+b,T.mode,I),b.return=T,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ae:return I=pa(b.type,b.key,b.props,null,T.mode,I),I.ref=zs(T,null,b),I.return=T,I;case le:return b=yl(b,T.mode,I),b.return=T,b;case we:var ne=b._init;return Z(T,ne(b._payload),I)}if(mt(b)||ee(b))return b=Tr(b,T.mode,I,null),b.return=T,b;qi(T,b)}return null}function J(T,b,I,ne){var Se=b!==null?b.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return Se!==null?null:w(T,b,""+I,ne);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case ae:return I.key===Se?S(T,b,I,ne):null;case le:return I.key===Se?L(T,b,I,ne):null;case we:return Se=I._init,J(T,b,Se(I._payload),ne)}if(mt(I)||ee(I))return Se!==null?null:Y(T,b,I,ne,null);qi(T,I)}return null}function fe(T,b,I,ne,Se){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return T=T.get(I)||null,w(b,T,""+ne,Se);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case ae:return T=T.get(ne.key===null?I:ne.key)||null,S(b,T,ne,Se);case le:return T=T.get(ne.key===null?I:ne.key)||null,L(b,T,ne,Se);case we:var Re=ne._init;return fe(T,b,I,Re(ne._payload),Se)}if(mt(ne)||ee(ne))return T=T.get(I)||null,Y(b,T,ne,Se,null);qi(b,ne)}return null}function ve(T,b,I,ne){for(var Se=null,Re=null,Pe=b,ze=b=0,jt=null;Pe!==null&&ze<I.length;ze++){Pe.index>ze?(jt=Pe,Pe=null):jt=Pe.sibling;var Ye=J(T,Pe,I[ze],ne);if(Ye===null){Pe===null&&(Pe=jt);break}e&&Pe&&Ye.alternate===null&&t(T,Pe),b=h(Ye,b,ze),Re===null?Se=Ye:Re.sibling=Ye,Re=Ye,Pe=jt}if(ze===I.length)return i(T,Pe),at&&kr(T,ze),Se;if(Pe===null){for(;ze<I.length;ze++)Pe=Z(T,I[ze],ne),Pe!==null&&(b=h(Pe,b,ze),Re===null?Se=Pe:Re.sibling=Pe,Re=Pe);return at&&kr(T,ze),Se}for(Pe=a(T,Pe);ze<I.length;ze++)jt=fe(Pe,T,ze,I[ze],ne),jt!==null&&(e&&jt.alternate!==null&&Pe.delete(jt.key===null?ze:jt.key),b=h(jt,b,ze),Re===null?Se=jt:Re.sibling=jt,Re=jt);return e&&Pe.forEach(function(ar){return t(T,ar)}),at&&kr(T,ze),Se}function _e(T,b,I,ne){var Se=ee(I);if(typeof Se!="function")throw Error(r(150));if(I=Se.call(I),I==null)throw Error(r(151));for(var Re=Se=null,Pe=b,ze=b=0,jt=null,Ye=I.next();Pe!==null&&!Ye.done;ze++,Ye=I.next()){Pe.index>ze?(jt=Pe,Pe=null):jt=Pe.sibling;var ar=J(T,Pe,Ye.value,ne);if(ar===null){Pe===null&&(Pe=jt);break}e&&Pe&&ar.alternate===null&&t(T,Pe),b=h(ar,b,ze),Re===null?Se=ar:Re.sibling=ar,Re=ar,Pe=jt}if(Ye.done)return i(T,Pe),at&&kr(T,ze),Se;if(Pe===null){for(;!Ye.done;ze++,Ye=I.next())Ye=Z(T,Ye.value,ne),Ye!==null&&(b=h(Ye,b,ze),Re===null?Se=Ye:Re.sibling=Ye,Re=Ye);return at&&kr(T,ze),Se}for(Pe=a(T,Pe);!Ye.done;ze++,Ye=I.next())Ye=fe(Pe,T,ze,Ye.value,ne),Ye!==null&&(e&&Ye.alternate!==null&&Pe.delete(Ye.key===null?ze:Ye.key),b=h(Ye,b,ze),Re===null?Se=Ye:Re.sibling=Ye,Re=Ye);return e&&Pe.forEach(function(yp){return t(T,yp)}),at&&kr(T,ze),Se}function pt(T,b,I,ne){if(typeof I=="object"&&I!==null&&I.type===ie&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case ae:e:{for(var Se=I.key,Re=b;Re!==null;){if(Re.key===Se){if(Se=I.type,Se===ie){if(Re.tag===7){i(T,Re.sibling),b=c(Re,I.props.children),b.return=T,T=b;break e}}else if(Re.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===we&&eu(Se)===Re.type){i(T,Re.sibling),b=c(Re,I.props),b.ref=zs(T,Re,I),b.return=T,T=b;break e}i(T,Re);break}else t(T,Re);Re=Re.sibling}I.type===ie?(b=Tr(I.props.children,T.mode,ne,I.key),b.return=T,T=b):(ne=pa(I.type,I.key,I.props,null,T.mode,ne),ne.ref=zs(T,b,I),ne.return=T,T=ne)}return m(T);case le:e:{for(Re=I.key;b!==null;){if(b.key===Re)if(b.tag===4&&b.stateNode.containerInfo===I.containerInfo&&b.stateNode.implementation===I.implementation){i(T,b.sibling),b=c(b,I.children||[]),b.return=T,T=b;break e}else{i(T,b);break}else t(T,b);b=b.sibling}b=yl(I,T.mode,ne),b.return=T,T=b}return m(T);case we:return Re=I._init,pt(T,b,Re(I._payload),ne)}if(mt(I))return ve(T,b,I,ne);if(ee(I))return _e(T,b,I,ne);qi(T,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,b!==null&&b.tag===6?(i(T,b.sibling),b=c(b,I),b.return=T,T=b):(i(T,b),b=vl(I,T.mode,ne),b.return=T,T=b),m(T)):i(T,b)}return pt}var Zr=tu(!0),nu=tu(!1),Ki=Jn(null),Vi=null,es=null,Eo=null;function Co(){Eo=es=Vi=null}function To(e){var t=Ki.current;it(Ki),e._currentValue=t}function Ro(e,t,i){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===i)break;e=e.return}}function ts(e,t){Vi=e,Eo=es=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(zt=!0),e.firstContext=null)}function en(e){var t=e._currentValue;if(Eo!==e)if(e={context:e,memoizedValue:t,next:null},es===null){if(Vi===null)throw Error(r(308));es=e,Vi.dependencies={lanes:0,firstContext:e}}else es=es.next=e;return t}var Sr=null;function Po(e){Sr===null?Sr=[e]:Sr.push(e)}function ru(e,t,i,a){var c=t.interleaved;return c===null?(i.next=i,Po(t)):(i.next=c.next,c.next=i),t.interleaved=i,On(e,a)}function On(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Xn=!1;function Oo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function su(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function In(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zn(e,t,i){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,(He&2)!==0){var c=a.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),a.pending=t,On(e,i)}return c=a.interleaved,c===null?(t.next=t,Po(a)):(t.next=c.next,c.next=t),a.interleaved=t,On(e,i)}function Hi(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,Ka(e,i)}}function iu(e,t){var i=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var c=null,h=null;if(i=i.firstBaseUpdate,i!==null){do{var m={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};h===null?c=h=m:h=h.next=m,i=i.next}while(i!==null);h===null?c=h=t:h=h.next=t}else c=h=t;i={baseState:a.baseState,firstBaseUpdate:c,lastBaseUpdate:h,shared:a.shared,effects:a.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function Gi(e,t,i,a){var c=e.updateQueue;Xn=!1;var h=c.firstBaseUpdate,m=c.lastBaseUpdate,w=c.shared.pending;if(w!==null){c.shared.pending=null;var S=w,L=S.next;S.next=null,m===null?h=L:m.next=L,m=S;var Y=e.alternate;Y!==null&&(Y=Y.updateQueue,w=Y.lastBaseUpdate,w!==m&&(w===null?Y.firstBaseUpdate=L:w.next=L,Y.lastBaseUpdate=S))}if(h!==null){var Z=c.baseState;m=0,Y=L=S=null,w=h;do{var J=w.lane,fe=w.eventTime;if((a&J)===J){Y!==null&&(Y=Y.next={eventTime:fe,lane:0,tag:w.tag,payload:w.payload,callback:w.callback,next:null});e:{var ve=e,_e=w;switch(J=t,fe=i,_e.tag){case 1:if(ve=_e.payload,typeof ve=="function"){Z=ve.call(fe,Z,J);break e}Z=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=_e.payload,J=typeof ve=="function"?ve.call(fe,Z,J):ve,J==null)break e;Z=R({},Z,J);break e;case 2:Xn=!0}}w.callback!==null&&w.lane!==0&&(e.flags|=64,J=c.effects,J===null?c.effects=[w]:J.push(w))}else fe={eventTime:fe,lane:J,tag:w.tag,payload:w.payload,callback:w.callback,next:null},Y===null?(L=Y=fe,S=Z):Y=Y.next=fe,m|=J;if(w=w.next,w===null){if(w=c.shared.pending,w===null)break;J=w,w=J.next,J.next=null,c.lastBaseUpdate=J,c.shared.pending=null}}while(!0);if(Y===null&&(S=Z),c.baseState=S,c.firstBaseUpdate=L,c.lastBaseUpdate=Y,t=c.shared.interleaved,t!==null){c=t;do m|=c.lane,c=c.next;while(c!==t)}else h===null&&(c.shared.lanes=0);jr|=m,e.lanes=m,e.memoizedState=Z}}function au(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],c=a.callback;if(c!==null){if(a.callback=null,a=i,typeof c!="function")throw Error(r(191,c));c.call(a)}}}var Fs={},kn=Jn(Fs),Bs=Jn(Fs),Ms=Jn(Fs);function xr(e){if(e===Fs)throw Error(r(174));return e}function Io(e,t){switch(tt(Ms,t),tt(Bs,e),tt(kn,Fs),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bn(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bn(t,e)}it(kn),tt(kn,t)}function ns(){it(kn),it(Bs),it(Ms)}function ou(e){xr(Ms.current);var t=xr(kn.current),i=bn(t,e.type);t!==i&&(tt(Bs,e),tt(kn,i))}function Ao(e){Bs.current===e&&(it(kn),it(Bs))}var lt=Jn(0);function Ji(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Lo=[];function Do(){for(var e=0;e<Lo.length;e++)Lo[e]._workInProgressVersionPrimary=null;Lo.length=0}var Qi=H.ReactCurrentDispatcher,Uo=H.ReactCurrentBatchConfig,br=0,ct=null,wt=null,xt=null,Yi=!1,Ws=!1,qs=0,Ff=0;function Ot(){throw Error(r(321))}function $o(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!ln(e[i],t[i]))return!1;return!0}function zo(e,t,i,a,c,h){if(br=h,ct=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Qi.current=e===null||e.memoizedState===null?qf:Kf,e=i(a,c),Ws){h=0;do{if(Ws=!1,qs=0,25<=h)throw Error(r(301));h+=1,xt=wt=null,t.updateQueue=null,Qi.current=Vf,e=i(a,c)}while(Ws)}if(Qi.current=ea,t=wt!==null&&wt.next!==null,br=0,xt=wt=ct=null,Yi=!1,t)throw Error(r(300));return e}function Fo(){var e=qs!==0;return qs=0,e}function Sn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?ct.memoizedState=xt=e:xt=xt.next=e,xt}function tn(){if(wt===null){var e=ct.alternate;e=e!==null?e.memoizedState:null}else e=wt.next;var t=xt===null?ct.memoizedState:xt.next;if(t!==null)xt=t,wt=e;else{if(e===null)throw Error(r(310));wt=e,e={memoizedState:wt.memoizedState,baseState:wt.baseState,baseQueue:wt.baseQueue,queue:wt.queue,next:null},xt===null?ct.memoizedState=xt=e:xt=xt.next=e}return xt}function Ks(e,t){return typeof t=="function"?t(e):t}function Bo(e){var t=tn(),i=t.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var a=wt,c=a.baseQueue,h=i.pending;if(h!==null){if(c!==null){var m=c.next;c.next=h.next,h.next=m}a.baseQueue=c=h,i.pending=null}if(c!==null){h=c.next,a=a.baseState;var w=m=null,S=null,L=h;do{var Y=L.lane;if((br&Y)===Y)S!==null&&(S=S.next={lane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),a=L.hasEagerState?L.eagerState:e(a,L.action);else{var Z={lane:Y,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null};S===null?(w=S=Z,m=a):S=S.next=Z,ct.lanes|=Y,jr|=Y}L=L.next}while(L!==null&&L!==h);S===null?m=a:S.next=w,ln(a,t.memoizedState)||(zt=!0),t.memoizedState=a,t.baseState=m,t.baseQueue=S,i.lastRenderedState=a}if(e=i.interleaved,e!==null){c=e;do h=c.lane,ct.lanes|=h,jr|=h,c=c.next;while(c!==e)}else c===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Mo(e){var t=tn(),i=t.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=e;var a=i.dispatch,c=i.pending,h=t.memoizedState;if(c!==null){i.pending=null;var m=c=c.next;do h=e(h,m.action),m=m.next;while(m!==c);ln(h,t.memoizedState)||(zt=!0),t.memoizedState=h,t.baseQueue===null&&(t.baseState=h),i.lastRenderedState=h}return[h,a]}function lu(){}function cu(e,t){var i=ct,a=tn(),c=t(),h=!ln(a.memoizedState,c);if(h&&(a.memoizedState=c,zt=!0),a=a.queue,Wo(hu.bind(null,i,a,e),[e]),a.getSnapshot!==t||h||xt!==null&&xt.memoizedState.tag&1){if(i.flags|=2048,Vs(9,du.bind(null,i,a,c,t),void 0,null),bt===null)throw Error(r(349));(br&30)!==0||uu(i,t,c)}return c}function uu(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function du(e,t,i,a){t.value=i,t.getSnapshot=a,fu(t)&&pu(e)}function hu(e,t,i){return i(function(){fu(t)&&pu(e)})}function fu(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!ln(e,i)}catch{return!0}}function pu(e){var t=On(e,1);t!==null&&fn(t,e,1,-1)}function mu(e){var t=Sn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ks,lastRenderedState:e},t.queue=e,e=e.dispatch=Wf.bind(null,ct,e),[t.memoizedState,e]}function Vs(e,t,i,a){return e={tag:e,create:t,destroy:i,deps:a,next:null},t=ct.updateQueue,t===null?(t={lastEffect:null,stores:null},ct.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(a=i.next,i.next=e,e.next=a,t.lastEffect=e)),e}function gu(){return tn().memoizedState}function Xi(e,t,i,a){var c=Sn();ct.flags|=e,c.memoizedState=Vs(1|t,i,void 0,a===void 0?null:a)}function Zi(e,t,i,a){var c=tn();a=a===void 0?null:a;var h=void 0;if(wt!==null){var m=wt.memoizedState;if(h=m.destroy,a!==null&&$o(a,m.deps)){c.memoizedState=Vs(t,i,h,a);return}}ct.flags|=e,c.memoizedState=Vs(1|t,i,h,a)}function vu(e,t){return Xi(8390656,8,e,t)}function Wo(e,t){return Zi(2048,8,e,t)}function yu(e,t){return Zi(4,2,e,t)}function wu(e,t){return Zi(4,4,e,t)}function _u(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ku(e,t,i){return i=i!=null?i.concat([e]):null,Zi(4,4,_u.bind(null,t,e),i)}function qo(){}function Su(e,t){var i=tn();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&$o(t,a[1])?a[0]:(i.memoizedState=[e,t],e)}function xu(e,t){var i=tn();t=t===void 0?null:t;var a=i.memoizedState;return a!==null&&t!==null&&$o(t,a[1])?a[0]:(e=e(),i.memoizedState=[e,t],e)}function bu(e,t,i){return(br&21)===0?(e.baseState&&(e.baseState=!1,zt=!0),e.memoizedState=i):(ln(i,t)||(i=ec(),ct.lanes|=i,jr|=i,e.baseState=!0),t)}function Bf(e,t){var i=et;et=i!==0&&4>i?i:4,e(!0);var a=Uo.transition;Uo.transition={};try{e(!1),t()}finally{et=i,Uo.transition=a}}function ju(){return tn().memoizedState}function Mf(e,t,i){var a=rr(e);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},Nu(e))Eu(t,i);else if(i=ru(e,t,i,a),i!==null){var c=Dt();fn(i,e,a,c),Cu(i,t,a)}}function Wf(e,t,i){var a=rr(e),c={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(Nu(e))Eu(t,c);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=t.lastRenderedReducer,h!==null))try{var m=t.lastRenderedState,w=h(m,i);if(c.hasEagerState=!0,c.eagerState=w,ln(w,m)){var S=t.interleaved;S===null?(c.next=c,Po(t)):(c.next=S.next,S.next=c),t.interleaved=c;return}}catch{}i=ru(e,t,c,a),i!==null&&(c=Dt(),fn(i,e,a,c),Cu(i,t,a))}}function Nu(e){var t=e.alternate;return e===ct||t!==null&&t===ct}function Eu(e,t){Ws=Yi=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Cu(e,t,i){if((i&4194240)!==0){var a=t.lanes;a&=e.pendingLanes,i|=a,t.lanes=i,Ka(e,i)}}var ea={readContext:en,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useInsertionEffect:Ot,useLayoutEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useMutableSource:Ot,useSyncExternalStore:Ot,useId:Ot,unstable_isNewReconciler:!1},qf={readContext:en,useCallback:function(e,t){return Sn().memoizedState=[e,t===void 0?null:t],e},useContext:en,useEffect:vu,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Xi(4194308,4,_u.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Xi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Xi(4,2,e,t)},useMemo:function(e,t){var i=Sn();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var a=Sn();return t=i!==void 0?i(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Mf.bind(null,ct,e),[a.memoizedState,e]},useRef:function(e){var t=Sn();return e={current:e},t.memoizedState=e},useState:mu,useDebugValue:qo,useDeferredValue:function(e){return Sn().memoizedState=e},useTransition:function(){var e=mu(!1),t=e[0];return e=Bf.bind(null,e[1]),Sn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var a=ct,c=Sn();if(at){if(i===void 0)throw Error(r(407));i=i()}else{if(i=t(),bt===null)throw Error(r(349));(br&30)!==0||uu(a,t,i)}c.memoizedState=i;var h={value:i,getSnapshot:t};return c.queue=h,vu(hu.bind(null,a,h,e),[e]),a.flags|=2048,Vs(9,du.bind(null,a,h,i,t),void 0,null),i},useId:function(){var e=Sn(),t=bt.identifierPrefix;if(at){var i=Pn,a=Rn;i=(a&~(1<<32-ft(a)-1)).toString(32)+i,t=":"+t+"R"+i,i=qs++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=Ff++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Kf={readContext:en,useCallback:Su,useContext:en,useEffect:Wo,useImperativeHandle:ku,useInsertionEffect:yu,useLayoutEffect:wu,useMemo:xu,useReducer:Bo,useRef:gu,useState:function(){return Bo(Ks)},useDebugValue:qo,useDeferredValue:function(e){var t=tn();return bu(t,wt.memoizedState,e)},useTransition:function(){var e=Bo(Ks)[0],t=tn().memoizedState;return[e,t]},useMutableSource:lu,useSyncExternalStore:cu,useId:ju,unstable_isNewReconciler:!1},Vf={readContext:en,useCallback:Su,useContext:en,useEffect:Wo,useImperativeHandle:ku,useInsertionEffect:yu,useLayoutEffect:wu,useMemo:xu,useReducer:Mo,useRef:gu,useState:function(){return Mo(Ks)},useDebugValue:qo,useDeferredValue:function(e){var t=tn();return wt===null?t.memoizedState=e:bu(t,wt.memoizedState,e)},useTransition:function(){var e=Mo(Ks)[0],t=tn().memoizedState;return[e,t]},useMutableSource:lu,useSyncExternalStore:cu,useId:ju,unstable_isNewReconciler:!1};function un(e,t){if(e&&e.defaultProps){t=R({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}function Ko(e,t,i,a){t=e.memoizedState,i=i(a,t),i=i==null?t:R({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var ta={isMounted:function(e){return(e=e._reactInternals)?En(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var a=Dt(),c=rr(e),h=In(a,c);h.payload=t,i!=null&&(h.callback=i),t=Zn(e,h,c),t!==null&&(fn(t,e,c,a),Hi(t,e,c))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var a=Dt(),c=rr(e),h=In(a,c);h.tag=1,h.payload=t,i!=null&&(h.callback=i),t=Zn(e,h,c),t!==null&&(fn(t,e,c,a),Hi(t,e,c))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=Dt(),a=rr(e),c=In(i,a);c.tag=2,t!=null&&(c.callback=t),t=Zn(e,c,a),t!==null&&(fn(t,e,a,i),Hi(t,e,a))}};function Tu(e,t,i,a,c,h,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,h,m):t.prototype&&t.prototype.isPureReactComponent?!Os(i,a)||!Os(c,h):!0}function Ru(e,t,i){var a=!1,c=Qn,h=t.contextType;return typeof h=="object"&&h!==null?h=en(h):(c=$t(t)?wr:Pt.current,a=t.contextTypes,h=(a=a!=null)?Jr(e,c):Qn),t=new t(i,h),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ta,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=h),t}function Pu(e,t,i,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,a),t.state!==e&&ta.enqueueReplaceState(t,t.state,null)}function Vo(e,t,i,a){var c=e.stateNode;c.props=i,c.state=e.memoizedState,c.refs={},Oo(e);var h=t.contextType;typeof h=="object"&&h!==null?c.context=en(h):(h=$t(t)?wr:Pt.current,c.context=Jr(e,h)),c.state=e.memoizedState,h=t.getDerivedStateFromProps,typeof h=="function"&&(Ko(e,t,h,i),c.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(t=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),t!==c.state&&ta.enqueueReplaceState(c,c.state,null),Gi(e,i,c,a),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function rs(e,t){try{var i="",a=t;do i+=$(a),a=a.return;while(a);var c=i}catch(h){c=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:t,stack:c,digest:null}}function Ho(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function Go(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var Hf=typeof WeakMap=="function"?WeakMap:Map;function Ou(e,t,i){i=In(-1,i),i.tag=3,i.payload={element:null};var a=t.value;return i.callback=function(){la||(la=!0,cl=a),Go(e,t)},i}function Iu(e,t,i){i=In(-1,i),i.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var c=t.value;i.payload=function(){return a(c)},i.callback=function(){Go(e,t)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(i.callback=function(){Go(e,t),typeof a!="function"&&(tr===null?tr=new Set([this]):tr.add(this));var m=t.stack;this.componentDidCatch(t.value,{componentStack:m!==null?m:""})}),i}function Au(e,t,i){var a=e.pingCache;if(a===null){a=e.pingCache=new Hf;var c=new Set;a.set(t,c)}else c=a.get(t),c===void 0&&(c=new Set,a.set(t,c));c.has(i)||(c.add(i),e=op.bind(null,e,t,i),t.then(e,e))}function Lu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Du(e,t,i,a,c){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=In(-1,1),t.tag=2,Zn(i,t,1))),i.lanes|=1),e):(e.flags|=65536,e.lanes=c,e)}var Gf=H.ReactCurrentOwner,zt=!1;function Lt(e,t,i,a){t.child=e===null?nu(t,null,i,a):Zr(t,e.child,i,a)}function Uu(e,t,i,a,c){i=i.render;var h=t.ref;return ts(t,c),a=zo(e,t,i,a,h,c),i=Fo(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,An(e,t,c)):(at&&i&&So(t),t.flags|=1,Lt(e,t,a,c),t.child)}function $u(e,t,i,a,c){if(e===null){var h=i.type;return typeof h=="function"&&!gl(h)&&h.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=h,zu(e,t,h,a,c)):(e=pa(i.type,null,a,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(h=e.child,(e.lanes&c)===0){var m=h.memoizedProps;if(i=i.compare,i=i!==null?i:Os,i(m,a)&&e.ref===t.ref)return An(e,t,c)}return t.flags|=1,e=ir(h,a),e.ref=t.ref,e.return=t,t.child=e}function zu(e,t,i,a,c){if(e!==null){var h=e.memoizedProps;if(Os(h,a)&&e.ref===t.ref)if(zt=!1,t.pendingProps=a=h,(e.lanes&c)!==0)(e.flags&131072)!==0&&(zt=!0);else return t.lanes=e.lanes,An(e,t,c)}return Jo(e,t,i,a,c)}function Fu(e,t,i){var a=t.pendingProps,c=a.children,h=e!==null?e.memoizedState:null;if(a.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(is,Ht),Ht|=i;else{if((i&1073741824)===0)return e=h!==null?h.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,tt(is,Ht),Ht|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=h!==null?h.baseLanes:i,tt(is,Ht),Ht|=a}else h!==null?(a=h.baseLanes|i,t.memoizedState=null):a=i,tt(is,Ht),Ht|=a;return Lt(e,t,c,i),t.child}function Bu(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function Jo(e,t,i,a,c){var h=$t(i)?wr:Pt.current;return h=Jr(t,h),ts(t,c),i=zo(e,t,i,a,h,c),a=Fo(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,An(e,t,c)):(at&&a&&So(t),t.flags|=1,Lt(e,t,i,c),t.child)}function Mu(e,t,i,a,c){if($t(i)){var h=!0;zi(t)}else h=!1;if(ts(t,c),t.stateNode===null)ra(e,t),Ru(t,i,a),Vo(t,i,a,c),a=!0;else if(e===null){var m=t.stateNode,w=t.memoizedProps;m.props=w;var S=m.context,L=i.contextType;typeof L=="object"&&L!==null?L=en(L):(L=$t(i)?wr:Pt.current,L=Jr(t,L));var Y=i.getDerivedStateFromProps,Z=typeof Y=="function"||typeof m.getSnapshotBeforeUpdate=="function";Z||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w!==a||S!==L)&&Pu(t,m,a,L),Xn=!1;var J=t.memoizedState;m.state=J,Gi(t,a,m,c),S=t.memoizedState,w!==a||J!==S||Ut.current||Xn?(typeof Y=="function"&&(Ko(t,i,Y,a),S=t.memoizedState),(w=Xn||Tu(t,i,w,a,J,S,L))?(Z||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(t.flags|=4194308)):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=S),m.props=a,m.state=S,m.context=L,a=w):(typeof m.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{m=t.stateNode,su(e,t),w=t.memoizedProps,L=t.type===t.elementType?w:un(t.type,w),m.props=L,Z=t.pendingProps,J=m.context,S=i.contextType,typeof S=="object"&&S!==null?S=en(S):(S=$t(i)?wr:Pt.current,S=Jr(t,S));var fe=i.getDerivedStateFromProps;(Y=typeof fe=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w!==Z||J!==S)&&Pu(t,m,a,S),Xn=!1,J=t.memoizedState,m.state=J,Gi(t,a,m,c);var ve=t.memoizedState;w!==Z||J!==ve||Ut.current||Xn?(typeof fe=="function"&&(Ko(t,i,fe,a),ve=t.memoizedState),(L=Xn||Tu(t,i,L,a,J,ve,S)||!1)?(Y||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(a,ve,S),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(a,ve,S)),typeof m.componentDidUpdate=="function"&&(t.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof m.componentDidUpdate!="function"||w===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=ve),m.props=a,m.state=ve,m.context=S,a=L):(typeof m.componentDidUpdate!="function"||w===e.memoizedProps&&J===e.memoizedState||(t.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||w===e.memoizedProps&&J===e.memoizedState||(t.flags|=1024),a=!1)}return Qo(e,t,i,a,h,c)}function Qo(e,t,i,a,c,h){Bu(e,t);var m=(t.flags&128)!==0;if(!a&&!m)return c&&Hc(t,i,!1),An(e,t,h);a=t.stateNode,Gf.current=t;var w=m&&typeof i.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&m?(t.child=Zr(t,e.child,null,h),t.child=Zr(t,null,w,h)):Lt(e,t,w,h),t.memoizedState=a.state,c&&Hc(t,i,!0),t.child}function Wu(e){var t=e.stateNode;t.pendingContext?Kc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Kc(e,t.context,!1),Io(e,t.containerInfo)}function qu(e,t,i,a,c){return Xr(),No(c),t.flags|=256,Lt(e,t,i,a),t.child}var Yo={dehydrated:null,treeContext:null,retryLane:0};function Xo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ku(e,t,i){var a=t.pendingProps,c=lt.current,h=!1,m=(t.flags&128)!==0,w;if((w=m)||(w=e!==null&&e.memoizedState===null?!1:(c&2)!==0),w?(h=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),tt(lt,c&1),e===null)return jo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(m=a.children,e=a.fallback,h?(a=t.mode,h=t.child,m={mode:"hidden",children:m},(a&1)===0&&h!==null?(h.childLanes=0,h.pendingProps=m):h=ma(m,a,0,null),e=Tr(e,a,i,null),h.return=t,e.return=t,h.sibling=e,t.child=h,t.child.memoizedState=Xo(i),t.memoizedState=Yo,e):Zo(t,m));if(c=e.memoizedState,c!==null&&(w=c.dehydrated,w!==null))return Jf(e,t,m,a,w,c,i);if(h){h=a.fallback,m=t.mode,c=e.child,w=c.sibling;var S={mode:"hidden",children:a.children};return(m&1)===0&&t.child!==c?(a=t.child,a.childLanes=0,a.pendingProps=S,t.deletions=null):(a=ir(c,S),a.subtreeFlags=c.subtreeFlags&14680064),w!==null?h=ir(w,h):(h=Tr(h,m,i,null),h.flags|=2),h.return=t,a.return=t,a.sibling=h,t.child=a,a=h,h=t.child,m=e.child.memoizedState,m=m===null?Xo(i):{baseLanes:m.baseLanes|i,cachePool:null,transitions:m.transitions},h.memoizedState=m,h.childLanes=e.childLanes&~i,t.memoizedState=Yo,a}return h=e.child,e=h.sibling,a=ir(h,{mode:"visible",children:a.children}),(t.mode&1)===0&&(a.lanes=i),a.return=t,a.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=a,t.memoizedState=null,a}function Zo(e,t){return t=ma({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function na(e,t,i,a){return a!==null&&No(a),Zr(t,e.child,null,i),e=Zo(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Jf(e,t,i,a,c,h,m){if(i)return t.flags&256?(t.flags&=-257,a=Ho(Error(r(422))),na(e,t,m,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(h=a.fallback,c=t.mode,a=ma({mode:"visible",children:a.children},c,0,null),h=Tr(h,c,m,null),h.flags|=2,a.return=t,h.return=t,a.sibling=h,t.child=a,(t.mode&1)!==0&&Zr(t,e.child,null,m),t.child.memoizedState=Xo(m),t.memoizedState=Yo,h);if((t.mode&1)===0)return na(e,t,m,null);if(c.data==="$!"){if(a=c.nextSibling&&c.nextSibling.dataset,a)var w=a.dgst;return a=w,h=Error(r(419)),a=Ho(h,a,void 0),na(e,t,m,a)}if(w=(m&e.childLanes)!==0,zt||w){if(a=bt,a!==null){switch(m&-m){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=(c&(a.suspendedLanes|m))!==0?0:c,c!==0&&c!==h.retryLane&&(h.retryLane=c,On(e,c),fn(a,e,c,-1))}return ml(),a=Ho(Error(r(421))),na(e,t,m,a)}return c.data==="$?"?(t.flags|=128,t.child=e.child,t=lp.bind(null,e),c._reactRetry=t,null):(e=h.treeContext,Vt=Gn(c.nextSibling),Kt=t,at=!0,cn=null,e!==null&&(Xt[Zt++]=Rn,Xt[Zt++]=Pn,Xt[Zt++]=_r,Rn=e.id,Pn=e.overflow,_r=t),t=Zo(t,a.children),t.flags|=4096,t)}function Vu(e,t,i){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),Ro(e.return,t,i)}function el(e,t,i,a,c){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:c}:(h.isBackwards=t,h.rendering=null,h.renderingStartTime=0,h.last=a,h.tail=i,h.tailMode=c)}function Hu(e,t,i){var a=t.pendingProps,c=a.revealOrder,h=a.tail;if(Lt(e,t,a.children,i),a=lt.current,(a&2)!==0)a=a&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Vu(e,i,t);else if(e.tag===19)Vu(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(tt(lt,a),(t.mode&1)===0)t.memoizedState=null;else switch(c){case"forwards":for(i=t.child,c=null;i!==null;)e=i.alternate,e!==null&&Ji(e)===null&&(c=i),i=i.sibling;i=c,i===null?(c=t.child,t.child=null):(c=i.sibling,i.sibling=null),el(t,!1,c,i,h);break;case"backwards":for(i=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Ji(e)===null){t.child=c;break}e=c.sibling,c.sibling=i,i=c,c=e}el(t,!0,i,null,h);break;case"together":el(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ra(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function An(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),jr|=t.lanes,(i&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(r(153));if(t.child!==null){for(e=t.child,i=ir(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=ir(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function Qf(e,t,i){switch(t.tag){case 3:Wu(t),Xr();break;case 5:ou(t);break;case 1:$t(t.type)&&zi(t);break;case 4:Io(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,c=t.memoizedProps.value;tt(Ki,a._currentValue),a._currentValue=c;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(tt(lt,lt.current&1),t.flags|=128,null):(i&t.child.childLanes)!==0?Ku(e,t,i):(tt(lt,lt.current&1),e=An(e,t,i),e!==null?e.sibling:null);tt(lt,lt.current&1);break;case 19:if(a=(i&t.childLanes)!==0,(e.flags&128)!==0){if(a)return Hu(e,t,i);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),tt(lt,lt.current),a)break;return null;case 22:case 23:return t.lanes=0,Fu(e,t,i)}return An(e,t,i)}var Gu,tl,Ju,Qu;Gu=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},tl=function(){},Ju=function(e,t,i,a){var c=e.memoizedProps;if(c!==a){e=t.stateNode,xr(kn.current);var h=null;switch(i){case"input":c=X(e,c),a=X(e,a),h=[];break;case"select":c=R({},c,{value:void 0}),a=R({},a,{value:void 0}),h=[];break;case"textarea":c=Ie(e,c),a=Ie(e,a),h=[];break;default:typeof c.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Di)}Ve(i,a);var m;i=null;for(L in c)if(!a.hasOwnProperty(L)&&c.hasOwnProperty(L)&&c[L]!=null)if(L==="style"){var w=c[L];for(m in w)w.hasOwnProperty(m)&&(i||(i={}),i[m]="")}else L!=="dangerouslySetInnerHTML"&&L!=="children"&&L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(u.hasOwnProperty(L)?h||(h=[]):(h=h||[]).push(L,null));for(L in a){var S=a[L];if(w=c?.[L],a.hasOwnProperty(L)&&S!==w&&(S!=null||w!=null))if(L==="style")if(w){for(m in w)!w.hasOwnProperty(m)||S&&S.hasOwnProperty(m)||(i||(i={}),i[m]="");for(m in S)S.hasOwnProperty(m)&&w[m]!==S[m]&&(i||(i={}),i[m]=S[m])}else i||(h||(h=[]),h.push(L,i)),i=S;else L==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,w=w?w.__html:void 0,S!=null&&w!==S&&(h=h||[]).push(L,S)):L==="children"?typeof S!="string"&&typeof S!="number"||(h=h||[]).push(L,""+S):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&(u.hasOwnProperty(L)?(S!=null&&L==="onScroll"&&st("scroll",e),h||w===S||(h=[])):(h=h||[]).push(L,S))}i&&(h=h||[]).push("style",i);var L=h;(t.updateQueue=L)&&(t.flags|=4)}},Qu=function(e,t,i,a){i!==a&&(t.flags|=4)};function Hs(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function It(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,a=0;if(t)for(var c=e.child;c!==null;)i|=c.lanes|c.childLanes,a|=c.subtreeFlags&14680064,a|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)i|=c.lanes|c.childLanes,a|=c.subtreeFlags,a|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=a,e.childLanes=i,t}function Yf(e,t,i){var a=t.pendingProps;switch(xo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(t),null;case 1:return $t(t.type)&&$i(),It(t),null;case 3:return a=t.stateNode,ns(),it(Ut),it(Pt),Do(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Wi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,cn!==null&&(hl(cn),cn=null))),tl(e,t),It(t),null;case 5:Ao(t);var c=xr(Ms.current);if(i=t.type,e!==null&&t.stateNode!=null)Ju(e,t,i,a,c),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(r(166));return It(t),null}if(e=xr(kn.current),Wi(t)){a=t.stateNode,i=t.type;var h=t.memoizedProps;switch(a[_n]=t,a[Us]=h,e=(t.mode&1)!==0,i){case"dialog":st("cancel",a),st("close",a);break;case"iframe":case"object":case"embed":st("load",a);break;case"video":case"audio":for(c=0;c<As.length;c++)st(As[c],a);break;case"source":st("error",a);break;case"img":case"image":case"link":st("error",a),st("load",a);break;case"details":st("toggle",a);break;case"input":se(a,h),st("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!h.multiple},st("invalid",a);break;case"textarea":Be(a,h),st("invalid",a)}Ve(i,h),c=null;for(var m in h)if(h.hasOwnProperty(m)){var w=h[m];m==="children"?typeof w=="string"?a.textContent!==w&&(h.suppressHydrationWarning!==!0&&Li(a.textContent,w,e),c=["children",w]):typeof w=="number"&&a.textContent!==""+w&&(h.suppressHydrationWarning!==!0&&Li(a.textContent,w,e),c=["children",""+w]):u.hasOwnProperty(m)&&w!=null&&m==="onScroll"&&st("scroll",a)}switch(i){case"input":he(a),Rt(a,h,!0);break;case"textarea":he(a),Ze(a);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(a.onclick=Di)}a=c,t.updateQueue=a,a!==null&&(t.flags|=4)}else{m=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sn(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=m.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=m.createElement(i,{is:a.is}):(e=m.createElement(i),i==="select"&&(m=e,a.multiple?m.multiple=!0:a.size&&(m.size=a.size))):e=m.createElementNS(e,i),e[_n]=t,e[Us]=a,Gu(e,t,!1,!1),t.stateNode=e;e:{switch(m=Je(i,a),i){case"dialog":st("cancel",e),st("close",e),c=a;break;case"iframe":case"object":case"embed":st("load",e),c=a;break;case"video":case"audio":for(c=0;c<As.length;c++)st(As[c],e);c=a;break;case"source":st("error",e),c=a;break;case"img":case"image":case"link":st("error",e),st("load",e),c=a;break;case"details":st("toggle",e),c=a;break;case"input":se(e,a),c=X(e,a),st("invalid",e);break;case"option":c=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},c=R({},a,{value:void 0}),st("invalid",e);break;case"textarea":Be(e,a),c=Ie(e,a),st("invalid",e);break;default:c=a}Ve(i,c),w=c;for(h in w)if(w.hasOwnProperty(h)){var S=w[h];h==="style"?Q(e,S):h==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,S!=null&&$n(e,S)):h==="children"?typeof S=="string"?(i!=="textarea"||S!=="")&&Qt(e,S):typeof S=="number"&&Qt(e,""+S):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(u.hasOwnProperty(h)?S!=null&&h==="onScroll"&&st("scroll",e):S!=null&&F(e,h,S,m))}switch(i){case"input":he(e),Rt(e,a,!1);break;case"textarea":he(e),Ze(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Ee(a.value));break;case"select":e.multiple=!!a.multiple,h=a.value,h!=null?z(e,!!a.multiple,h,!1):a.defaultValue!=null&&z(e,!!a.multiple,a.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Di)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return It(t),null;case 6:if(e&&t.stateNode!=null)Qu(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(r(166));if(i=xr(Ms.current),xr(kn.current),Wi(t)){if(a=t.stateNode,i=t.memoizedProps,a[_n]=t,(h=a.nodeValue!==i)&&(e=Kt,e!==null))switch(e.tag){case 3:Li(a.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Li(a.nodeValue,i,(e.mode&1)!==0)}h&&(t.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[_n]=t,t.stateNode=a}return It(t),null;case 13:if(it(lt),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(at&&Vt!==null&&(t.mode&1)!==0&&(t.flags&128)===0)Zc(),Xr(),t.flags|=98560,h=!1;else if(h=Wi(t),a!==null&&a.dehydrated!==null){if(e===null){if(!h)throw Error(r(318));if(h=t.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[_n]=t}else Xr(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;It(t),h=!1}else cn!==null&&(hl(cn),cn=null),h=!0;if(!h)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=i,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(lt.current&1)!==0?_t===0&&(_t=3):ml())),t.updateQueue!==null&&(t.flags|=4),It(t),null);case 4:return ns(),tl(e,t),e===null&&Ls(t.stateNode.containerInfo),It(t),null;case 10:return To(t.type._context),It(t),null;case 17:return $t(t.type)&&$i(),It(t),null;case 19:if(it(lt),h=t.memoizedState,h===null)return It(t),null;if(a=(t.flags&128)!==0,m=h.rendering,m===null)if(a)Hs(h,!1);else{if(_t!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(m=Ji(e),m!==null){for(t.flags|=128,Hs(h,!1),a=m.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=i,i=t.child;i!==null;)h=i,e=a,h.flags&=14680066,m=h.alternate,m===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=m.childLanes,h.lanes=m.lanes,h.child=m.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=m.memoizedProps,h.memoizedState=m.memoizedState,h.updateQueue=m.updateQueue,h.type=m.type,e=m.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return tt(lt,lt.current&1|2),t.child}e=e.sibling}h.tail!==null&&_()>as&&(t.flags|=128,a=!0,Hs(h,!1),t.lanes=4194304)}else{if(!a)if(e=Ji(m),e!==null){if(t.flags|=128,a=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),Hs(h,!0),h.tail===null&&h.tailMode==="hidden"&&!m.alternate&&!at)return It(t),null}else 2*_()-h.renderingStartTime>as&&i!==1073741824&&(t.flags|=128,a=!0,Hs(h,!1),t.lanes=4194304);h.isBackwards?(m.sibling=t.child,t.child=m):(i=h.last,i!==null?i.sibling=m:t.child=m,h.last=m)}return h.tail!==null?(t=h.tail,h.rendering=t,h.tail=t.sibling,h.renderingStartTime=_(),t.sibling=null,i=lt.current,tt(lt,a?i&1|2:i&1),t):(It(t),null);case 22:case 23:return pl(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&(t.mode&1)!==0?(Ht&1073741824)!==0&&(It(t),t.subtreeFlags&6&&(t.flags|=8192)):It(t),null;case 24:return null;case 25:return null}throw Error(r(156,t.tag))}function Xf(e,t){switch(xo(t),t.tag){case 1:return $t(t.type)&&$i(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ns(),it(Ut),it(Pt),Do(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return Ao(t),null;case 13:if(it(lt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(r(340));Xr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(lt),null;case 4:return ns(),null;case 10:return To(t.type._context),null;case 22:case 23:return pl(),null;case 24:return null;default:return null}}var sa=!1,At=!1,Zf=typeof WeakSet=="function"?WeakSet:Set,ge=null;function ss(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){ut(e,t,a)}else i.current=null}function nl(e,t,i){try{i()}catch(a){ut(e,t,a)}}var Yu=!1;function ep(e,t){if(po=bi,e=Tc(),io(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var c=a.anchorOffset,h=a.focusNode;a=a.focusOffset;try{i.nodeType,h.nodeType}catch{i=null;break e}var m=0,w=-1,S=-1,L=0,Y=0,Z=e,J=null;t:for(;;){for(var fe;Z!==i||c!==0&&Z.nodeType!==3||(w=m+c),Z!==h||a!==0&&Z.nodeType!==3||(S=m+a),Z.nodeType===3&&(m+=Z.nodeValue.length),(fe=Z.firstChild)!==null;)J=Z,Z=fe;for(;;){if(Z===e)break t;if(J===i&&++L===c&&(w=m),J===h&&++Y===a&&(S=m),(fe=Z.nextSibling)!==null)break;Z=J,J=Z.parentNode}Z=fe}i=w===-1||S===-1?null:{start:w,end:S}}else i=null}i=i||{start:0,end:0}}else i=null;for(mo={focusedElem:e,selectionRange:i},bi=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var ve=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var _e=ve.memoizedProps,pt=ve.memoizedState,T=t.stateNode,b=T.getSnapshotBeforeUpdate(t.elementType===t.type?_e:un(t.type,_e),pt);T.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var I=t.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ne){ut(t,t.return,ne)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return ve=Yu,Yu=!1,ve}function Gs(e,t,i){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var c=a=a.next;do{if((c.tag&e)===e){var h=c.destroy;c.destroy=void 0,h!==void 0&&nl(t,i,h)}c=c.next}while(c!==a)}}function ia(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var a=i.create;i.destroy=a()}i=i.next}while(i!==t)}}function rl(e){var t=e.ref;if(t!==null){var i=e.stateNode;e.tag,e=i,typeof t=="function"?t(e):t.current=e}}function Xu(e){var t=e.alternate;t!==null&&(e.alternate=null,Xu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_n],delete t[Us],delete t[wo],delete t[Df],delete t[Uf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Zu(e){return e.tag===5||e.tag===3||e.tag===4}function ed(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Zu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sl(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=Di));else if(a!==4&&(e=e.child,e!==null))for(sl(e,t,i),e=e.sibling;e!==null;)sl(e,t,i),e=e.sibling}function il(e,t,i){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(il(e,t,i),e=e.sibling;e!==null;)il(e,t,i),e=e.sibling}var Nt=null,dn=!1;function er(e,t,i){for(i=i.child;i!==null;)td(e,t,i),i=i.sibling}function td(e,t,i){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(qe,i)}catch{}switch(i.tag){case 5:At||ss(i,t);case 6:var a=Nt,c=dn;Nt=null,er(e,t,i),Nt=a,dn=c,Nt!==null&&(dn?(e=Nt,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Nt.removeChild(i.stateNode));break;case 18:Nt!==null&&(dn?(e=Nt,i=i.stateNode,e.nodeType===8?yo(e.parentNode,i):e.nodeType===1&&yo(e,i),Ns(e)):yo(Nt,i.stateNode));break;case 4:a=Nt,c=dn,Nt=i.stateNode.containerInfo,dn=!0,er(e,t,i),Nt=a,dn=c;break;case 0:case 11:case 14:case 15:if(!At&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){c=a=a.next;do{var h=c,m=h.destroy;h=h.tag,m!==void 0&&((h&2)!==0||(h&4)!==0)&&nl(i,t,m),c=c.next}while(c!==a)}er(e,t,i);break;case 1:if(!At&&(ss(i,t),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(w){ut(i,t,w)}er(e,t,i);break;case 21:er(e,t,i);break;case 22:i.mode&1?(At=(a=At)||i.memoizedState!==null,er(e,t,i),At=a):er(e,t,i);break;default:er(e,t,i)}}function nd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new Zf),t.forEach(function(a){var c=cp.bind(null,e,a);i.has(a)||(i.add(a),a.then(c,c))})}}function hn(e,t){var i=t.deletions;if(i!==null)for(var a=0;a<i.length;a++){var c=i[a];try{var h=e,m=t,w=m;e:for(;w!==null;){switch(w.tag){case 5:Nt=w.stateNode,dn=!1;break e;case 3:Nt=w.stateNode.containerInfo,dn=!0;break e;case 4:Nt=w.stateNode.containerInfo,dn=!0;break e}w=w.return}if(Nt===null)throw Error(r(160));td(h,m,c),Nt=null,dn=!1;var S=c.alternate;S!==null&&(S.return=null),c.return=null}catch(L){ut(c,t,L)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)rd(t,e),t=t.sibling}function rd(e,t){var i=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hn(t,e),xn(e),a&4){try{Gs(3,e,e.return),ia(3,e)}catch(_e){ut(e,e.return,_e)}try{Gs(5,e,e.return)}catch(_e){ut(e,e.return,_e)}}break;case 1:hn(t,e),xn(e),a&512&&i!==null&&ss(i,i.return);break;case 5:if(hn(t,e),xn(e),a&512&&i!==null&&ss(i,i.return),e.flags&32){var c=e.stateNode;try{Qt(c,"")}catch(_e){ut(e,e.return,_e)}}if(a&4&&(c=e.stateNode,c!=null)){var h=e.memoizedProps,m=i!==null?i.memoizedProps:h,w=e.type,S=e.updateQueue;if(e.updateQueue=null,S!==null)try{w==="input"&&h.type==="radio"&&h.name!=null&&Fe(c,h),Je(w,m);var L=Je(w,h);for(m=0;m<S.length;m+=2){var Y=S[m],Z=S[m+1];Y==="style"?Q(c,Z):Y==="dangerouslySetInnerHTML"?$n(c,Z):Y==="children"?Qt(c,Z):F(c,Y,Z,L)}switch(w){case"input":ot(c,h);break;case"textarea":Ge(c,h);break;case"select":var J=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!h.multiple;var fe=h.value;fe!=null?z(c,!!h.multiple,fe,!1):J!==!!h.multiple&&(h.defaultValue!=null?z(c,!!h.multiple,h.defaultValue,!0):z(c,!!h.multiple,h.multiple?[]:"",!1))}c[Us]=h}catch(_e){ut(e,e.return,_e)}}break;case 6:if(hn(t,e),xn(e),a&4){if(e.stateNode===null)throw Error(r(162));c=e.stateNode,h=e.memoizedProps;try{c.nodeValue=h}catch(_e){ut(e,e.return,_e)}}break;case 3:if(hn(t,e),xn(e),a&4&&i!==null&&i.memoizedState.isDehydrated)try{Ns(t.containerInfo)}catch(_e){ut(e,e.return,_e)}break;case 4:hn(t,e),xn(e);break;case 13:hn(t,e),xn(e),c=e.child,c.flags&8192&&(h=c.memoizedState!==null,c.stateNode.isHidden=h,!h||c.alternate!==null&&c.alternate.memoizedState!==null||(ll=_())),a&4&&nd(e);break;case 22:if(Y=i!==null&&i.memoizedState!==null,e.mode&1?(At=(L=At)||Y,hn(t,e),At=L):hn(t,e),xn(e),a&8192){if(L=e.memoizedState!==null,(e.stateNode.isHidden=L)&&!Y&&(e.mode&1)!==0)for(ge=e,Y=e.child;Y!==null;){for(Z=ge=Y;ge!==null;){switch(J=ge,fe=J.child,J.tag){case 0:case 11:case 14:case 15:Gs(4,J,J.return);break;case 1:ss(J,J.return);var ve=J.stateNode;if(typeof ve.componentWillUnmount=="function"){a=J,i=J.return;try{t=a,ve.props=t.memoizedProps,ve.state=t.memoizedState,ve.componentWillUnmount()}catch(_e){ut(a,i,_e)}}break;case 5:ss(J,J.return);break;case 22:if(J.memoizedState!==null){ad(Z);continue}}fe!==null?(fe.return=J,ge=fe):ad(Z)}Y=Y.sibling}e:for(Y=null,Z=e;;){if(Z.tag===5){if(Y===null){Y=Z;try{c=Z.stateNode,L?(h=c.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(w=Z.stateNode,S=Z.memoizedProps.style,m=S!=null&&S.hasOwnProperty("display")?S.display:null,w.style.display=zn("display",m))}catch(_e){ut(e,e.return,_e)}}}else if(Z.tag===6){if(Y===null)try{Z.stateNode.nodeValue=L?"":Z.memoizedProps}catch(_e){ut(e,e.return,_e)}}else if((Z.tag!==22&&Z.tag!==23||Z.memoizedState===null||Z===e)&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===e)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===e)break e;Y===Z&&(Y=null),Z=Z.return}Y===Z&&(Y=null),Z.sibling.return=Z.return,Z=Z.sibling}}break;case 19:hn(t,e),xn(e),a&4&&nd(e);break;case 21:break;default:hn(t,e),xn(e)}}function xn(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(Zu(i)){var a=i;break e}i=i.return}throw Error(r(160))}switch(a.tag){case 5:var c=a.stateNode;a.flags&32&&(Qt(c,""),a.flags&=-33);var h=ed(e);il(e,h,c);break;case 3:case 4:var m=a.stateNode.containerInfo,w=ed(e);sl(e,w,m);break;default:throw Error(r(161))}}catch(S){ut(e,e.return,S)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tp(e,t,i){ge=e,sd(e)}function sd(e,t,i){for(var a=(e.mode&1)!==0;ge!==null;){var c=ge,h=c.child;if(c.tag===22&&a){var m=c.memoizedState!==null||sa;if(!m){var w=c.alternate,S=w!==null&&w.memoizedState!==null||At;w=sa;var L=At;if(sa=m,(At=S)&&!L)for(ge=c;ge!==null;)m=ge,S=m.child,m.tag===22&&m.memoizedState!==null?od(c):S!==null?(S.return=m,ge=S):od(c);for(;h!==null;)ge=h,sd(h),h=h.sibling;ge=c,sa=w,At=L}id(e)}else(c.subtreeFlags&8772)!==0&&h!==null?(h.return=c,ge=h):id(e)}}function id(e){for(;ge!==null;){var t=ge;if((t.flags&8772)!==0){var i=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:At||ia(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!At)if(i===null)a.componentDidMount();else{var c=t.elementType===t.type?i.memoizedProps:un(t.type,i.memoizedProps);a.componentDidUpdate(c,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var h=t.updateQueue;h!==null&&au(t,h,a);break;case 3:var m=t.updateQueue;if(m!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}au(t,m,i)}break;case 5:var w=t.stateNode;if(i===null&&t.flags&4){i=w;var S=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":S.autoFocus&&i.focus();break;case"img":S.src&&(i.src=S.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var L=t.alternate;if(L!==null){var Y=L.memoizedState;if(Y!==null){var Z=Y.dehydrated;Z!==null&&Ns(Z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}At||t.flags&512&&rl(t)}catch(J){ut(t,t.return,J)}}if(t===e){ge=null;break}if(i=t.sibling,i!==null){i.return=t.return,ge=i;break}ge=t.return}}function ad(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var i=t.sibling;if(i!==null){i.return=t.return,ge=i;break}ge=t.return}}function od(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{ia(4,t)}catch(S){ut(t,i,S)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var c=t.return;try{a.componentDidMount()}catch(S){ut(t,c,S)}}var h=t.return;try{rl(t)}catch(S){ut(t,h,S)}break;case 5:var m=t.return;try{rl(t)}catch(S){ut(t,m,S)}}}catch(S){ut(t,t.return,S)}if(t===e){ge=null;break}var w=t.sibling;if(w!==null){w.return=t.return,ge=w;break}ge=t.return}}var np=Math.ceil,aa=H.ReactCurrentDispatcher,al=H.ReactCurrentOwner,nn=H.ReactCurrentBatchConfig,He=0,bt=null,gt=null,Et=0,Ht=0,is=Jn(0),_t=0,Js=null,jr=0,oa=0,ol=0,Qs=null,Ft=null,ll=0,as=1/0,Ln=null,la=!1,cl=null,tr=null,ca=!1,nr=null,ua=0,Ys=0,ul=null,da=-1,ha=0;function Dt(){return(He&6)!==0?_():da!==-1?da:da=_()}function rr(e){return(e.mode&1)===0?1:(He&2)!==0&&Et!==0?Et&-Et:zf.transition!==null?(ha===0&&(ha=ec()),ha):(e=et,e!==0||(e=window.event,e=e===void 0?16:cc(e.type)),e)}function fn(e,t,i,a){if(50<Ys)throw Ys=0,ul=null,Error(r(185));ks(e,i,a),((He&2)===0||e!==bt)&&(e===bt&&((He&2)===0&&(oa|=i),_t===4&&sr(e,Et)),Bt(e,a),i===1&&He===0&&(t.mode&1)===0&&(as=_()+500,Fi&&Yn()))}function Bt(e,t){var i=e.callbackNode;$h(e,t);var a=ki(e,e===bt?Et:0);if(a===0)i!==null&&_s(i),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(i!=null&&_s(i),t===1)e.tag===0?$f(cd.bind(null,e)):Gc(cd.bind(null,e)),Af(function(){(He&6)===0&&Yn()}),i=null;else{switch(tc(a)){case 1:i=U;break;case 4:i=te;break;case 16:i=$e;break;case 536870912:i=Qe;break;default:i=$e}i=vd(i,ld.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function ld(e,t){if(da=-1,ha=0,(He&6)!==0)throw Error(r(327));var i=e.callbackNode;if(os()&&e.callbackNode!==i)return null;var a=ki(e,e===bt?Et:0);if(a===0)return null;if((a&30)!==0||(a&e.expiredLanes)!==0||t)t=fa(e,a);else{t=a;var c=He;He|=2;var h=dd();(bt!==e||Et!==t)&&(Ln=null,as=_()+500,Er(e,t));do try{ip();break}catch(w){ud(e,w)}while(!0);Co(),aa.current=h,He=c,gt!==null?t=0:(bt=null,Et=0,t=_t)}if(t!==0){if(t===2&&(c=Wa(e),c!==0&&(a=c,t=dl(e,c))),t===1)throw i=Js,Er(e,0),sr(e,a),Bt(e,_()),i;if(t===6)sr(e,a);else{if(c=e.current.alternate,(a&30)===0&&!rp(c)&&(t=fa(e,a),t===2&&(h=Wa(e),h!==0&&(a=h,t=dl(e,h))),t===1))throw i=Js,Er(e,0),sr(e,a),Bt(e,_()),i;switch(e.finishedWork=c,e.finishedLanes=a,t){case 0:case 1:throw Error(r(345));case 2:Cr(e,Ft,Ln);break;case 3:if(sr(e,a),(a&130023424)===a&&(t=ll+500-_(),10<t)){if(ki(e,0)!==0)break;if(c=e.suspendedLanes,(c&a)!==a){Dt(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=vo(Cr.bind(null,e,Ft,Ln),t);break}Cr(e,Ft,Ln);break;case 4:if(sr(e,a),(a&4194240)===a)break;for(t=e.eventTimes,c=-1;0<a;){var m=31-ft(a);h=1<<m,m=t[m],m>c&&(c=m),a&=~h}if(a=c,a=_()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*np(a/1960))-a,10<a){e.timeoutHandle=vo(Cr.bind(null,e,Ft,Ln),a);break}Cr(e,Ft,Ln);break;case 5:Cr(e,Ft,Ln);break;default:throw Error(r(329))}}}return Bt(e,_()),e.callbackNode===i?ld.bind(null,e):null}function dl(e,t){var i=Qs;return e.current.memoizedState.isDehydrated&&(Er(e,t).flags|=256),e=fa(e,t),e!==2&&(t=Ft,Ft=i,t!==null&&hl(t)),e}function hl(e){Ft===null?Ft=e:Ft.push.apply(Ft,e)}function rp(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var c=i[a],h=c.getSnapshot;c=c.value;try{if(!ln(h(),c))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sr(e,t){for(t&=~ol,t&=~oa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-ft(t),a=1<<i;e[i]=-1,t&=~a}}function cd(e){if((He&6)!==0)throw Error(r(327));os();var t=ki(e,0);if((t&1)===0)return Bt(e,_()),null;var i=fa(e,t);if(e.tag!==0&&i===2){var a=Wa(e);a!==0&&(t=a,i=dl(e,a))}if(i===1)throw i=Js,Er(e,0),sr(e,t),Bt(e,_()),i;if(i===6)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cr(e,Ft,Ln),Bt(e,_()),null}function fl(e,t){var i=He;He|=1;try{return e(t)}finally{He=i,He===0&&(as=_()+500,Fi&&Yn())}}function Nr(e){nr!==null&&nr.tag===0&&(He&6)===0&&os();var t=He;He|=1;var i=nn.transition,a=et;try{if(nn.transition=null,et=1,e)return e()}finally{et=a,nn.transition=i,He=t,(He&6)===0&&Yn()}}function pl(){Ht=is.current,it(is)}function Er(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,If(i)),gt!==null)for(i=gt.return;i!==null;){var a=i;switch(xo(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&$i();break;case 3:ns(),it(Ut),it(Pt),Do();break;case 5:Ao(a);break;case 4:ns();break;case 13:it(lt);break;case 19:it(lt);break;case 10:To(a.type._context);break;case 22:case 23:pl()}i=i.return}if(bt=e,gt=e=ir(e.current,null),Et=Ht=t,_t=0,Js=null,ol=oa=jr=0,Ft=Qs=null,Sr!==null){for(t=0;t<Sr.length;t++)if(i=Sr[t],a=i.interleaved,a!==null){i.interleaved=null;var c=a.next,h=i.pending;if(h!==null){var m=h.next;h.next=c,a.next=m}i.pending=a}Sr=null}return e}function ud(e,t){do{var i=gt;try{if(Co(),Qi.current=ea,Yi){for(var a=ct.memoizedState;a!==null;){var c=a.queue;c!==null&&(c.pending=null),a=a.next}Yi=!1}if(br=0,xt=wt=ct=null,Ws=!1,qs=0,al.current=null,i===null||i.return===null){_t=1,Js=t,gt=null;break}e:{var h=e,m=i.return,w=i,S=t;if(t=Et,w.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){var L=S,Y=w,Z=Y.tag;if((Y.mode&1)===0&&(Z===0||Z===11||Z===15)){var J=Y.alternate;J?(Y.updateQueue=J.updateQueue,Y.memoizedState=J.memoizedState,Y.lanes=J.lanes):(Y.updateQueue=null,Y.memoizedState=null)}var fe=Lu(m);if(fe!==null){fe.flags&=-257,Du(fe,m,w,h,t),fe.mode&1&&Au(h,L,t),t=fe,S=L;var ve=t.updateQueue;if(ve===null){var _e=new Set;_e.add(S),t.updateQueue=_e}else ve.add(S);break e}else{if((t&1)===0){Au(h,L,t),ml();break e}S=Error(r(426))}}else if(at&&w.mode&1){var pt=Lu(m);if(pt!==null){(pt.flags&65536)===0&&(pt.flags|=256),Du(pt,m,w,h,t),No(rs(S,w));break e}}h=S=rs(S,w),_t!==4&&(_t=2),Qs===null?Qs=[h]:Qs.push(h),h=m;do{switch(h.tag){case 3:h.flags|=65536,t&=-t,h.lanes|=t;var T=Ou(h,S,t);iu(h,T);break e;case 1:w=S;var b=h.type,I=h.stateNode;if((h.flags&128)===0&&(typeof b.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(tr===null||!tr.has(I)))){h.flags|=65536,t&=-t,h.lanes|=t;var ne=Iu(h,w,t);iu(h,ne);break e}}h=h.return}while(h!==null)}fd(i)}catch(Se){t=Se,gt===i&&i!==null&&(gt=i=i.return);continue}break}while(!0)}function dd(){var e=aa.current;return aa.current=ea,e===null?ea:e}function ml(){(_t===0||_t===3||_t===2)&&(_t=4),bt===null||(jr&268435455)===0&&(oa&268435455)===0||sr(bt,Et)}function fa(e,t){var i=He;He|=2;var a=dd();(bt!==e||Et!==t)&&(Ln=null,Er(e,t));do try{sp();break}catch(c){ud(e,c)}while(!0);if(Co(),He=i,aa.current=a,gt!==null)throw Error(r(261));return bt=null,Et=0,_t}function sp(){for(;gt!==null;)hd(gt)}function ip(){for(;gt!==null&&!_i();)hd(gt)}function hd(e){var t=gd(e.alternate,e,Ht);e.memoizedProps=e.pendingProps,t===null?fd(e):gt=t,al.current=null}function fd(e){var t=e;do{var i=t.alternate;if(e=t.return,(t.flags&32768)===0){if(i=Yf(i,t,Ht),i!==null){gt=i;return}}else{if(i=Xf(i,t),i!==null){i.flags&=32767,gt=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,gt=null;return}}if(t=t.sibling,t!==null){gt=t;return}gt=t=e}while(t!==null);_t===0&&(_t=5)}function Cr(e,t,i){var a=et,c=nn.transition;try{nn.transition=null,et=1,ap(e,t,i,a)}finally{nn.transition=c,et=a}return null}function ap(e,t,i,a){do os();while(nr!==null);if((He&6)!==0)throw Error(r(327));i=e.finishedWork;var c=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var h=i.lanes|i.childLanes;if(zh(e,h),e===bt&&(gt=bt=null,Et=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||ca||(ca=!0,vd($e,function(){return os(),null})),h=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||h){h=nn.transition,nn.transition=null;var m=et;et=1;var w=He;He|=4,al.current=null,ep(e,i),rd(i,e),Nf(mo),bi=!!po,mo=po=null,e.current=i,tp(i),za(),He=w,et=m,nn.transition=h}else e.current=i;if(ca&&(ca=!1,nr=e,ua=c),h=e.pendingLanes,h===0&&(tr=null),Yt(i.stateNode),Bt(e,_()),t!==null)for(a=e.onRecoverableError,i=0;i<t.length;i++)c=t[i],a(c.value,{componentStack:c.stack,digest:c.digest});if(la)throw la=!1,e=cl,cl=null,e;return(ua&1)!==0&&e.tag!==0&&os(),h=e.pendingLanes,(h&1)!==0?e===ul?Ys++:(Ys=0,ul=e):Ys=0,Yn(),null}function os(){if(nr!==null){var e=tc(ua),t=nn.transition,i=et;try{if(nn.transition=null,et=16>e?16:e,nr===null)var a=!1;else{if(e=nr,nr=null,ua=0,(He&6)!==0)throw Error(r(331));var c=He;for(He|=4,ge=e.current;ge!==null;){var h=ge,m=h.child;if((ge.flags&16)!==0){var w=h.deletions;if(w!==null){for(var S=0;S<w.length;S++){var L=w[S];for(ge=L;ge!==null;){var Y=ge;switch(Y.tag){case 0:case 11:case 15:Gs(8,Y,h)}var Z=Y.child;if(Z!==null)Z.return=Y,ge=Z;else for(;ge!==null;){Y=ge;var J=Y.sibling,fe=Y.return;if(Xu(Y),Y===L){ge=null;break}if(J!==null){J.return=fe,ge=J;break}ge=fe}}}var ve=h.alternate;if(ve!==null){var _e=ve.child;if(_e!==null){ve.child=null;do{var pt=_e.sibling;_e.sibling=null,_e=pt}while(_e!==null)}}ge=h}}if((h.subtreeFlags&2064)!==0&&m!==null)m.return=h,ge=m;else e:for(;ge!==null;){if(h=ge,(h.flags&2048)!==0)switch(h.tag){case 0:case 11:case 15:Gs(9,h,h.return)}var T=h.sibling;if(T!==null){T.return=h.return,ge=T;break e}ge=h.return}}var b=e.current;for(ge=b;ge!==null;){m=ge;var I=m.child;if((m.subtreeFlags&2064)!==0&&I!==null)I.return=m,ge=I;else e:for(m=b;ge!==null;){if(w=ge,(w.flags&2048)!==0)try{switch(w.tag){case 0:case 11:case 15:ia(9,w)}}catch(Se){ut(w,w.return,Se)}if(w===m){ge=null;break e}var ne=w.sibling;if(ne!==null){ne.return=w.return,ge=ne;break e}ge=w.return}}if(He=c,Yn(),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(qe,e)}catch{}a=!0}return a}finally{et=i,nn.transition=t}}return!1}function pd(e,t,i){t=rs(i,t),t=Ou(e,t,1),e=Zn(e,t,1),t=Dt(),e!==null&&(ks(e,1,t),Bt(e,t))}function ut(e,t,i){if(e.tag===3)pd(e,e,i);else for(;t!==null;){if(t.tag===3){pd(t,e,i);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(tr===null||!tr.has(a))){e=rs(i,e),e=Iu(t,e,1),t=Zn(t,e,1),e=Dt(),t!==null&&(ks(t,1,e),Bt(t,e));break}}t=t.return}}function op(e,t,i){var a=e.pingCache;a!==null&&a.delete(t),t=Dt(),e.pingedLanes|=e.suspendedLanes&i,bt===e&&(Et&i)===i&&(_t===4||_t===3&&(Et&130023424)===Et&&500>_()-ll?Er(e,0):ol|=i),Bt(e,t)}function md(e,t){t===0&&((e.mode&1)===0?t=1:(t=gr,gr<<=1,(gr&130023424)===0&&(gr=4194304)));var i=Dt();e=On(e,t),e!==null&&(ks(e,t,i),Bt(e,i))}function lp(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),md(e,i)}function cp(e,t){var i=0;switch(e.tag){case 13:var a=e.stateNode,c=e.memoizedState;c!==null&&(i=c.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(r(314))}a!==null&&a.delete(t),md(e,i)}var gd;gd=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ut.current)zt=!0;else{if((e.lanes&i)===0&&(t.flags&128)===0)return zt=!1,Qf(e,t,i);zt=(e.flags&131072)!==0}else zt=!1,at&&(t.flags&1048576)!==0&&Jc(t,Mi,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;ra(e,t),e=t.pendingProps;var c=Jr(t,Pt.current);ts(t,i),c=zo(null,t,a,e,c,i);var h=Fo();return t.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$t(a)?(h=!0,zi(t)):h=!1,t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,Oo(t),c.updater=ta,t.stateNode=c,c._reactInternals=t,Vo(t,a,e,i),t=Qo(null,t,a,!0,h,i)):(t.tag=0,at&&h&&So(t),Lt(null,t,c,i),t=t.child),t;case 16:a=t.elementType;e:{switch(ra(e,t),e=t.pendingProps,c=a._init,a=c(a._payload),t.type=a,c=t.tag=dp(a),e=un(a,e),c){case 0:t=Jo(null,t,a,e,i);break e;case 1:t=Mu(null,t,a,e,i);break e;case 11:t=Uu(null,t,a,e,i);break e;case 14:t=$u(null,t,a,un(a.type,e),i);break e}throw Error(r(306,a,""))}return t;case 0:return a=t.type,c=t.pendingProps,c=t.elementType===a?c:un(a,c),Jo(e,t,a,c,i);case 1:return a=t.type,c=t.pendingProps,c=t.elementType===a?c:un(a,c),Mu(e,t,a,c,i);case 3:e:{if(Wu(t),e===null)throw Error(r(387));a=t.pendingProps,h=t.memoizedState,c=h.element,su(e,t),Gi(t,a,null,i);var m=t.memoizedState;if(a=m.element,h.isDehydrated)if(h={element:a,isDehydrated:!1,cache:m.cache,pendingSuspenseBoundaries:m.pendingSuspenseBoundaries,transitions:m.transitions},t.updateQueue.baseState=h,t.memoizedState=h,t.flags&256){c=rs(Error(r(423)),t),t=qu(e,t,a,i,c);break e}else if(a!==c){c=rs(Error(r(424)),t),t=qu(e,t,a,i,c);break e}else for(Vt=Gn(t.stateNode.containerInfo.firstChild),Kt=t,at=!0,cn=null,i=nu(t,null,a,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Xr(),a===c){t=An(e,t,i);break e}Lt(e,t,a,i)}t=t.child}return t;case 5:return ou(t),e===null&&jo(t),a=t.type,c=t.pendingProps,h=e!==null?e.memoizedProps:null,m=c.children,go(a,c)?m=null:h!==null&&go(a,h)&&(t.flags|=32),Bu(e,t),Lt(e,t,m,i),t.child;case 6:return e===null&&jo(t),null;case 13:return Ku(e,t,i);case 4:return Io(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=Zr(t,null,a,i):Lt(e,t,a,i),t.child;case 11:return a=t.type,c=t.pendingProps,c=t.elementType===a?c:un(a,c),Uu(e,t,a,c,i);case 7:return Lt(e,t,t.pendingProps,i),t.child;case 8:return Lt(e,t,t.pendingProps.children,i),t.child;case 12:return Lt(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(a=t.type._context,c=t.pendingProps,h=t.memoizedProps,m=c.value,tt(Ki,a._currentValue),a._currentValue=m,h!==null)if(ln(h.value,m)){if(h.children===c.children&&!Ut.current){t=An(e,t,i);break e}}else for(h=t.child,h!==null&&(h.return=t);h!==null;){var w=h.dependencies;if(w!==null){m=h.child;for(var S=w.firstContext;S!==null;){if(S.context===a){if(h.tag===1){S=In(-1,i&-i),S.tag=2;var L=h.updateQueue;if(L!==null){L=L.shared;var Y=L.pending;Y===null?S.next=S:(S.next=Y.next,Y.next=S),L.pending=S}}h.lanes|=i,S=h.alternate,S!==null&&(S.lanes|=i),Ro(h.return,i,t),w.lanes|=i;break}S=S.next}}else if(h.tag===10)m=h.type===t.type?null:h.child;else if(h.tag===18){if(m=h.return,m===null)throw Error(r(341));m.lanes|=i,w=m.alternate,w!==null&&(w.lanes|=i),Ro(m,i,t),m=h.sibling}else m=h.child;if(m!==null)m.return=h;else for(m=h;m!==null;){if(m===t){m=null;break}if(h=m.sibling,h!==null){h.return=m.return,m=h;break}m=m.return}h=m}Lt(e,t,c.children,i),t=t.child}return t;case 9:return c=t.type,a=t.pendingProps.children,ts(t,i),c=en(c),a=a(c),t.flags|=1,Lt(e,t,a,i),t.child;case 14:return a=t.type,c=un(a,t.pendingProps),c=un(a.type,c),$u(e,t,a,c,i);case 15:return zu(e,t,t.type,t.pendingProps,i);case 17:return a=t.type,c=t.pendingProps,c=t.elementType===a?c:un(a,c),ra(e,t),t.tag=1,$t(a)?(e=!0,zi(t)):e=!1,ts(t,i),Ru(t,a,c),Vo(t,a,c,i),Qo(null,t,a,!0,e,i);case 19:return Hu(e,t,i);case 22:return Fu(e,t,i)}throw Error(r(156,t.tag))};function vd(e,t){return wi(e,t)}function up(e,t,i,a){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rn(e,t,i,a){return new up(e,t,i,a)}function gl(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dp(e){if(typeof e=="function")return gl(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Le)return 11;if(e===G)return 14}return 2}function ir(e,t){var i=e.alternate;return i===null?(i=rn(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function pa(e,t,i,a,c,h){var m=2;if(a=e,typeof e=="function")gl(e)&&(m=1);else if(typeof e=="string")m=5;else e:switch(e){case ie:return Tr(i.children,c,h,t);case be:m=8,c|=8;break;case je:return e=rn(12,i,t,c|2),e.elementType=je,e.lanes=h,e;case ke:return e=rn(13,i,t,c),e.elementType=ke,e.lanes=h,e;case Ue:return e=rn(19,i,t,c),e.elementType=Ue,e.lanes=h,e;case me:return ma(i,c,h,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ye:m=10;break e;case Oe:m=9;break e;case Le:m=11;break e;case G:m=14;break e;case we:m=16,a=null;break e}throw Error(r(130,e==null?e:typeof e,""))}return t=rn(m,i,t,c),t.elementType=e,t.type=a,t.lanes=h,t}function Tr(e,t,i,a){return e=rn(7,e,a,t),e.lanes=i,e}function ma(e,t,i,a){return e=rn(22,e,a,t),e.elementType=me,e.lanes=i,e.stateNode={isHidden:!1},e}function vl(e,t,i){return e=rn(6,e,null,t),e.lanes=i,e}function yl(e,t,i){return t=rn(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function hp(e,t,i,a,c){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qa(0),this.expirationTimes=qa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qa(0),this.identifierPrefix=a,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function wl(e,t,i,a,c,h,m,w,S){return e=new hp(e,t,i,w,S),t===1?(t=1,h===!0&&(t|=8)):t=0,h=rn(3,null,null,t),e.current=h,h.stateNode=e,h.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oo(h),e}function fp(e,t,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:le,key:a==null?null:""+a,children:e,containerInfo:t,implementation:i}}function yd(e){if(!e)return Qn;e=e._reactInternals;e:{if(En(e)!==e||e.tag!==1)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($t(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(r(171))}if(e.tag===1){var i=e.type;if($t(i))return Vc(e,i,t)}return t}function wd(e,t,i,a,c,h,m,w,S){return e=wl(i,a,!0,e,c,h,m,w,S),e.context=yd(null),i=e.current,a=Dt(),c=rr(i),h=In(a,c),h.callback=t??null,Zn(i,h,c),e.current.lanes=c,ks(e,c,a),Bt(e,a),e}function ga(e,t,i,a){var c=t.current,h=Dt(),m=rr(c);return i=yd(i),t.context===null?t.context=i:t.pendingContext=i,t=In(h,m),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=Zn(c,t,m),e!==null&&(fn(e,c,m,h),Hi(e,c,m)),m}function va(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function _d(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function _l(e,t){_d(e,t),(e=e.alternate)&&_d(e,t)}function pp(){return null}var kd=typeof reportError=="function"?reportError:function(e){console.error(e)};function kl(e){this._internalRoot=e}ya.prototype.render=kl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(r(409));ga(e,t,null,null)},ya.prototype.unmount=kl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nr(function(){ga(null,e,null,null)}),t[Cn]=null}};function ya(e){this._internalRoot=e}ya.prototype.unstable_scheduleHydration=function(e){if(e){var t=sc();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Kn.length&&t!==0&&t<Kn[i].priority;i++);Kn.splice(i,0,e),i===0&&oc(e)}};function Sl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Sd(){}function mp(e,t,i,a,c){if(c){if(typeof a=="function"){var h=a;a=function(){var L=va(m);h.call(L)}}var m=wd(t,a,e,0,null,!1,!1,"",Sd);return e._reactRootContainer=m,e[Cn]=m.current,Ls(e.nodeType===8?e.parentNode:e),Nr(),m}for(;c=e.lastChild;)e.removeChild(c);if(typeof a=="function"){var w=a;a=function(){var L=va(S);w.call(L)}}var S=wl(e,0,!1,null,null,!1,!1,"",Sd);return e._reactRootContainer=S,e[Cn]=S.current,Ls(e.nodeType===8?e.parentNode:e),Nr(function(){ga(t,S,i,a)}),S}function _a(e,t,i,a,c){var h=i._reactRootContainer;if(h){var m=h;if(typeof c=="function"){var w=c;c=function(){var S=va(m);w.call(S)}}ga(t,m,e,c)}else m=mp(i,t,e,c,a);return va(m)}nc=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=vr(t.pendingLanes);i!==0&&(Ka(t,i|1),Bt(t,_()),(He&6)===0&&(as=_()+500,Yn()))}break;case 13:Nr(function(){var a=On(e,1);if(a!==null){var c=Dt();fn(a,e,1,c)}}),_l(e,1)}},Va=function(e){if(e.tag===13){var t=On(e,134217728);if(t!==null){var i=Dt();fn(t,e,134217728,i)}_l(e,134217728)}},rc=function(e){if(e.tag===13){var t=rr(e),i=On(e,t);if(i!==null){var a=Dt();fn(i,e,t,a)}_l(e,t)}},sc=function(){return et},ic=function(e,t){var i=et;try{return et=e,t()}finally{et=i}},ur=function(e,t,i){switch(t){case"input":if(ot(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var a=i[t];if(a!==e&&a.form===e.form){var c=Ui(a);if(!c)throw Error(r(90));V(a),ot(a,c)}}}break;case"textarea":Ge(e,i);break;case"select":t=i.value,t!=null&&z(e,!!i.multiple,t,!1)}},Fn=fl,Bn=Nr;var gp={usingClientEntryPoint:!1,Events:[$s,Hr,Ui,hr,fr,fl]},Xs={findFiberByHostInstance:yr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vp={bundleType:Xs.bundleType,version:Xs.version,rendererPackageName:Xs.rendererPackageName,rendererConfig:Xs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vi(e),e===null?null:e.stateNode},findFiberByHostInstance:Xs.findFiberByHostInstance||pp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ka=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ka.isDisabled&&ka.supportsFiber)try{qe=ka.inject(vp),Ke=ka}catch{}}return Mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gp,Mt.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sl(t))throw Error(r(200));return fp(e,t,null,i)},Mt.createRoot=function(e,t){if(!Sl(e))throw Error(r(299));var i=!1,a="",c=kd;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=wl(e,1,!1,null,null,i,!1,a,c),e[Cn]=t.current,Ls(e.nodeType===8?e.parentNode:e),new kl(t)},Mt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=vi(t),e=e===null?null:e.stateNode,e},Mt.flushSync=function(e){return Nr(e)},Mt.hydrate=function(e,t,i){if(!wa(t))throw Error(r(200));return _a(null,e,t,!0,i)},Mt.hydrateRoot=function(e,t,i){if(!Sl(e))throw Error(r(405));var a=i!=null&&i.hydratedSources||null,c=!1,h="",m=kd;if(i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),t=wd(t,null,e,1,i??null,c,!1,h,m),e[Cn]=t.current,Ls(e),a)for(e=0;e<a.length;e++)i=a[e],c=i._getVersion,c=c(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,c]:t.mutableSourceEagerHydrationData.push(i,c);return new ya(t)},Mt.render=function(e,t,i){if(!wa(t))throw Error(r(200));return _a(null,e,t,!1,i)},Mt.unmountComponentAtNode=function(e){if(!wa(e))throw Error(r(40));return e._reactRootContainer?(Nr(function(){_a(null,null,e,!1,function(){e._reactRootContainer=null,e[Cn]=null})}),!0):!1},Mt.unstable_batchedUpdates=fl,Mt.unstable_renderSubtreeIntoContainer=function(e,t,i,a){if(!wa(i))throw Error(r(200));if(e==null||e._reactInternals===void 0)throw Error(r(38));return _a(e,t,i,!1,a)},Mt.version="18.3.1-next-f1338f8080-20240426",Mt}var Rd;function jp(){if(Rd)return jl.exports;Rd=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(n){console.error(n)}}return s(),jl.exports=bp(),jl.exports}var Pd;function Np(){if(Pd)return Sa;Pd=1;var s=jp();return Sa.createRoot=s.createRoot,Sa.hydrateRoot=s.hydrateRoot,Sa}var Ep=Np();function Ia(s,n){var r={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&n.indexOf(o)<0&&(r[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(s);u<o.length;u++)n.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(s,o[u])&&(r[o[u]]=s[o[u]]);return r}function Cp(s,n,r,o){function u(d){return d instanceof r?d:new r(function(f){f(d)})}return new(r||(r=Promise))(function(d,f){function p(y){try{v(o.next(y))}catch(E){f(E)}}function g(y){try{v(o.throw(y))}catch(E){f(E)}}function v(y){y.done?d(y.value):u(y.value).then(p,g)}v((o=o.apply(s,n||[])).next())})}const Tp=s=>s?(...n)=>s(...n):(...n)=>fetch(...n);class Ql extends Error{constructor(n,r="FunctionsError",o){super(n),this.name=r,this.context=o}}class Rp extends Ql{constructor(n){super("Failed to send a request to the Edge Function","FunctionsFetchError",n)}}class Od extends Ql{constructor(n){super("Relay Error invoking the Edge Function","FunctionsRelayError",n)}}class Id extends Ql{constructor(n){super("Edge Function returned a non-2xx status code","FunctionsHttpError",n)}}var Ul;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(Ul||(Ul={}));class Pp{constructor(n,{headers:r={},customFetch:o,region:u=Ul.Any}={}){this.url=n,this.headers=r,this.region=u,this.fetch=Tp(o)}setAuth(n){this.headers.Authorization=`Bearer ${n}`}invoke(n){return Cp(this,arguments,void 0,function*(r,o={}){var u;let d,f;try{const{headers:p,method:g,body:v,signal:y,timeout:E}=o;let j={},{region:x}=o;x||(x=this.region);const A=new URL(`${this.url}/${r}`);x&&x!=="any"&&(j["x-region"]=x,A.searchParams.set("forceFunctionRegion",x));let P;v&&(p&&!Object.prototype.hasOwnProperty.call(p,"Content-Type")||!p)?typeof Blob<"u"&&v instanceof Blob||v instanceof ArrayBuffer?(j["Content-Type"]="application/octet-stream",P=v):typeof v=="string"?(j["Content-Type"]="text/plain",P=v):typeof FormData<"u"&&v instanceof FormData?P=v:(j["Content-Type"]="application/json",P=JSON.stringify(v)):v&&typeof v!="string"&&!(typeof Blob<"u"&&v instanceof Blob)&&!(v instanceof ArrayBuffer)&&!(typeof FormData<"u"&&v instanceof FormData)?P=JSON.stringify(v):P=v;let D=y;E&&(f=new AbortController,d=setTimeout(()=>f.abort(),E),y?(D=f.signal,y.addEventListener("abort",()=>f.abort())):D=f.signal);const M=yield this.fetch(A.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},j),this.headers),p),body:P,signal:D}).catch(ae=>{throw new Rp(ae)}),W=M.headers.get("x-relay-error");if(W&&W==="true")throw new Od(M);if(!M.ok)throw new Id(M);let F=((u=M.headers.get("Content-Type"))!==null&&u!==void 0?u:"text/plain").split(";")[0].trim(),H;return F==="application/json"?H=yield M.json():F==="application/octet-stream"||F==="application/pdf"?H=yield M.blob():F==="text/event-stream"?H=M:F==="multipart/form-data"?H=yield M.formData():H=yield M.text(),{data:H,error:null,response:M}}catch(p){return{data:null,error:p,response:p instanceof Id||p instanceof Od?p.context:void 0}}finally{d&&clearTimeout(d)}})}}var Op=class extends Error{constructor(s){super(s.message),this.name="PostgrestError",this.details=s.details,this.hint=s.hint,this.code=s.code}},Ip=class{constructor(s){var n,r,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(n=s.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=s.signal,this.isMaybeSingle=(r=s.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(o=s.urlLengthLimit)!==null&&o!==void 0?o:8e3,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,n){return this.headers=new Headers(this.headers),this.headers.set(s,n),this}then(s,n){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let u=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{let f=null,p=null,g=null,v=d.status,y=d.statusText;if(d.ok){var E,j;if(r.method!=="HEAD"){var x;const M=await d.text();M===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((x=r.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?p=M:p=JSON.parse(M))}const P=(E=r.headers.get("Prefer"))===null||E===void 0?void 0:E.match(/count=(exact|planned|estimated)/),D=(j=d.headers.get("content-range"))===null||j===void 0?void 0:j.split("/");P&&D&&D.length>1&&(g=parseInt(D[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(p)&&(p.length>1?(f={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,g=null,v=406,y="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{var A;const P=await d.text();try{f=JSON.parse(P),Array.isArray(f)&&d.status===404&&(p=[],f=null,v=200,y="OK")}catch{d.status===404&&P===""?(v=204,y="No Content"):f={message:P}}if(f&&r.isMaybeSingle&&(!(f==null||(A=f.details)===null||A===void 0)&&A.includes("0 rows"))&&(f=null,v=200,y="OK"),f&&r.shouldThrowOnError)throw new Op(f)}return{error:f,data:p,count:g,status:v,statusText:y}});return this.shouldThrowOnError||(u=u.catch(d=>{var f;let p="",g="",v="";const y=d?.cause;if(y){var E,j,x,A;const M=(E=y?.message)!==null&&E!==void 0?E:"",W=(j=y?.code)!==null&&j!==void 0?j:"";p=`${(x=d?.name)!==null&&x!==void 0?x:"FetchError"}: ${d?.message}`,p+=`

Caused by: ${(A=y?.name)!==null&&A!==void 0?A:"Error"}: ${M}`,W&&(p+=` (${W})`),y?.stack&&(p+=`
${y.stack}`)}else{var P;p=(P=d?.stack)!==null&&P!==void 0?P:""}const D=this.url.toString().length;return d?.name==="AbortError"||d?.code==="ABORT_ERR"?(v="",g="Request was aborted (timeout or manual cancellation)",D>this.urlLengthLimit&&(g+=`. Note: Your request URL is ${D} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(y?.name==="HeadersOverflowError"||y?.code==="UND_ERR_HEADERS_OVERFLOW")&&(v="",g="HTTP headers exceeded server limits (typically 16KB)",D>this.urlLengthLimit&&(g+=`. Your request URL is ${D} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(f=d?.name)!==null&&f!==void 0?f:"FetchError"}: ${d?.message}`,details:p,hint:g,code:v},data:null,count:null,status:0,statusText:""}})),u.then(s,n)}returns(){return this}overrideTypes(){return this}},Ap=class extends Ip{select(s){let n=!1;const r=(s??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:n=!0,nullsFirst:r,foreignTable:o,referencedTable:u=o}={}){const d=u?`${u}.order`:"order",f=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${f?`${f},`:""}${s}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:n,referencedTable:r=n}={}){const o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${s}`),this}range(s,n,{foreignTable:r,referencedTable:o=r}={}){const u=typeof o>"u"?"offset":`${o}.offset`,d=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(u,`${s}`),this.url.searchParams.set(d,`${n-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:n=!1,settings:r=!1,buffers:o=!1,wal:u=!1,format:d="text"}={}){var f;const p=[s?"analyze":null,n?"verbose":null,r?"settings":null,o?"buffers":null,u?"wal":null].filter(Boolean).join("|"),g=(f=this.headers.get("Accept"))!==null&&f!==void 0?f:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${g}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}};const Ad=new RegExp("[,()]");var ps=class extends Ap{eq(s,n){return this.url.searchParams.append(s,`eq.${n}`),this}neq(s,n){return this.url.searchParams.append(s,`neq.${n}`),this}gt(s,n){return this.url.searchParams.append(s,`gt.${n}`),this}gte(s,n){return this.url.searchParams.append(s,`gte.${n}`),this}lt(s,n){return this.url.searchParams.append(s,`lt.${n}`),this}lte(s,n){return this.url.searchParams.append(s,`lte.${n}`),this}like(s,n){return this.url.searchParams.append(s,`like.${n}`),this}likeAllOf(s,n){return this.url.searchParams.append(s,`like(all).{${n.join(",")}}`),this}likeAnyOf(s,n){return this.url.searchParams.append(s,`like(any).{${n.join(",")}}`),this}ilike(s,n){return this.url.searchParams.append(s,`ilike.${n}`),this}ilikeAllOf(s,n){return this.url.searchParams.append(s,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(s,n){return this.url.searchParams.append(s,`ilike(any).{${n.join(",")}}`),this}regexMatch(s,n){return this.url.searchParams.append(s,`match.${n}`),this}regexIMatch(s,n){return this.url.searchParams.append(s,`imatch.${n}`),this}is(s,n){return this.url.searchParams.append(s,`is.${n}`),this}isDistinct(s,n){return this.url.searchParams.append(s,`isdistinct.${n}`),this}in(s,n){const r=Array.from(new Set(n)).map(o=>typeof o=="string"&&Ad.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(s,`in.(${r})`),this}notIn(s,n){const r=Array.from(new Set(n)).map(o=>typeof o=="string"&&Ad.test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(s,`not.in.(${r})`),this}contains(s,n){return typeof n=="string"?this.url.searchParams.append(s,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(s,`cs.{${n.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(n)}`),this}containedBy(s,n){return typeof n=="string"?this.url.searchParams.append(s,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(s,`cd.{${n.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(n)}`),this}rangeGt(s,n){return this.url.searchParams.append(s,`sr.${n}`),this}rangeGte(s,n){return this.url.searchParams.append(s,`nxl.${n}`),this}rangeLt(s,n){return this.url.searchParams.append(s,`sl.${n}`),this}rangeLte(s,n){return this.url.searchParams.append(s,`nxr.${n}`),this}rangeAdjacent(s,n){return this.url.searchParams.append(s,`adj.${n}`),this}overlaps(s,n){return typeof n=="string"?this.url.searchParams.append(s,`ov.${n}`):this.url.searchParams.append(s,`ov.{${n.join(",")}}`),this}textSearch(s,n,{config:r,type:o}={}){let u="";o==="plain"?u="pl":o==="phrase"?u="ph":o==="websearch"&&(u="w");const d=r===void 0?"":`(${r})`;return this.url.searchParams.append(s,`${u}fts${d}.${n}`),this}match(s){return Object.entries(s).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(s,n,r){return this.url.searchParams.append(s,`not.${n}.${r}`),this}or(s,{foreignTable:n,referencedTable:r=n}={}){const o=r?`${r}.or`:"or";return this.url.searchParams.append(o,`(${s})`),this}filter(s,n,r){return this.url.searchParams.append(s,`${n}.${r}`),this}},Lp=class{constructor(s,{headers:n={},schema:r,fetch:o,urlLengthLimit:u=8e3}){this.url=s,this.headers=new Headers(n),this.schema=r,this.fetch=o,this.urlLengthLimit=u}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(s,n){const{head:r=!1,count:o}=n??{},u=r?"HEAD":"GET";let d=!1;const f=(s??"*").split("").map(v=>/\s/.test(v)&&!d?"":(v==='"'&&(d=!d),v)).join(""),{url:p,headers:g}=this.cloneRequestState();return p.searchParams.set("select",f),o&&g.append("Prefer",`count=${o}`),new ps({method:u,url:p,headers:g,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(s,{count:n,defaultToNull:r=!0}={}){var o;const u="POST",{url:d,headers:f}=this.cloneRequestState();if(n&&f.append("Prefer",`count=${n}`),r||f.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(p.length>0){const g=[...new Set(p)].map(v=>`"${v}"`);d.searchParams.set("columns",g.join(","))}}return new ps({method:u,url:d,headers:f,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(s,{onConflict:n,ignoreDuplicates:r=!1,count:o,defaultToNull:u=!0}={}){var d;const f="POST",{url:p,headers:g}=this.cloneRequestState();if(g.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&p.searchParams.set("on_conflict",n),o&&g.append("Prefer",`count=${o}`),u||g.append("Prefer","missing=default"),Array.isArray(s)){const v=s.reduce((y,E)=>y.concat(Object.keys(E)),[]);if(v.length>0){const y=[...new Set(v)].map(E=>`"${E}"`);p.searchParams.set("columns",y.join(","))}}return new ps({method:f,url:p,headers:g,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch,urlLengthLimit:this.urlLengthLimit})}update(s,{count:n}={}){var r;const o="PATCH",{url:u,headers:d}=this.cloneRequestState();return n&&d.append("Prefer",`count=${n}`),new ps({method:o,url:u,headers:d,schema:this.schema,body:s,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:s}={}){var n;const r="DELETE",{url:o,headers:u}=this.cloneRequestState();return s&&u.append("Prefer",`count=${s}`),new ps({method:r,url:o,headers:u,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}};function si(s){"@babel/helpers - typeof";return si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},si(s)}function Dp(s,n){if(si(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var o=r.call(s,n);if(si(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}function Up(s){var n=Dp(s,"string");return si(n)=="symbol"?n:n+""}function $p(s,n,r){return(n=Up(n))in s?Object.defineProperty(s,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[n]=r,s}function Ld(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),r.push.apply(r,o)}return r}function xa(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Ld(Object(r),!0).forEach(function(o){$p(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Ld(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}var zp=class uh{constructor(n,{headers:r={},schema:o,fetch:u,timeout:d,urlLengthLimit:f=8e3}={}){this.url=n,this.headers=new Headers(r),this.schemaName=o,this.urlLengthLimit=f;const p=u??globalThis.fetch;d!==void 0&&d>0?this.fetch=(g,v)=>{const y=new AbortController,E=setTimeout(()=>y.abort(),d),j=v?.signal;if(j){if(j.aborted)return clearTimeout(E),p(g,v);const x=()=>{clearTimeout(E),y.abort()};return j.addEventListener("abort",x,{once:!0}),p(g,xa(xa({},v),{},{signal:y.signal})).finally(()=>{clearTimeout(E),j.removeEventListener("abort",x)})}return p(g,xa(xa({},v),{},{signal:y.signal})).finally(()=>clearTimeout(E))}:this.fetch=p}from(n){if(!n||typeof n!="string"||n.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Lp(new URL(`${this.url}/${n}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(n){return new uh(this.url,{headers:this.headers,schema:n,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(n,r={},{head:o=!1,get:u=!1,count:d}={}){var f;let p;const g=new URL(`${this.url}/rpc/${n}`);let v;const y=x=>x!==null&&typeof x=="object"&&(!Array.isArray(x)||x.some(y)),E=o&&Object.values(r).some(y);E?(p="POST",v=r):o||u?(p=o?"HEAD":"GET",Object.entries(r).filter(([x,A])=>A!==void 0).map(([x,A])=>[x,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([x,A])=>{g.searchParams.append(x,A)})):(p="POST",v=r);const j=new Headers(this.headers);return E?j.set("Prefer",d?`count=${d},return=minimal`:"return=minimal"):d&&j.set("Prefer",`count=${d}`),new ps({method:p,url:g,headers:j,schema:this.schemaName,body:v,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch,urlLengthLimit:this.urlLengthLimit})}};class Fp{constructor(){}static detectEnvironment(){var n;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((n=navigator.userAgent)===null||n===void 0)&&n.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const o=r.versions;if(o&&o.node){const u=o.node,d=parseInt(u.replace(/^v/,"").split(".")[0]);return d>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${d} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${d} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const n=this.detectEnvironment();if(n.constructor)return n.constructor;let r=n.error||"WebSocket not supported in this environment.";throw n.workaround&&(r+=`

Suggested solution: ${n.workaround}`),new Error(r)}static createWebSocket(n,r){const o=this.getWebSocketConstructor();return new o(n,r)}static isWebSocketSupported(){try{const n=this.detectEnvironment();return n.type==="native"||n.type==="ws"}catch{return!1}}}const Bp="2.97.0",Mp=`realtime-js/${Bp}`,Wp="1.0.0",dh="2.0.0",Dd=dh,$l=1e4,qp=1e3,Kp=100;var or;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(or||(or={}));var kt;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(kt||(kt={}));var gn;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(gn||(gn={}));var zl;(function(s){s.websocket="websocket"})(zl||(zl={}));var Ir;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Ir||(Ir={}));class Vp{constructor(n){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=n??[]}encode(n,r){if(n.event===this.BROADCAST_EVENT&&!(n.payload instanceof ArrayBuffer)&&typeof n.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(n));let o=[n.join_ref,n.ref,n.topic,n.event,n.payload];return r(JSON.stringify(o))}_binaryEncodeUserBroadcastPush(n){var r;return this._isArrayBuffer((r=n.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(n):this._encodeJsonUserBroadcastPush(n)}_encodeBinaryUserBroadcastPush(n){var r,o;const u=(o=(r=n.payload)===null||r===void 0?void 0:r.payload)!==null&&o!==void 0?o:new ArrayBuffer(0);return this._encodeUserBroadcastPush(n,this.BINARY_ENCODING,u)}_encodeJsonUserBroadcastPush(n){var r,o;const u=(o=(r=n.payload)===null||r===void 0?void 0:r.payload)!==null&&o!==void 0?o:{},f=new TextEncoder().encode(JSON.stringify(u)).buffer;return this._encodeUserBroadcastPush(n,this.JSON_ENCODING,f)}_encodeUserBroadcastPush(n,r,o){var u,d;const f=n.topic,p=(u=n.ref)!==null&&u!==void 0?u:"",g=(d=n.join_ref)!==null&&d!==void 0?d:"",v=n.payload.event,y=this.allowedMetadataKeys?this._pick(n.payload,this.allowedMetadataKeys):{},E=Object.keys(y).length===0?"":JSON.stringify(y);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`ref length ${p.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`topic length ${f.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`userEvent length ${v.length} exceeds maximum of 255`);if(E.length>255)throw new Error(`metadata length ${E.length} exceeds maximum of 255`);const j=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+p.length+f.length+v.length+E.length,x=new ArrayBuffer(this.HEADER_LENGTH+j);let A=new DataView(x),P=0;A.setUint8(P++,this.KINDS.userBroadcastPush),A.setUint8(P++,g.length),A.setUint8(P++,p.length),A.setUint8(P++,f.length),A.setUint8(P++,v.length),A.setUint8(P++,E.length),A.setUint8(P++,r),Array.from(g,M=>A.setUint8(P++,M.charCodeAt(0))),Array.from(p,M=>A.setUint8(P++,M.charCodeAt(0))),Array.from(f,M=>A.setUint8(P++,M.charCodeAt(0))),Array.from(v,M=>A.setUint8(P++,M.charCodeAt(0))),Array.from(E,M=>A.setUint8(P++,M.charCodeAt(0)));var D=new Uint8Array(x.byteLength+o.byteLength);return D.set(new Uint8Array(x),0),D.set(new Uint8Array(o),x.byteLength),D.buffer}decode(n,r){if(this._isArrayBuffer(n)){let o=this._binaryDecode(n);return r(o)}if(typeof n=="string"){const o=JSON.parse(n),[u,d,f,p,g]=o;return r({join_ref:u,ref:d,topic:f,event:p,payload:g})}return r({})}_binaryDecode(n){const r=new DataView(n),o=r.getUint8(0),u=new TextDecoder;if(o===this.KINDS.userBroadcast)return this._decodeUserBroadcast(n,r,u)}_decodeUserBroadcast(n,r,o){const u=r.getUint8(1),d=r.getUint8(2),f=r.getUint8(3),p=r.getUint8(4);let g=this.HEADER_LENGTH+4;const v=o.decode(n.slice(g,g+u));g=g+u;const y=o.decode(n.slice(g,g+d));g=g+d;const E=o.decode(n.slice(g,g+f));g=g+f;const j=n.slice(g,n.byteLength),x=p===this.JSON_ENCODING?JSON.parse(o.decode(j)):j,A={type:this.BROADCAST_EVENT,event:y,payload:x};return f>0&&(A.meta=JSON.parse(E)),{join_ref:null,ref:null,topic:v,event:this.BROADCAST_EVENT,payload:A}}_isArrayBuffer(n){var r;return n instanceof ArrayBuffer||((r=n?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(n,r){return!n||typeof n!="object"?{}:Object.fromEntries(Object.entries(n).filter(([o])=>r.includes(o)))}}class hh{constructor(n,r){this.callback=n,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var nt;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(nt||(nt={}));const Ud=(s,n,r={})=>{var o;const u=(o=r.skipTypes)!==null&&o!==void 0?o:[];return n?Object.keys(n).reduce((d,f)=>(d[f]=Hp(f,s,n,u),d),{}):{}},Hp=(s,n,r,o)=>{const u=n.find(p=>p.name===s),d=u?.type,f=r[s];return d&&!o.includes(d)?fh(d,f):Fl(f)},fh=(s,n)=>{if(s.charAt(0)==="_"){const r=s.slice(1,s.length);return Yp(n,r)}switch(s){case nt.bool:return Gp(n);case nt.float4:case nt.float8:case nt.int2:case nt.int4:case nt.int8:case nt.numeric:case nt.oid:return Jp(n);case nt.json:case nt.jsonb:return Qp(n);case nt.timestamp:return Xp(n);case nt.abstime:case nt.date:case nt.daterange:case nt.int4range:case nt.int8range:case nt.money:case nt.reltime:case nt.text:case nt.time:case nt.timestamptz:case nt.timetz:case nt.tsrange:case nt.tstzrange:return Fl(n);default:return Fl(n)}},Fl=s=>s,Gp=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Jp=s=>{if(typeof s=="string"){const n=parseFloat(s);if(!Number.isNaN(n))return n}return s},Qp=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch{return s}return s},Yp=(s,n)=>{if(typeof s!="string")return s;const r=s.length-1,o=s[r];if(s[0]==="{"&&o==="}"){let d;const f=s.slice(1,r);try{d=JSON.parse("["+f+"]")}catch{d=f?f.split(","):[]}return d.map(p=>fh(n,p))}return s},Xp=s=>typeof s=="string"?s.replace(" ","T"):s,ph=s=>{const n=new URL(s);return n.protocol=n.protocol.replace(/^ws/i,"http"),n.pathname=n.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),n.pathname===""||n.pathname==="/"?n.pathname="/api/broadcast":n.pathname=n.pathname+"/api/broadcast",n.href};class Cl{constructor(n,r,o={},u=$l){this.channel=n,this.event=r,this.payload=o,this.timeout=u,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,r){var o;return this._hasReceived(n)&&r((o=this.receivedResp)===null||o===void 0?void 0:o.response),this.recHooks.push({status:n,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const n=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},n),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(n,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:n,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:r}){this.recHooks.filter(o=>o.status===n).forEach(o=>o.callback(r))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}var $d;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})($d||($d={}));class ni{constructor(n,r){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const o=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(o.state,{},u=>{const{onJoin:d,onLeave:f,onSync:p}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ni.syncState(this.state,u,d,f),this.pendingDiffs.forEach(g=>{this.state=ni.syncDiff(this.state,g,d,f)}),this.pendingDiffs=[],p()}),this.channel._on(o.diff,{},u=>{const{onJoin:d,onLeave:f,onSync:p}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(u):(this.state=ni.syncDiff(this.state,u,d,f),p())}),this.onJoin((u,d,f)=>{this.channel._trigger("presence",{event:"join",key:u,currentPresences:d,newPresences:f})}),this.onLeave((u,d,f)=>{this.channel._trigger("presence",{event:"leave",key:u,currentPresences:d,leftPresences:f})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(n,r,o,u){const d=this.cloneDeep(n),f=this.transformState(r),p={},g={};return this.map(d,(v,y)=>{f[v]||(g[v]=y)}),this.map(f,(v,y)=>{const E=d[v];if(E){const j=y.map(D=>D.presence_ref),x=E.map(D=>D.presence_ref),A=y.filter(D=>x.indexOf(D.presence_ref)<0),P=E.filter(D=>j.indexOf(D.presence_ref)<0);A.length>0&&(p[v]=A),P.length>0&&(g[v]=P)}else p[v]=y}),this.syncDiff(d,{joins:p,leaves:g},o,u)}static syncDiff(n,r,o,u){const{joins:d,leaves:f}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return o||(o=()=>{}),u||(u=()=>{}),this.map(d,(p,g)=>{var v;const y=(v=n[p])!==null&&v!==void 0?v:[];if(n[p]=this.cloneDeep(g),y.length>0){const E=n[p].map(x=>x.presence_ref),j=y.filter(x=>E.indexOf(x.presence_ref)<0);n[p].unshift(...j)}o(p,y,g)}),this.map(f,(p,g)=>{let v=n[p];if(!v)return;const y=g.map(E=>E.presence_ref);v=v.filter(E=>y.indexOf(E.presence_ref)<0),n[p]=v,u(p,v,g),v.length===0&&delete n[p]}),n}static map(n,r){return Object.getOwnPropertyNames(n).map(o=>r(o,n[o]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((r,o)=>{const u=n[o];return"metas"in u?r[o]=u.metas.map(d=>(d.presence_ref=d.phx_ref,delete d.phx_ref,delete d.phx_ref_prev,d)):r[o]=u,r},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zd;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(zd||(zd={}));var ri;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(ri||(ri={}));var Dn;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Dn||(Dn={}));class vs{constructor(n,r={config:{}},o){var u,d;if(this.topic=n,this.params=r,this.socket=o,this.bindings={},this.state=kt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=n.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Cl(this,gn.join,this.params,this.timeout),this.rejoinTimer=new hh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=kt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(f=>f.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=kt.closed,this.socket._remove(this)}),this._onError(f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",f=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,f),this.state=kt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gn.reply,{},(f,p)=>{this._trigger(this._replyEventName(p),f)}),this.presence=new ni(this),this.broadcastEndpointURL=ph(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((d=(u=this.params.config)===null||u===void 0?void 0:u.broadcast)===null||d===void 0)&&d.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(n,r=this.timeout){var o,u,d;if(this.socket.isConnected()||this.socket.connect(),this.state==kt.closed){const{config:{broadcast:f,presence:p,private:g}}=this.params,v=(u=(o=this.bindings.postgres_changes)===null||o===void 0?void 0:o.map(x=>x.filter))!==null&&u!==void 0?u:[],y=!!this.bindings[ri.PRESENCE]&&this.bindings[ri.PRESENCE].length>0||((d=this.params.config.presence)===null||d===void 0?void 0:d.enabled)===!0,E={},j={broadcast:f,presence:Object.assign(Object.assign({},p),{enabled:y}),postgres_changes:v,private:g};this.socket.accessTokenValue&&(E.access_token=this.socket.accessTokenValue),this._onError(x=>n?.(Dn.CHANNEL_ERROR,x)),this._onClose(()=>n?.(Dn.CLOSED)),this.updateJoinPayload(Object.assign({config:j},E)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var A;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){n?.(Dn.SUBSCRIBED);return}else{const P=this.bindings.postgres_changes,D=(A=P?.length)!==null&&A!==void 0?A:0,M=[];for(let W=0;W<D;W++){const F=P[W],{filter:{event:H,schema:ae,table:le,filter:ie}}=F,be=x&&x[W];if(be&&be.event===H&&vs.isFilterValueEqual(be.schema,ae)&&vs.isFilterValueEqual(be.table,le)&&vs.isFilterValueEqual(be.filter,ie))M.push(Object.assign(Object.assign({},F),{id:be.id}));else{this.unsubscribe(),this.state=kt.errored,n?.(Dn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=M,n&&n(Dn.SUBSCRIBED);return}}).receive("error",x=>{this.state=kt.errored,n?.(Dn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{n?.(Dn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(n,r={}){return await this.send({type:"presence",event:"track",payload:n},r.timeout||this.timeout)}async untrack(n={}){return await this.send({type:"presence",event:"untrack"},n)}on(n,r,o){return this.state===kt.joined&&n===ri.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(n,r,o)}async httpSend(n,r,o={}){var u;if(r==null)return Promise.reject("Payload is required for httpSend()");const d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:r,private:this.private}]})},p=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(u=o.timeout)!==null&&u!==void 0?u:this.timeout);if(p.status===202)return{success:!0};let g=p.statusText;try{const v=await p.json();g=v.error||v.message||g}catch{}return Promise.reject(new Error(g))}async send(n,r={}){var o,u;if(!this._canPush()&&n.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:d,payload:f}=n,p={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(p.Authorization=`Bearer ${this.socket.accessTokenValue}`);const g={method:"POST",headers:p,body:JSON.stringify({messages:[{topic:this.subTopic,event:d,payload:f,private:this.private}]})};try{const v=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(o=r.timeout)!==null&&o!==void 0?o:this.timeout);return await((u=v.body)===null||u===void 0?void 0:u.cancel()),v.ok?"ok":"error"}catch(v){return v.name==="AbortError"?"timed out":"error"}}else return new Promise(d=>{var f,p,g;const v=this._push(n.type,n,r.timeout||this.timeout);n.type==="broadcast"&&!(!((g=(p=(f=this.params)===null||f===void 0?void 0:f.config)===null||p===void 0?void 0:p.broadcast)===null||g===void 0)&&g.ack)&&d("ok"),v.receive("ok",()=>d("ok")),v.receive("error",()=>d("error")),v.receive("timeout",()=>d("timed out"))})}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=kt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gn.close,"leave",this._joinRef())};this.joinPush.destroy();let o=null;return new Promise(u=>{o=new Cl(this,gn.leave,{},n),o.receive("ok",()=>{r(),u("ok")}).receive("timeout",()=>{r(),u("timed out")}).receive("error",()=>{u("error")}),o.send(),this._canPush()||o.trigger("ok",{})}).finally(()=>{o?.destroy()})}teardown(){this.pushBuffer.forEach(n=>n.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=kt.closed,this.bindings={}}async _fetchWithTimeout(n,r,o){const u=new AbortController,d=setTimeout(()=>u.abort(),o),f=await this.socket.fetch(n,Object.assign(Object.assign({},r),{signal:u.signal}));return clearTimeout(d),f}_push(n,r,o=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let u=new Cl(this,n,r,o);return this._canPush()?u.send():this._addToPushBuffer(u),u}_addToPushBuffer(n){if(n.startTimeout(),this.pushBuffer.push(n),this.pushBuffer.length>Kp){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(n,r,o){return r}_isMember(n){return this.topic===n}_joinRef(){return this.joinPush.ref}_trigger(n,r,o){var u,d;const f=n.toLocaleLowerCase(),{close:p,error:g,leave:v,join:y}=gn;if(o&&[p,g,v,y].indexOf(f)>=0&&o!==this._joinRef())return;let j=this._onMessage(f,r,o);if(r&&!j)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?(u=this.bindings.postgres_changes)===null||u===void 0||u.filter(x=>{var A,P,D;return((A=x.filter)===null||A===void 0?void 0:A.event)==="*"||((D=(P=x.filter)===null||P===void 0?void 0:P.event)===null||D===void 0?void 0:D.toLocaleLowerCase())===f}).map(x=>x.callback(j,o)):(d=this.bindings[f])===null||d===void 0||d.filter(x=>{var A,P,D,M,W,F;if(["broadcast","presence","postgres_changes"].includes(f))if("id"in x){const H=x.id,ae=(A=x.filter)===null||A===void 0?void 0:A.event;return H&&((P=r.ids)===null||P===void 0?void 0:P.includes(H))&&(ae==="*"||ae?.toLocaleLowerCase()===((D=r.data)===null||D===void 0?void 0:D.type.toLocaleLowerCase()))}else{const H=(W=(M=x?.filter)===null||M===void 0?void 0:M.event)===null||W===void 0?void 0:W.toLocaleLowerCase();return H==="*"||H===((F=r?.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===f}).map(x=>{if(typeof j=="object"&&"ids"in j){const A=j.data,{schema:P,table:D,commit_timestamp:M,type:W,errors:F}=A;j=Object.assign(Object.assign({},{schema:P,table:D,commit_timestamp:M,eventType:W,new:{},old:{},errors:F}),this._getPayloadRecords(A))}x.callback(j,o)})}_isClosed(){return this.state===kt.closed}_isJoined(){return this.state===kt.joined}_isJoining(){return this.state===kt.joining}_isLeaving(){return this.state===kt.leaving}_replyEventName(n){return`chan_reply_${n}`}_on(n,r,o){const u=n.toLocaleLowerCase(),d={type:u,filter:r,callback:o};return this.bindings[u]?this.bindings[u].push(d):this.bindings[u]=[d],this}_off(n,r){const o=n.toLocaleLowerCase();return this.bindings[o]&&(this.bindings[o]=this.bindings[o].filter(u=>{var d;return!(((d=u.type)===null||d===void 0?void 0:d.toLocaleLowerCase())===o&&vs.isEqual(u.filter,r))})),this}static isEqual(n,r){if(Object.keys(n).length!==Object.keys(r).length)return!1;for(const o in n)if(n[o]!==r[o])return!1;return!0}static isFilterValueEqual(n,r){return(n??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(n){this._on(gn.close,{},n)}_onError(n){this._on(gn.error,{},r=>n(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(n=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=kt.joining,this.joinPush.resend(n))}_getPayloadRecords(n){const r={new:{},old:{}};return(n.type==="INSERT"||n.type==="UPDATE")&&(r.new=Ud(n.columns,n.record)),(n.type==="UPDATE"||n.type==="DELETE")&&(r.old=Ud(n.columns,n.old_record)),r}}const Tl=()=>{},ba={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Zp=[1e3,2e3,5e3,1e4],em=1e4,tm=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class nm{constructor(n,r){var o;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$l,this.transport=null,this.heartbeatIntervalMs=ba.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Tl,this.ref=0,this.reconnectTimer=null,this.vsn=Dd,this.logger=Tl,this.conn=null,this.sendBuffer=[],this.serializer=new Vp,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=u=>u?(...d)=>u(...d):(...d)=>fetch(...d),!(!((o=r?.params)===null||o===void 0)&&o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${n}/${zl.websocket}`,this.httpEndpoint=ph(n),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Fp.createWebSocket(this.endpointURL())}catch(n){this._setConnectionState("disconnected");const r=n.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(n,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const o=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(o),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(n?this.conn.close(n,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(n){const r=await n.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const n=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),n}log(n,r,o){this.logger(n,r,o)}connectionState(){switch(this.conn&&this.conn.readyState){case or.connecting:return Ir.Connecting;case or.open:return Ir.Open;case or.closing:return Ir.Closing;default:return Ir.Closed}}isConnected(){return this.connectionState()===Ir.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(n,r={config:{}}){const o=`realtime:${n}`,u=this.getChannels().find(d=>d.topic===o);if(u)return u;{const d=new vs(`realtime:${n}`,r,this);return this.channels.push(d),d}}push(n){const{topic:r,event:o,payload:u,ref:d}=n,f=()=>{this.encode(n,p=>{var g;(g=this.conn)===null||g===void 0||g.send(p)})};this.log("push",`${r} ${o} (${d})`,u),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(n=null){this._authPromise=this._performAuth(n);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var n;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(n=this.conn)===null||n===void 0||n.close(qp,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ba.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(n){this.heartbeatCallback=n}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_makeRef(){let n=this.ref+1;return n===this.ref?this.ref=0:this.ref=n,this.ref.toString()}_leaveOpenTopic(n){let r=this.channels.find(o=>o.topic===n&&(o._isJoined()||o._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${n}"`),r.unsubscribe())}_remove(n){this.channels=this.channels.filter(r=>r.topic!==n.topic)}_onConnMessage(n){this.decode(n.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const v=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",v)}catch(y){this.log("error","error in heartbeat callback",y)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:o,event:u,payload:d,ref:f}=r,p=f?`(${f})`:"",g=d.status||"";this.log("receive",`${g} ${o} ${u} ${p}`.trim(),d),this.channels.filter(v=>v._isMember(o)).forEach(v=>v._trigger(u,d,f)),this._triggerStateCallbacks("message",r)})}_clearTimer(n){var r;n==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):n==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this._onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n),this.conn.readyState===or.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===or.open||this.conn.readyState===or.connecting)try{this.conn.close()}catch(n){this.log("error","Error closing connection",n)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(n=>n.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const n=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(n),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(n){var r;this._setConnectionState("disconnected"),this.log("transport","close",n),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",n)}_onConnError(n){this._setConnectionState("disconnected"),this.log("transport",`${n}`),this._triggerChanError(),this._triggerStateCallbacks("error",n);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(n=>n._trigger(gn.error))}_appendParams(n,r){if(Object.keys(r).length===0)return n;const o=n.match(/\?/)?"&":"?",u=new URLSearchParams(r);return`${n}${o}${u}`}_workerObjectUrl(n){let r;if(n)r=n;else{const o=new Blob([tm],{type:"application/javascript"});r=URL.createObjectURL(o)}return r}_setConnectionState(n,r=!1){this._connectionState=n,n==="connecting"?this._wasManualDisconnect=!1:n==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(n=null){let r,o=!1;if(n)r=n,o=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(u){this.log("error","Error fetching access token from callback",u),r=this.accessTokenValue}else r=this.accessTokenValue;o?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(u=>{const d={access_token:r,version:Mp};r&&u.updateJoinPayload(d),u.joinedOnce&&u._isJoined()&&u._push(gn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(n="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${n}`,r)})}_triggerStateCallbacks(n,r){try{this.stateChangeCallbacks[n].forEach(o=>{try{o(r)}catch(u){this.log("error",`error in ${n} callback`,u)}})}catch(o){this.log("error",`error triggering ${n} callbacks`,o)}}_setupReconnectionTimer(){this.reconnectTimer=new hh(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ba.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(n){var r,o,u,d,f,p,g,v,y,E,j,x;switch(this.transport=(r=n?.transport)!==null&&r!==void 0?r:null,this.timeout=(o=n?.timeout)!==null&&o!==void 0?o:$l,this.heartbeatIntervalMs=(u=n?.heartbeatIntervalMs)!==null&&u!==void 0?u:ba.HEARTBEAT_INTERVAL,this.worker=(d=n?.worker)!==null&&d!==void 0?d:!1,this.accessToken=(f=n?.accessToken)!==null&&f!==void 0?f:null,this.heartbeatCallback=(p=n?.heartbeatCallback)!==null&&p!==void 0?p:Tl,this.vsn=(g=n?.vsn)!==null&&g!==void 0?g:Dd,n?.params&&(this.params=n.params),n?.logger&&(this.logger=n.logger),(n?.logLevel||n?.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(v=n?.reconnectAfterMs)!==null&&v!==void 0?v:(A=>Zp[A-1]||em),this.vsn){case Wp:this.encode=(y=n?.encode)!==null&&y!==void 0?y:((A,P)=>P(JSON.stringify(A))),this.decode=(E=n?.decode)!==null&&E!==void 0?E:((A,P)=>P(JSON.parse(A)));break;case dh:this.encode=(j=n?.encode)!==null&&j!==void 0?j:this.serializer.encode.bind(this.serializer),this.decode=(x=n?.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=n?.workerUrl}}}var ii=class extends Error{constructor(s,n){super(s),this.name="IcebergError",this.status=n.status,this.icebergType=n.icebergType,this.icebergCode=n.icebergCode,this.details=n.details,this.isCommitStateUnknown=n.icebergType==="CommitStateUnknownException"||[500,502,504].includes(n.status)&&n.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function rm(s,n,r){const o=new URL(n,s);if(r)for(const[u,d]of Object.entries(r))d!==void 0&&o.searchParams.set(u,d);return o.toString()}async function sm(s){return!s||s.type==="none"?{}:s.type==="bearer"?{Authorization:`Bearer ${s.token}`}:s.type==="header"?{[s.name]:s.value}:s.type==="custom"?await s.getHeaders():{}}function im(s){const n=s.fetchImpl??globalThis.fetch;return{async request({method:r,path:o,query:u,body:d,headers:f}){const p=rm(s.baseUrl,o,u),g=await sm(s.auth),v=await n(p,{method:r,headers:{...d?{"Content-Type":"application/json"}:{},...g,...f},body:d?JSON.stringify(d):void 0}),y=await v.text(),E=(v.headers.get("content-type")||"").includes("application/json"),j=E&&y?JSON.parse(y):y;if(!v.ok){const x=E?j:void 0,A=x?.error;throw new ii(A?.message??`Request failed with status ${v.status}`,{status:v.status,icebergType:A?.type,icebergCode:A?.code,details:x})}return{status:v.status,headers:v.headers,data:j}}}}function ja(s){return s.join("")}var am=class{constructor(s,n=""){this.client=s,this.prefix=n}async listNamespaces(s){const n=s?{parent:ja(s.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:n})).data.namespaces.map(o=>({namespace:o}))}async createNamespace(s,n){const r={namespace:s.namespace,properties:n?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(s){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ja(s.namespace)}`})}async loadNamespaceMetadata(s){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ja(s.namespace)}`})).data.properties}}async namespaceExists(s){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ja(s.namespace)}`}),!0}catch(n){if(n instanceof ii&&n.status===404)return!1;throw n}}async createNamespaceIfNotExists(s,n){try{return await this.createNamespace(s,n)}catch(r){if(r instanceof ii&&r.status===409)return;throw r}}};function ls(s){return s.join("")}var om=class{constructor(s,n="",r){this.client=s,this.prefix=n,this.accessDelegation=r}async listTables(s){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ls(s.namespace)}/tables`})).data.identifiers}async createTable(s,n){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ls(s.namespace)}/tables`,body:n,headers:r})).data.metadata}async updateTable(s,n){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ls(s.namespace)}/tables/${s.name}`,body:n});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(s,n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ls(s.namespace)}/tables/${s.name}`,query:{purgeRequested:String(n?.purge??!1)}})}async loadTable(s){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ls(s.namespace)}/tables/${s.name}`,headers:n})).data.metadata}async tableExists(s){const n={};this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ls(s.namespace)}/tables/${s.name}`,headers:n}),!0}catch(r){if(r instanceof ii&&r.status===404)return!1;throw r}}async createTableIfNotExists(s,n){try{return await this.createTable(s,n)}catch(r){if(r instanceof ii&&r.status===409)return await this.loadTable({namespace:s.namespace,name:n.name});throw r}}},lm=class{constructor(s){let n="v1";s.catalogName&&(n+=`/${s.catalogName}`);const r=s.baseUrl.endsWith("/")?s.baseUrl:`${s.baseUrl}/`;this.client=im({baseUrl:r,auth:s.auth,fetchImpl:s.fetch}),this.accessDelegation=s.accessDelegation?.join(","),this.namespaceOps=new am(this.client,n),this.tableOps=new om(this.client,n,this.accessDelegation)}async listNamespaces(s){return this.namespaceOps.listNamespaces(s)}async createNamespace(s,n){return this.namespaceOps.createNamespace(s,n)}async dropNamespace(s){await this.namespaceOps.dropNamespace(s)}async loadNamespaceMetadata(s){return this.namespaceOps.loadNamespaceMetadata(s)}async listTables(s){return this.tableOps.listTables(s)}async createTable(s,n){return this.tableOps.createTable(s,n)}async updateTable(s,n){return this.tableOps.updateTable(s,n)}async dropTable(s,n){await this.tableOps.dropTable(s,n)}async loadTable(s){return this.tableOps.loadTable(s)}async namespaceExists(s){return this.namespaceOps.namespaceExists(s)}async tableExists(s){return this.tableOps.tableExists(s)}async createNamespaceIfNotExists(s,n){return this.namespaceOps.createNamespaceIfNotExists(s,n)}async createTableIfNotExists(s,n){return this.tableOps.createTableIfNotExists(s,n)}},Aa=class extends Error{constructor(s,n="storage",r,o){super(s),this.__isStorageError=!0,this.namespace=n,this.name=n==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=o}};function La(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}var Na=class extends Aa{constructor(s,n,r,o="storage"){super(s,o,n,r),this.name=o==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},mh=class extends Aa{constructor(s,n,r="storage"){super(s,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=n}};const cm=s=>s?(...n)=>s(...n):(...n)=>fetch(...n),um=s=>{if(typeof s!="object"||s===null)return!1;const n=Object.getPrototypeOf(s);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)},Bl=s=>{if(Array.isArray(s))return s.map(r=>Bl(r));if(typeof s=="function"||s!==Object(s))return s;const n={};return Object.entries(s).forEach(([r,o])=>{const u=r.replace(/([-_][a-z])/gi,d=>d.toUpperCase().replace(/[-_]/g,""));n[u]=Bl(o)}),n},dm=s=>!s||typeof s!="string"||s.length===0||s.length>100||s.trim()!==s||s.includes("/")||s.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(s);function ai(s){"@babel/helpers - typeof";return ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ai(s)}function hm(s,n){if(ai(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var o=r.call(s,n);if(ai(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}function fm(s){var n=hm(s,"string");return ai(n)=="symbol"?n:n+""}function pm(s,n,r){return(n=fm(n))in s?Object.defineProperty(s,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[n]=r,s}function Fd(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),r.push.apply(r,o)}return r}function Ae(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?Fd(Object(r),!0).forEach(function(o){pm(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):Fd(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}const Bd=s=>{var n;return s.msg||s.message||s.error_description||(typeof s.error=="string"?s.error:(n=s.error)===null||n===void 0?void 0:n.message)||JSON.stringify(s)},mm=async(s,n,r,o)=>{if(s&&typeof s=="object"&&"status"in s&&"ok"in s&&typeof s.status=="number"&&!r?.noResolveJson){const u=s,d=u.status||500;if(typeof u.json=="function")u.json().then(f=>{const p=f?.statusCode||f?.code||d+"";n(new Na(Bd(f),d,p,o))}).catch(()=>{if(o==="vectors"){const f=d+"";n(new Na(u.statusText||`HTTP ${d} error`,d,f,o))}else{const f=d+"";n(new Na(u.statusText||`HTTP ${d} error`,d,f,o))}});else{const f=d+"";n(new Na(u.statusText||`HTTP ${d} error`,d,f,o))}}else n(new mh(Bd(s),s,o))},gm=(s,n,r,o)=>{const u={method:s,headers:n?.headers||{}};return s==="GET"||s==="HEAD"||!o?Ae(Ae({},u),r):(um(o)?(u.headers=Ae({"Content-Type":"application/json"},n?.headers),u.body=JSON.stringify(o)):u.body=o,n?.duplex&&(u.duplex=n.duplex),Ae(Ae({},u),r))};async function ei(s,n,r,o,u,d,f){return new Promise((p,g)=>{s(r,gm(n,o,u,d)).then(v=>{if(!v.ok)throw v;if(o?.noResolveJson)return v;if(f==="vectors"){const y=v.headers.get("content-type");if(v.headers.get("content-length")==="0"||v.status===204)return{};if(!y||!y.includes("application/json"))return{}}return v.json()}).then(v=>p(v)).catch(v=>mm(v,g,o,f))})}function gh(s="storage"){return{get:async(n,r,o,u)=>ei(n,"GET",r,o,u,void 0,s),post:async(n,r,o,u,d)=>ei(n,"POST",r,u,d,o,s),put:async(n,r,o,u,d)=>ei(n,"PUT",r,u,d,o,s),head:async(n,r,o,u)=>ei(n,"HEAD",r,Ae(Ae({},o),{},{noResolveJson:!0}),u,void 0,s),remove:async(n,r,o,u,d)=>ei(n,"DELETE",r,u,d,o,s)}}const vm=gh("storage"),{get:oi,post:mn,put:Ml,head:ym,remove:Yl}=vm,Jt=gh("vectors");var ws=class{constructor(s,n={},r,o="storage"){this.shouldThrowOnError=!1,this.url=s,this.headers=n,this.fetch=cm(r),this.namespace=o}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,n){return this.headers=Ae(Ae({},this.headers),{},{[s]:n}),this}async handleOperation(s){var n=this;try{return{data:await s(),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(La(r))return{data:null,error:r};throw r}}},wm=class{constructor(s,n){this.downloadFn=s,this.shouldThrowOnError=n}then(s,n){return this.execute().then(s,n)}async execute(){var s=this;try{return{data:(await s.downloadFn()).body,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(La(n))return{data:null,error:n};throw n}}};let vh;vh=Symbol.toStringTag;var _m=class{constructor(s,n){this.downloadFn=s,this.shouldThrowOnError=n,this[vh]="BlobDownloadBuilder",this.promise=null}asStream(){return new wm(this.downloadFn,this.shouldThrowOnError)}then(s,n){return this.getPromise().then(s,n)}catch(s){return this.getPromise().catch(s)}finally(s){return this.getPromise().finally(s)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var s=this;try{return{data:await(await s.downloadFn()).blob(),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(La(n))return{data:null,error:n};throw n}}};const km={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Md={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Sm=class extends ws{constructor(s,n={},r,o){super(s,n,o,"storage"),this.bucketId=r}async uploadOrUpdate(s,n,r,o){var u=this;return u.handleOperation(async()=>{let d;const f=Ae(Ae({},Md),o);let p=Ae(Ae({},u.headers),s==="POST"&&{"x-upsert":String(f.upsert)});const g=f.metadata;typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),g&&d.append("metadata",u.encodeMetadata(g)),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.has("cacheControl")||d.append("cacheControl",f.cacheControl),g&&!d.has("metadata")&&d.append("metadata",u.encodeMetadata(g))):(d=r,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType,g&&(p["x-metadata"]=u.toBase64(u.encodeMetadata(g))),(typeof ReadableStream<"u"&&d instanceof ReadableStream||d&&typeof d=="object"&&"pipe"in d&&typeof d.pipe=="function")&&!f.duplex&&(f.duplex="half")),o?.headers&&(p=Ae(Ae({},p),o.headers));const v=u._removeEmptyFolders(n),y=u._getFinalPath(v),E=await(s=="PUT"?Ml:mn)(u.fetch,`${u.url}/object/${y}`,d,Ae({headers:p},f?.duplex?{duplex:f.duplex}:{}));return{path:v,id:E.Id,fullPath:E.Key}})}async upload(s,n,r){return this.uploadOrUpdate("POST",s,n,r)}async uploadToSignedUrl(s,n,r,o){var u=this;const d=u._removeEmptyFolders(s),f=u._getFinalPath(d),p=new URL(u.url+`/object/upload/sign/${f}`);return p.searchParams.set("token",n),u.handleOperation(async()=>{let g;const v=Ae({upsert:Md.upsert},o),y=Ae(Ae({},u.headers),{"x-upsert":String(v.upsert)});return typeof Blob<"u"&&r instanceof Blob?(g=new FormData,g.append("cacheControl",v.cacheControl),g.append("",r)):typeof FormData<"u"&&r instanceof FormData?(g=r,g.append("cacheControl",v.cacheControl)):(g=r,y["cache-control"]=`max-age=${v.cacheControl}`,y["content-type"]=v.contentType),{path:d,fullPath:(await Ml(u.fetch,p.toString(),g,{headers:y})).Key}})}async createSignedUploadUrl(s,n){var r=this;return r.handleOperation(async()=>{let o=r._getFinalPath(s);const u=Ae({},r.headers);n?.upsert&&(u["x-upsert"]="true");const d=await mn(r.fetch,`${r.url}/object/upload/sign/${o}`,{},{headers:u}),f=new URL(r.url+d.url),p=f.searchParams.get("token");if(!p)throw new Aa("No token returned by API");return{signedUrl:f.toString(),path:s,token:p}})}async update(s,n,r){return this.uploadOrUpdate("PUT",s,n,r)}async move(s,n,r){var o=this;return o.handleOperation(async()=>await mn(o.fetch,`${o.url}/object/move`,{bucketId:o.bucketId,sourceKey:s,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:o.headers}))}async copy(s,n,r){var o=this;return o.handleOperation(async()=>({path:(await mn(o.fetch,`${o.url}/object/copy`,{bucketId:o.bucketId,sourceKey:s,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:o.headers})).Key}))}async createSignedUrl(s,n,r){var o=this;return o.handleOperation(async()=>{let u=o._getFinalPath(s),d=await mn(o.fetch,`${o.url}/object/sign/${u}`,Ae({expiresIn:n},r?.transform?{transform:r.transform}:{}),{headers:o.headers});const f=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${o.url}${d.signedURL}${f}`)}})}async createSignedUrls(s,n,r){var o=this;return o.handleOperation(async()=>{const u=await mn(o.fetch,`${o.url}/object/sign/${o.bucketId}`,{expiresIn:n,paths:s},{headers:o.headers}),d=r?.download?`&download=${r.download===!0?"":r.download}`:"";return u.map(f=>Ae(Ae({},f),{},{signedUrl:f.signedURL?encodeURI(`${o.url}${f.signedURL}${d}`):null}))})}download(s,n,r){const o=typeof n?.transform<"u"?"render/image/authenticated":"object",u=this.transformOptsToQueryString(n?.transform||{}),d=u?`?${u}`:"",f=this._getFinalPath(s),p=()=>oi(this.fetch,`${this.url}/${o}/${f}${d}`,{headers:this.headers,noResolveJson:!0},r);return new _m(p,this.shouldThrowOnError)}async info(s){var n=this;const r=n._getFinalPath(s);return n.handleOperation(async()=>Bl(await oi(n.fetch,`${n.url}/object/info/${r}`,{headers:n.headers})))}async exists(s){var n=this;const r=n._getFinalPath(s);try{return await ym(n.fetch,`${n.url}/object/${r}`,{headers:n.headers}),{data:!0,error:null}}catch(o){if(n.shouldThrowOnError)throw o;if(La(o)&&o instanceof mh){const u=o.originalError;if([400,404].includes(u?.status))return{data:!1,error:o}}throw o}}getPublicUrl(s,n){const r=this._getFinalPath(s),o=[],u=n?.download?`download=${n.download===!0?"":n.download}`:"";u!==""&&o.push(u);const d=typeof n?.transform<"u"?"render/image":"object",f=this.transformOptsToQueryString(n?.transform||{});f!==""&&o.push(f);let p=o.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${r}${p}`)}}}async remove(s){var n=this;return n.handleOperation(async()=>await Yl(n.fetch,`${n.url}/object/${n.bucketId}`,{prefixes:s},{headers:n.headers}))}async list(s,n,r){var o=this;return o.handleOperation(async()=>{const u=Ae(Ae(Ae({},km),n),{},{prefix:s||""});return await mn(o.fetch,`${o.url}/object/list/${o.bucketId}`,u,{headers:o.headers},r)})}async listV2(s,n){var r=this;return r.handleOperation(async()=>{const o=Ae({},s);return await mn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,o,{headers:r.headers},n)})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const n=[];return s.width&&n.push(`width=${s.width}`),s.height&&n.push(`height=${s.height}`),s.resize&&n.push(`resize=${s.resize}`),s.format&&n.push(`format=${s.format}`),s.quality&&n.push(`quality=${s.quality}`),n.join("&")}};const xm="2.97.0",di={"X-Client-Info":`storage-js/${xm}`};var bm=class extends ws{constructor(s,n={},r,o){const u=new URL(s);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(u.hostname)&&!u.hostname.includes("storage.supabase.")&&(u.hostname=u.hostname.replace("supabase.","storage.supabase."));const d=u.href.replace(/\/$/,""),f=Ae(Ae({},di),n);super(d,f,r,"storage")}async listBuckets(s){var n=this;return n.handleOperation(async()=>{const r=n.listBucketOptionsToQueryString(s);return await oi(n.fetch,`${n.url}/bucket${r}`,{headers:n.headers})})}async getBucket(s){var n=this;return n.handleOperation(async()=>await oi(n.fetch,`${n.url}/bucket/${s}`,{headers:n.headers}))}async createBucket(s,n={public:!1}){var r=this;return r.handleOperation(async()=>await mn(r.fetch,`${r.url}/bucket`,{id:s,name:s,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:r.headers}))}async updateBucket(s,n){var r=this;return r.handleOperation(async()=>await Ml(r.fetch,`${r.url}/bucket/${s}`,{id:s,name:s,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(s){var n=this;return n.handleOperation(async()=>await mn(n.fetch,`${n.url}/bucket/${s}/empty`,{},{headers:n.headers}))}async deleteBucket(s){var n=this;return n.handleOperation(async()=>await Yl(n.fetch,`${n.url}/bucket/${s}`,{},{headers:n.headers}))}listBucketOptionsToQueryString(s){const n={};return s&&("limit"in s&&(n.limit=String(s.limit)),"offset"in s&&(n.offset=String(s.offset)),s.search&&(n.search=s.search),s.sortColumn&&(n.sortColumn=s.sortColumn),s.sortOrder&&(n.sortOrder=s.sortOrder)),Object.keys(n).length>0?"?"+new URLSearchParams(n).toString():""}},jm=class extends ws{constructor(s,n={},r){const o=s.replace(/\/$/,""),u=Ae(Ae({},di),n);super(o,u,r,"storage")}async createBucket(s){var n=this;return n.handleOperation(async()=>await mn(n.fetch,`${n.url}/bucket`,{name:s},{headers:n.headers}))}async listBuckets(s){var n=this;return n.handleOperation(async()=>{const r=new URLSearchParams;s?.limit!==void 0&&r.set("limit",s.limit.toString()),s?.offset!==void 0&&r.set("offset",s.offset.toString()),s?.sortColumn&&r.set("sortColumn",s.sortColumn),s?.sortOrder&&r.set("sortOrder",s.sortOrder),s?.search&&r.set("search",s.search);const o=r.toString(),u=o?`${n.url}/bucket?${o}`:`${n.url}/bucket`;return await oi(n.fetch,u,{headers:n.headers})})}async deleteBucket(s){var n=this;return n.handleOperation(async()=>await Yl(n.fetch,`${n.url}/bucket/${s}`,{},{headers:n.headers}))}from(s){var n=this;if(!dm(s))throw new Aa("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new lm({baseUrl:this.url,catalogName:s,auth:{type:"custom",getHeaders:async()=>n.headers},fetch:this.fetch}),o=this.shouldThrowOnError;return new Proxy(r,{get(u,d){const f=u[d];return typeof f!="function"?f:async(...p)=>{try{return{data:await f.apply(u,p),error:null}}catch(g){if(o)throw g;return{data:null,error:g}}}}})}},Nm=class extends ws{constructor(s,n={},r){const o=s.replace(/\/$/,""),u=Ae(Ae({},di),{},{"Content-Type":"application/json"},n);super(o,u,r,"vectors")}async createIndex(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/CreateIndex`,s,{headers:n.headers})||{})}async getIndex(s,n){var r=this;return r.handleOperation(async()=>await Jt.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:s,indexName:n},{headers:r.headers}))}async listIndexes(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/ListIndexes`,s,{headers:n.headers}))}async deleteIndex(s,n){var r=this;return r.handleOperation(async()=>await Jt.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:s,indexName:n},{headers:r.headers})||{})}},Em=class extends ws{constructor(s,n={},r){const o=s.replace(/\/$/,""),u=Ae(Ae({},di),{},{"Content-Type":"application/json"},n);super(o,u,r,"vectors")}async putVectors(s){var n=this;if(s.vectors.length<1||s.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/PutVectors`,s,{headers:n.headers})||{})}async getVectors(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/GetVectors`,s,{headers:n.headers}))}async listVectors(s){var n=this;if(s.segmentCount!==void 0){if(s.segmentCount<1||s.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(s.segmentIndex!==void 0&&(s.segmentIndex<0||s.segmentIndex>=s.segmentCount))throw new Error(`segmentIndex must be between 0 and ${s.segmentCount-1}`)}return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/ListVectors`,s,{headers:n.headers}))}async queryVectors(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/QueryVectors`,s,{headers:n.headers}))}async deleteVectors(s){var n=this;if(s.keys.length<1||s.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/DeleteVectors`,s,{headers:n.headers})||{})}},Cm=class extends ws{constructor(s,n={},r){const o=s.replace(/\/$/,""),u=Ae(Ae({},di),{},{"Content-Type":"application/json"},n);super(o,u,r,"vectors")}async createBucket(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/CreateVectorBucket`,{vectorBucketName:s},{headers:n.headers})||{})}async getBucket(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/GetVectorBucket`,{vectorBucketName:s},{headers:n.headers}))}async listBuckets(s={}){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/ListVectorBuckets`,s,{headers:n.headers}))}async deleteBucket(s){var n=this;return n.handleOperation(async()=>await Jt.post(n.fetch,`${n.url}/DeleteVectorBucket`,{vectorBucketName:s},{headers:n.headers})||{})}},Tm=class extends Cm{constructor(s,n={}){super(s,n.headers||{},n.fetch)}from(s){return new Rm(this.url,this.headers,s,this.fetch)}async createBucket(s){var n=()=>super.createBucket,r=this;return n().call(r,s)}async getBucket(s){var n=()=>super.getBucket,r=this;return n().call(r,s)}async listBuckets(s={}){var n=()=>super.listBuckets,r=this;return n().call(r,s)}async deleteBucket(s){var n=()=>super.deleteBucket,r=this;return n().call(r,s)}},Rm=class extends Nm{constructor(s,n,r,o){super(s,n,o),this.vectorBucketName=r}async createIndex(s){var n=()=>super.createIndex,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(s={}){var n=()=>super.listIndexes,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(s){var n=()=>super.getIndex,r=this;return n().call(r,r.vectorBucketName,s)}async deleteIndex(s){var n=()=>super.deleteIndex,r=this;return n().call(r,r.vectorBucketName,s)}index(s){return new Pm(this.url,this.headers,this.vectorBucketName,s,this.fetch)}},Pm=class extends Em{constructor(s,n,r,o,u){super(s,n,u),this.vectorBucketName=r,this.indexName=o}async putVectors(s){var n=()=>super.putVectors,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(s){var n=()=>super.getVectors,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(s={}){var n=()=>super.listVectors,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(s){var n=()=>super.queryVectors,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(s){var n=()=>super.deleteVectors,r=this;return n().call(r,Ae(Ae({},s),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Om=class extends bm{constructor(s,n={},r,o){super(s,n,r,o)}from(s){return new Sm(this.url,this.headers,s,this.fetch)}get vectors(){return new Tm(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new jm(this.url+"/iceberg",this.headers,this.fetch)}};const yh="2.97.0",ms=30*1e3,Wl=3,Rl=Wl*ms,Im="http://localhost:9999",Am="supabase.auth.token",Lm={"X-Client-Info":`gotrue-js/${yh}`},ql="X-Supabase-Api-Version",wh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Dm=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Um=600*1e3;class li extends Error{constructor(n,r,o){super(n),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=o}}function xe(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class $m extends li{constructor(n,r,o){super(n,r,o),this.name="AuthApiError",this.status=r,this.code=o}}function zm(s){return xe(s)&&s.name==="AuthApiError"}class Ar extends li{constructor(n,r){super(n),this.name="AuthUnknownError",this.originalError=r}}class Un extends li{constructor(n,r,o,u){super(n,o,u),this.name=r,this.status=o}}class Gt extends Un{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Pl(s){return xe(s)&&s.name==="AuthSessionMissingError"}class cs extends Un{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ea extends Un{constructor(n){super(n,"AuthInvalidCredentialsError",400,void 0)}}class Ca extends Un{constructor(n,r=null){super(n,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Fm(s){return xe(s)&&s.name==="AuthImplicitGrantRedirectError"}class Wd extends Un{constructor(n,r=null){super(n,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bm extends Un{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Kl extends Un{constructor(n,r){super(n,"AuthRetryableFetchError",r,void 0)}}function Ol(s){return xe(s)&&s.name==="AuthRetryableFetchError"}class qd extends Un{constructor(n,r,o){super(n,"AuthWeakPasswordError",r,"weak_password"),this.reasons=o}}class Vl extends Un{constructor(n){super(n,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Kd=` 	
\r=`.split(""),Mm=(()=>{const s=new Array(128);for(let n=0;n<s.length;n+=1)s[n]=-1;for(let n=0;n<Kd.length;n+=1)s[Kd[n].charCodeAt(0)]=-2;for(let n=0;n<Ra.length;n+=1)s[Ra[n].charCodeAt(0)]=n;return s})();function Vd(s,n,r){if(s!==null)for(n.queue=n.queue<<8|s,n.queuedBits+=8;n.queuedBits>=6;){const o=n.queue>>n.queuedBits-6&63;r(Ra[o]),n.queuedBits-=6}else if(n.queuedBits>0)for(n.queue=n.queue<<6-n.queuedBits,n.queuedBits=6;n.queuedBits>=6;){const o=n.queue>>n.queuedBits-6&63;r(Ra[o]),n.queuedBits-=6}}function _h(s,n,r){const o=Mm[s];if(o>-1)for(n.queue=n.queue<<6|o,n.queuedBits+=6;n.queuedBits>=8;)r(n.queue>>n.queuedBits-8&255),n.queuedBits-=8;else{if(o===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function Hd(s){const n=[],r=f=>{n.push(String.fromCodePoint(f))},o={utf8seq:0,codepoint:0},u={queue:0,queuedBits:0},d=f=>{Km(f,o,r)};for(let f=0;f<s.length;f+=1)_h(s.charCodeAt(f),u,d);return n.join("")}function Wm(s,n){if(s<=127){n(s);return}else if(s<=2047){n(192|s>>6),n(128|s&63);return}else if(s<=65535){n(224|s>>12),n(128|s>>6&63),n(128|s&63);return}else if(s<=1114111){n(240|s>>18),n(128|s>>12&63),n(128|s>>6&63),n(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function qm(s,n){for(let r=0;r<s.length;r+=1){let o=s.charCodeAt(r);if(o>55295&&o<=56319){const u=(o-55296)*1024&65535;o=(s.charCodeAt(r+1)-56320&65535|u)+65536,r+=1}Wm(o,n)}}function Km(s,n,r){if(n.utf8seq===0){if(s<=127){r(s);return}for(let o=1;o<6;o+=1)if((s>>7-o&1)===0){n.utf8seq=o;break}if(n.utf8seq===2)n.codepoint=s&31;else if(n.utf8seq===3)n.codepoint=s&15;else if(n.utf8seq===4)n.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");n.utf8seq-=1}else if(n.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");n.codepoint=n.codepoint<<6|s&63,n.utf8seq-=1,n.utf8seq===0&&r(n.codepoint)}}function ys(s){const n=[],r={queue:0,queuedBits:0},o=u=>{n.push(u)};for(let u=0;u<s.length;u+=1)_h(s.charCodeAt(u),r,o);return new Uint8Array(n)}function Vm(s){const n=[];return qm(s,r=>n.push(r)),new Uint8Array(n)}function Lr(s){const n=[],r={queue:0,queuedBits:0},o=u=>{n.push(u)};return s.forEach(u=>Vd(u,r,o)),Vd(null,r,o),n.join("")}function Hm(s){return Math.round(Date.now()/1e3)+s}function Gm(){return Symbol("auth-callback")}const Tt=()=>typeof window<"u"&&typeof document<"u",Rr={tested:!1,writable:!1},kh=()=>{if(!Tt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rr.tested)return Rr.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),Rr.tested=!0,Rr.writable=!0}catch{Rr.tested=!0,Rr.writable=!1}return Rr.writable};function Jm(s){const n={},r=new URL(s);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((u,d)=>{n[d]=u})}catch{}return r.searchParams.forEach((o,u)=>{n[u]=o}),n}const Sh=s=>s?(...n)=>s(...n):(...n)=>fetch(...n),Qm=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",gs=async(s,n,r)=>{await s.setItem(n,JSON.stringify(r))},Pr=async(s,n)=>{const r=await s.getItem(n);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ct=async(s,n)=>{await s.removeItem(n)};class Da{constructor(){this.promise=new Da.promiseConstructor((n,r)=>{this.resolve=n,this.reject=r})}}Da.promiseConstructor=Promise;function Ta(s){const n=s.split(".");if(n.length!==3)throw new Vl("Invalid JWT structure");for(let o=0;o<n.length;o++)if(!Dm.test(n[o]))throw new Vl("JWT not in base64url format");return{header:JSON.parse(Hd(n[0])),payload:JSON.parse(Hd(n[1])),signature:ys(n[2]),raw:{header:n[0],payload:n[1]}}}async function Ym(s){return await new Promise(n=>{setTimeout(()=>n(null),s)})}function Xm(s,n){return new Promise((o,u)=>{(async()=>{for(let d=0;d<1/0;d++)try{const f=await s(d);if(!n(d,null,f)){o(f);return}}catch(f){if(!n(d,f)){u(f);return}}})()})}function Zm(s){return("0"+s.toString(16)).substr(-2)}function eg(){const n=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",o=r.length;let u="";for(let d=0;d<56;d++)u+=r.charAt(Math.floor(Math.random()*o));return u}return crypto.getRandomValues(n),Array.from(n,Zm).join("")}async function tg(s){const r=new TextEncoder().encode(s),o=await crypto.subtle.digest("SHA-256",r),u=new Uint8Array(o);return Array.from(u).map(d=>String.fromCharCode(d)).join("")}async function ng(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const r=await tg(s);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function us(s,n,r=!1){const o=eg();let u=o;r&&(u+="/PASSWORD_RECOVERY"),await gs(s,`${n}-code-verifier`,u);const d=await ng(o);return[d,o===d?"plain":"s256"]}const rg=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sg(s){const n=s.headers.get(ql);if(!n||!n.match(rg))return null;try{return new Date(`${n}T00:00:00.0Z`)}catch{return null}}function ig(s){if(!s)throw new Error("Missing exp claim");const n=Math.floor(Date.now()/1e3);if(s<=n)throw new Error("JWT has expired")}function ag(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const og=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ds(s){if(!og.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Il(){const s={};return new Proxy(s,{get:(n,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const o=r.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(n,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(n,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function lg(s,n){return new Proxy(s,{get:(r,o,u)=>{if(o==="__isInsecureUserWarningProxy")return!0;if(typeof o=="symbol"){const d=o.toString();if(d==="Symbol(Symbol.toPrimitive)"||d==="Symbol(Symbol.toStringTag)"||d==="Symbol(util.inspect.custom)"||d==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,o,u)}return!n.value&&typeof o=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),n.value=!0),Reflect.get(r,o,u)}})}function Gd(s){return JSON.parse(JSON.stringify(s))}const Or=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),cg=[502,503,504];async function Jd(s){var n;if(!Qm(s))throw new Kl(Or(s),0);if(cg.includes(s.status))throw new Kl(Or(s),s.status);let r;try{r=await s.json()}catch(d){throw new Ar(Or(d),d)}let o;const u=sg(s);if(u&&u.getTime()>=wh["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?o=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(o=r.error_code),o){if(o==="weak_password")throw new qd(Or(r),s.status,((n=r.weak_password)===null||n===void 0?void 0:n.reasons)||[]);if(o==="session_not_found")throw new Gt}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((d,f)=>d&&typeof f=="string",!0))throw new qd(Or(r),s.status,r.weak_password.reasons);throw new $m(Or(r),s.status||500,o)}const ug=(s,n,r,o)=>{const u={method:s,headers:n?.headers||{}};return s==="GET"?u:(u.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},n?.headers),u.body=JSON.stringify(o),Object.assign(Object.assign({},u),r))};async function De(s,n,r,o){var u;const d=Object.assign({},o?.headers);d[ql]||(d[ql]=wh["2024-01-01"].name),o?.jwt&&(d.Authorization=`Bearer ${o.jwt}`);const f=(u=o?.query)!==null&&u!==void 0?u:{};o?.redirectTo&&(f.redirect_to=o.redirectTo);const p=Object.keys(f).length?"?"+new URLSearchParams(f).toString():"",g=await dg(s,n,r+p,{headers:d,noResolveJson:o?.noResolveJson},{},o?.body);return o?.xform?o?.xform(g):{data:Object.assign({},g),error:null}}async function dg(s,n,r,o,u,d){const f=ug(n,o,u,d);let p;try{p=await s(r,Object.assign({},f))}catch(g){throw console.error(g),new Kl(Or(g),0)}if(p.ok||await Jd(p),o?.noResolveJson)return p;try{return await p.json()}catch(g){await Jd(g)}}function pn(s){var n;let r=null;pg(s)&&(r=Object.assign({},s),s.expires_at||(r.expires_at=Hm(s.expires_in)));const o=(n=s.user)!==null&&n!==void 0?n:s;return{data:{session:r,user:o},error:null}}function Qd(s){const n=pn(s);return!n.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0)&&(n.data.weak_password=s.weak_password),n}function lr(s){var n;return{data:{user:(n=s.user)!==null&&n!==void 0?n:s},error:null}}function hg(s){return{data:s,error:null}}function fg(s){const{action_link:n,email_otp:r,hashed_token:o,redirect_to:u,verification_type:d}=s,f=Ia(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),p={action_link:n,email_otp:r,hashed_token:o,redirect_to:u,verification_type:d},g=Object.assign({},f);return{data:{properties:p,user:g},error:null}}function Yd(s){return s}function pg(s){return s.access_token&&s.refresh_token&&s.expires_in}const Al=["global","local","others"];class mg{constructor({url:n="",headers:r={},fetch:o}){this.url=n,this.headers=r,this.fetch=Sh(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(n,r=Al[0]){if(Al.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Al.join(", ")}`);try{return await De(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:n,noResolveJson:!0}),{data:null,error:null}}catch(o){if(xe(o))return{data:null,error:o};throw o}}async inviteUserByEmail(n,r={}){try{return await De(this.fetch,"POST",`${this.url}/invite`,{body:{email:n,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:lr})}catch(o){if(xe(o))return{data:{user:null},error:o};throw o}}async generateLink(n){try{const{options:r}=n,o=Ia(n,["options"]),u=Object.assign(Object.assign({},o),r);return"newEmail"in o&&(u.new_email=o?.newEmail,delete u.newEmail),await De(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:u,headers:this.headers,xform:fg,redirectTo:r?.redirectTo})}catch(r){if(xe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(n){try{return await De(this.fetch,"POST",`${this.url}/admin/users`,{body:n,headers:this.headers,xform:lr})}catch(r){if(xe(r))return{data:{user:null},error:r};throw r}}async listUsers(n){var r,o,u,d,f,p,g;try{const v={nextPage:null,lastPage:0,total:0},y=await De(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(r=n?.page)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:"",per_page:(d=(u=n?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:Yd});if(y.error)throw y.error;const E=await y.json(),j=(f=y.headers.get("x-total-count"))!==null&&f!==void 0?f:0,x=(g=(p=y.headers.get("link"))===null||p===void 0?void 0:p.split(","))!==null&&g!==void 0?g:[];return x.length>0&&(x.forEach(A=>{const P=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),D=JSON.parse(A.split(";")[1].split("=")[1]);v[`${D}Page`]=P}),v.total=parseInt(j)),{data:Object.assign(Object.assign({},E),v),error:null}}catch(v){if(xe(v))return{data:{users:[]},error:v};throw v}}async getUserById(n){ds(n);try{return await De(this.fetch,"GET",`${this.url}/admin/users/${n}`,{headers:this.headers,xform:lr})}catch(r){if(xe(r))return{data:{user:null},error:r};throw r}}async updateUserById(n,r){ds(n);try{return await De(this.fetch,"PUT",`${this.url}/admin/users/${n}`,{body:r,headers:this.headers,xform:lr})}catch(o){if(xe(o))return{data:{user:null},error:o};throw o}}async deleteUser(n,r=!1){ds(n);try{return await De(this.fetch,"DELETE",`${this.url}/admin/users/${n}`,{headers:this.headers,body:{should_soft_delete:r},xform:lr})}catch(o){if(xe(o))return{data:{user:null},error:o};throw o}}async _listFactors(n){ds(n.userId);try{const{data:r,error:o}=await De(this.fetch,"GET",`${this.url}/admin/users/${n.userId}/factors`,{headers:this.headers,xform:u=>({data:{factors:u},error:null})});return{data:r,error:o}}catch(r){if(xe(r))return{data:null,error:r};throw r}}async _deleteFactor(n){ds(n.userId),ds(n.id);try{return{data:await De(this.fetch,"DELETE",`${this.url}/admin/users/${n.userId}/factors/${n.id}`,{headers:this.headers}),error:null}}catch(r){if(xe(r))return{data:null,error:r};throw r}}async _listOAuthClients(n){var r,o,u,d,f,p,g;try{const v={nextPage:null,lastPage:0,total:0},y=await De(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(o=(r=n?.page)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:"",per_page:(d=(u=n?.perPage)===null||u===void 0?void 0:u.toString())!==null&&d!==void 0?d:""},xform:Yd});if(y.error)throw y.error;const E=await y.json(),j=(f=y.headers.get("x-total-count"))!==null&&f!==void 0?f:0,x=(g=(p=y.headers.get("link"))===null||p===void 0?void 0:p.split(","))!==null&&g!==void 0?g:[];return x.length>0&&(x.forEach(A=>{const P=parseInt(A.split(";")[0].split("=")[1].substring(0,1)),D=JSON.parse(A.split(";")[1].split("=")[1]);v[`${D}Page`]=P}),v.total=parseInt(j)),{data:Object.assign(Object.assign({},E),v),error:null}}catch(v){if(xe(v))return{data:{clients:[]},error:v};throw v}}async _createOAuthClient(n){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(xe(r))return{data:null,error:r};throw r}}async _getOAuthClient(n){try{return await De(this.fetch,"GET",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(xe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(n,r){try{return await De(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${n}`,{body:r,headers:this.headers,xform:o=>({data:o,error:null})})}catch(o){if(xe(o))return{data:null,error:o};throw o}}async _deleteOAuthClient(n){try{return await De(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(xe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(n){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients/${n}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(xe(r))return{data:null,error:r};throw r}}}function Xd(s={}){return{getItem:n=>s[n]||null,setItem:(n,r)=>{s[n]=r},removeItem:n=>{delete s[n]}}}const hs={debug:!!(globalThis&&kh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class xh extends Error{constructor(n){super(n),this.isAcquireTimeout=!0}}class Zd extends xh{}async function gg(s,n,r){hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,n);const o=new globalThis.AbortController;n>0&&setTimeout(()=>{o.abort(),hs.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},n),await Promise.resolve();try{return await globalThis.navigator.locks.request(s,n===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async u=>{if(u){hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,u.name);try{return await r()}finally{hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,u.name)}}else{if(n===0)throw hs.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new Zd(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(hs.debug)try{const d=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(d,null,"  "))}catch(d){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",d)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}catch(u){throw u?.name==="AbortError"?new Zd(`Acquiring an exclusive Navigator LockManager lock "${s}" timed out waiting ${n}ms`):u}}function vg(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function bh(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function yg(s){return parseInt(s,16)}function wg(s){const n=new TextEncoder().encode(s);return"0x"+Array.from(n,o=>o.toString(16).padStart(2,"0")).join("")}function _g(s){var n;const{chainId:r,domain:o,expirationTime:u,issuedAt:d=new Date,nonce:f,notBefore:p,requestId:g,resources:v,scheme:y,uri:E,version:j}=s;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!o)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(f&&f.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${f}`);if(!E)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(j!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${j}`);if(!((n=s.statement)===null||n===void 0)&&n.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const x=bh(s.address),A=y?`${y}://${o}`:o,P=s.statement?`${s.statement}
`:"",D=`${A} wants you to sign in with your Ethereum account:
${x}

${P}`;let M=`URI: ${E}
Version: ${j}
Chain ID: ${r}${f?`
Nonce: ${f}`:""}
Issued At: ${d.toISOString()}`;if(u&&(M+=`
Expiration Time: ${u.toISOString()}`),p&&(M+=`
Not Before: ${p.toISOString()}`),g&&(M+=`
Request ID: ${g}`),v){let W=`
Resources:`;for(const F of v){if(!F||typeof F!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${F}`);W+=`
- ${F}`}M+=W}return`${D}
${M}`}class vt extends Error{constructor({message:n,code:r,cause:o,name:u}){var d;super(n,{cause:o}),this.__isWebAuthnError=!0,this.name=(d=u??(o instanceof Error?o.name:void 0))!==null&&d!==void 0?d:"Unknown Error",this.code=r}}class Pa extends vt{constructor(n,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:n}),this.name="WebAuthnUnknownError",this.originalError=r}}function kg({error:s,options:n}){var r,o,u;const{publicKey:d}=n;if(!d)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(n.signal instanceof AbortSignal)return new vt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((r=d.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new vt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(n.mediation==="conditional"&&((o=d.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new vt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((u=d.authenticatorSelection)===null||u===void 0?void 0:u.userVerification)==="required")return new vt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new vt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new vt({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return d.pubKeyCredParams.filter(p=>p.type==="public-key").length===0?new vt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new vt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const f=window.location.hostname;if(jh(f)){if(d.rp.id!==f)return new vt({message:`The RP ID "${d.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(d.user.id.byteLength<1||d.user.id.byteLength>64)return new vt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new vt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function Sg({error:s,options:n}){const{publicKey:r}=n;if(!r)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(n.signal instanceof AbortSignal)return new vt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new vt({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const o=window.location.hostname;if(jh(o)){if(r.rpId!==o)return new vt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new vt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new vt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new vt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}class xg{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const n=new AbortController;return this.controller=n,n.signal}cancelCeremony(){if(this.controller){const n=new Error("Manually cancelling existing WebAuthn API call");n.name="AbortError",this.controller.abort(n),this.controller=void 0}}}const bg=new xg;function jg(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:n,user:r,excludeCredentials:o}=s,u=Ia(s,["challenge","user","excludeCredentials"]),d=ys(n).buffer,f=Object.assign(Object.assign({},r),{id:ys(r.id).buffer}),p=Object.assign(Object.assign({},u),{challenge:d,user:f});if(o&&o.length>0){p.excludeCredentials=new Array(o.length);for(let g=0;g<o.length;g++){const v=o[g];p.excludeCredentials[g]=Object.assign(Object.assign({},v),{id:ys(v.id).buffer,type:v.type||"public-key",transports:v.transports})}}return p}function Ng(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:n,allowCredentials:r}=s,o=Ia(s,["challenge","allowCredentials"]),u=ys(n).buffer,d=Object.assign(Object.assign({},o),{challenge:u});if(r&&r.length>0){d.allowCredentials=new Array(r.length);for(let f=0;f<r.length;f++){const p=r[f];d.allowCredentials[f]=Object.assign(Object.assign({},p),{id:ys(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return d}function Eg(s){var n;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s;return{id:s.id,rawId:s.id,response:{attestationObject:Lr(new Uint8Array(s.response.attestationObject)),clientDataJSON:Lr(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(n=r.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function Cg(s){var n;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const r=s,o=s.getClientExtensionResults(),u=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:Lr(new Uint8Array(u.authenticatorData)),clientDataJSON:Lr(new Uint8Array(u.clientDataJSON)),signature:Lr(new Uint8Array(u.signature)),userHandle:u.userHandle?Lr(new Uint8Array(u.userHandle)):void 0},type:"public-key",clientExtensionResults:o,authenticatorAttachment:(n=r.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function jh(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function eh(){var s,n;return!!(Tt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.get)=="function")}async function Tg(s){try{const n=await navigator.credentials.create(s);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Pa("Browser returned unexpected credential type",n)}:{data:null,error:new Pa("Empty credential response",n)}}catch(n){return{data:null,error:kg({error:n,options:s})}}}async function Rg(s){try{const n=await navigator.credentials.get(s);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new Pa("Browser returned unexpected credential type",n)}:{data:null,error:new Pa("Empty credential response",n)}}catch(n){return{data:null,error:Sg({error:n,options:s})}}}const Pg={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Og={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Oa(...s){const n=u=>u!==null&&typeof u=="object"&&!Array.isArray(u),r=u=>u instanceof ArrayBuffer||ArrayBuffer.isView(u),o={};for(const u of s)if(u)for(const d in u){const f=u[d];if(f!==void 0)if(Array.isArray(f))o[d]=f;else if(r(f))o[d]=f;else if(n(f)){const p=o[d];n(p)?o[d]=Oa(p,f):o[d]=Oa(f)}else o[d]=f}return o}function Ig(s,n){return Oa(Pg,s,n||{})}function Ag(s,n){return Oa(Og,s,n||{})}class Lg{constructor(n){this.client=n,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(n){return this.client.mfa.enroll(Object.assign(Object.assign({},n),{factorType:"webauthn"}))}async _challenge({factorId:n,webauthn:r,friendlyName:o,signal:u},d){var f;try{const{data:p,error:g}=await this.client.mfa.challenge({factorId:n,webauthn:r});if(!p)return{data:null,error:g};const v=u??bg.createNewAbortSignal();if(p.webauthn.type==="create"){const{user:y}=p.webauthn.credential_options.publicKey;if(!y.name){const E=o;if(E)y.name=`${y.id}:${E}`;else{const x=(await this.client.getUser()).data.user,A=((f=x?.user_metadata)===null||f===void 0?void 0:f.name)||x?.email||x?.id||"User";y.name=`${y.id}:${A}`}}y.displayName||(y.displayName=y.name)}switch(p.webauthn.type){case"create":{const y=Ig(p.webauthn.credential_options.publicKey,d?.create),{data:E,error:j}=await Tg({publicKey:y,signal:v});return E?{data:{factorId:n,challengeId:p.id,webauthn:{type:p.webauthn.type,credential_response:E}},error:null}:{data:null,error:j}}case"request":{const y=Ag(p.webauthn.credential_options.publicKey,d?.request),{data:E,error:j}=await Rg(Object.assign(Object.assign({},p.webauthn.credential_options),{publicKey:y,signal:v}));return E?{data:{factorId:n,challengeId:p.id,webauthn:{type:p.webauthn.type,credential_response:E}},error:null}:{data:null,error:j}}}}catch(p){return xe(p)?{data:null,error:p}:{data:null,error:new Ar("Unexpected error in challenge",p)}}}async _verify({challengeId:n,factorId:r,webauthn:o}){return this.client.mfa.verify({factorId:r,challengeId:n,webauthn:o})}async _authenticate({factorId:n,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!r)return{data:null,error:new li("rpId is required for WebAuthn authentication")};try{if(!eh())return{data:null,error:new Ar("Browser does not support WebAuthn",null)};const{data:f,error:p}=await this.challenge({factorId:n,webauthn:{rpId:r,rpOrigins:o},signal:u},{request:d});if(!f)return{data:null,error:p};const{webauthn:g}=f;return this._verify({factorId:n,challengeId:f.challengeId,webauthn:{type:g.type,rpId:r,rpOrigins:o,credential_response:g.credential_response}})}catch(f){return xe(f)?{data:null,error:f}:{data:null,error:new Ar("Unexpected error in authenticate",f)}}}async _register({friendlyName:n,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:o=typeof window<"u"?[window.location.origin]:void 0,signal:u}={}},d){if(!r)return{data:null,error:new li("rpId is required for WebAuthn registration")};try{if(!eh())return{data:null,error:new Ar("Browser does not support WebAuthn",null)};const{data:f,error:p}=await this._enroll({friendlyName:n});if(!f)return await this.client.mfa.listFactors().then(y=>{var E;return(E=y.data)===null||E===void 0?void 0:E.all.find(j=>j.factor_type==="webauthn"&&j.friendly_name===n&&j.status!=="unverified")}).then(y=>y?this.client.mfa.unenroll({factorId:y?.id}):void 0),{data:null,error:p};const{data:g,error:v}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:r,rpOrigins:o},signal:u},{create:d});return g?this._verify({factorId:f.id,challengeId:g.challengeId,webauthn:{rpId:r,rpOrigins:o,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:v}}catch(f){return xe(f)?{data:null,error:f}:{data:null,error:new Ar("Unexpected error in register",f)}}}}vg();const Dg={url:Im,storageKey:Am,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Lm,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function th(s,n,r){return await r()}const fs={};class ci{get jwks(){var n,r;return(r=(n=fs[this.storageKey])===null||n===void 0?void 0:n.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(n){fs[this.storageKey]=Object.assign(Object.assign({},fs[this.storageKey]),{jwks:n})}get jwks_cached_at(){var n,r;return(r=(n=fs[this.storageKey])===null||n===void 0?void 0:n.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(n){fs[this.storageKey]=Object.assign(Object.assign({},fs[this.storageKey]),{cachedAt:n})}constructor(n){var r,o,u;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const d=Object.assign(Object.assign({},Dg),n);if(this.storageKey=d.storageKey,this.instanceID=(r=ci.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,ci.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!d.debug,typeof d.debug=="function"&&(this.logger=d.debug),this.instanceID>0&&Tt()){const f=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(f),this.logDebugMessages&&console.trace(f)}if(this.persistSession=d.persistSession,this.autoRefreshToken=d.autoRefreshToken,this.admin=new mg({url:d.url,headers:d.headers,fetch:d.fetch}),this.url=d.url,this.headers=d.headers,this.fetch=Sh(d.fetch),this.lock=d.lock||th,this.detectSessionInUrl=d.detectSessionInUrl,this.flowType=d.flowType,this.hasCustomAuthorizationHeader=d.hasCustomAuthorizationHeader,this.throwOnError=d.throwOnError,this.lockAcquireTimeout=d.lockAcquireTimeout,d.lock?this.lock=d.lock:this.persistSession&&Tt()&&(!((o=globalThis?.navigator)===null||o===void 0)&&o.locks)?this.lock=gg:this.lock=th,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Lg(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(d.storage?this.storage=d.storage:kh()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xd(this.memoryStorage)),d.userStorage&&(this.userStorage=d.userStorage)):(this.memoryStorage={},this.storage=Xd(this.memoryStorage)),Tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(f){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",f)}(u=this.broadcastChannel)===null||u===void 0||u.addEventListener("message",async f=>{this._debug("received broadcast notification from other tab or client",f);try{await this._notifyAllSubscribers(f.data.event,f.data.session,!1)}catch(p){this._debug("#broadcastChannel","error",p)}})}d.skipAutoInitialize||this.initialize().catch(f=>{this._debug("#initialize()","error",f)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(n){if(this.throwOnError&&n&&n.error)throw n.error;return n}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${yh}) ${new Date().toISOString()}`}_debug(...n){return this.logDebugMessages&&this.logger(this._logPrefix(),...n),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var n;try{let r={},o="none";if(Tt()&&(r=Jm(window.location.href),this._isImplicitGrantCallback(r)?o="implicit":await this._isPKCECallback(r)&&(o="pkce")),Tt()&&this.detectSessionInUrl&&o!=="none"){const{data:u,error:d}=await this._getSessionFromURL(r,o);if(d){if(this._debug("#_initialize()","error detecting session from URL",d),Fm(d)){const g=(n=d.details)===null||n===void 0?void 0:n.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:d}}return{error:d}}const{session:f,redirectType:p}=u;return this._debug("#_initialize()","detected session in URL",f,"redirect type",p),await this._saveSession(f),setTimeout(async()=>{p==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return xe(r)?this._returnResult({error:r}):this._returnResult({error:new Ar("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(n){var r,o,u;try{const d=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(o=(r=n?.options)===null||r===void 0?void 0:r.data)!==null&&o!==void 0?o:{},gotrue_meta_security:{captcha_token:(u=n?.options)===null||u===void 0?void 0:u.captchaToken}},xform:pn}),{data:f,error:p}=d;if(p||!f)return this._returnResult({data:{user:null,session:null},error:p});const g=f.session,v=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:v,session:g},error:null})}catch(d){if(xe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signUp(n){var r,o,u;try{let d;if("email"in n){const{email:y,password:E,options:j}=n;let x=null,A=null;this.flowType==="pkce"&&([x,A]=await us(this.storage,this.storageKey)),d=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:j?.emailRedirectTo,body:{email:y,password:E,data:(r=j?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:j?.captchaToken},code_challenge:x,code_challenge_method:A},xform:pn})}else if("phone"in n){const{phone:y,password:E,options:j}=n;d=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:y,password:E,data:(o=j?.data)!==null&&o!==void 0?o:{},channel:(u=j?.channel)!==null&&u!==void 0?u:"sms",gotrue_meta_security:{captcha_token:j?.captchaToken}},xform:pn})}else throw new Ea("You must provide either an email or phone number and a password");const{data:f,error:p}=d;if(p||!f)return await Ct(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:p});const g=f.session,v=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:v,session:g},error:null})}catch(d){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithPassword(n){try{let r;if("email"in n){const{email:d,password:f,options:p}=n;r=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:d,password:f,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Qd})}else if("phone"in n){const{phone:d,password:f,options:p}=n;r=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:d,password:f,gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Qd})}else throw new Ea("You must provide either an email or phone number and a password");const{data:o,error:u}=r;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!o||!o.session||!o.user){const d=new cs;return this._returnResult({data:{user:null,session:null},error:d})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign({user:o.user,session:o.session},o.weak_password?{weakPassword:o.weak_password}:null),error:u})}catch(r){if(xe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(n){var r,o,u,d;return await this._handleProviderSignIn(n.provider,{redirectTo:(r=n.options)===null||r===void 0?void 0:r.redirectTo,scopes:(o=n.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=n.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:(d=n.options)===null||d===void 0?void 0:d.skipBrowserRedirect})}async exchangeCodeForSession(n){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(n))}async signInWithWeb3(n){const{chain:r}=n;switch(r){case"ethereum":return await this.signInWithEthereum(n);case"solana":return await this.signInWithSolana(n);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(n){var r,o,u,d,f,p,g,v,y,E,j;let x,A;if("message"in n)x=n.message,A=n.signature;else{const{chain:P,wallet:D,statement:M,options:W}=n;let F;if(Tt())if(typeof D=="object")F=D;else{const je=window;if("ethereum"in je&&typeof je.ethereum=="object"&&"request"in je.ethereum&&typeof je.ethereum.request=="function")F=je.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!W?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");F=D}const H=new URL((r=W?.url)!==null&&r!==void 0?r:window.location.href),ae=await F.request({method:"eth_requestAccounts"}).then(je=>je).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ae||ae.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const le=bh(ae[0]);let ie=(o=W?.signInWithEthereum)===null||o===void 0?void 0:o.chainId;if(!ie){const je=await F.request({method:"eth_chainId"});ie=yg(je)}const be={domain:H.host,address:le,statement:M,uri:H.href,version:"1",chainId:ie,nonce:(u=W?.signInWithEthereum)===null||u===void 0?void 0:u.nonce,issuedAt:(f=(d=W?.signInWithEthereum)===null||d===void 0?void 0:d.issuedAt)!==null&&f!==void 0?f:new Date,expirationTime:(p=W?.signInWithEthereum)===null||p===void 0?void 0:p.expirationTime,notBefore:(g=W?.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(v=W?.signInWithEthereum)===null||v===void 0?void 0:v.requestId,resources:(y=W?.signInWithEthereum)===null||y===void 0?void 0:y.resources};x=_g(be),A=await F.request({method:"personal_sign",params:[wg(x),le]})}try{const{data:P,error:D}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:A},!((E=n.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(j=n.options)===null||j===void 0?void 0:j.captchaToken}}:null),xform:pn});if(D)throw D;if(!P||!P.session||!P.user){const M=new cs;return this._returnResult({data:{user:null,session:null},error:M})}return P.session&&(await this._saveSession(P.session),await this._notifyAllSubscribers("SIGNED_IN",P.session)),this._returnResult({data:Object.assign({},P),error:D})}catch(P){if(xe(P))return this._returnResult({data:{user:null,session:null},error:P});throw P}}async signInWithSolana(n){var r,o,u,d,f,p,g,v,y,E,j,x;let A,P;if("message"in n)A=n.message,P=n.signature;else{const{chain:D,wallet:M,statement:W,options:F}=n;let H;if(Tt())if(typeof M=="object")H=M;else{const le=window;if("solana"in le&&typeof le.solana=="object"&&("signIn"in le.solana&&typeof le.solana.signIn=="function"||"signMessage"in le.solana&&typeof le.solana.signMessage=="function"))H=le.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!F?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");H=M}const ae=new URL((r=F?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in H&&H.signIn){const le=await H.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},F?.signInWithSolana),{version:"1",domain:ae.host,uri:ae.href}),W?{statement:W}:null));let ie;if(Array.isArray(le)&&le[0]&&typeof le[0]=="object")ie=le[0];else if(le&&typeof le=="object"&&"signedMessage"in le&&"signature"in le)ie=le;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ie&&"signature"in ie&&(typeof ie.signedMessage=="string"||ie.signedMessage instanceof Uint8Array)&&ie.signature instanceof Uint8Array)A=typeof ie.signedMessage=="string"?ie.signedMessage:new TextDecoder().decode(ie.signedMessage),P=ie.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in H)||typeof H.signMessage!="function"||!("publicKey"in H)||typeof H!="object"||!H.publicKey||!("toBase58"in H.publicKey)||typeof H.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");A=[`${ae.host} wants you to sign in with your Solana account:`,H.publicKey.toBase58(),...W?["",W,""]:[""],"Version: 1",`URI: ${ae.href}`,`Issued At: ${(u=(o=F?.signInWithSolana)===null||o===void 0?void 0:o.issuedAt)!==null&&u!==void 0?u:new Date().toISOString()}`,...!((d=F?.signInWithSolana)===null||d===void 0)&&d.notBefore?[`Not Before: ${F.signInWithSolana.notBefore}`]:[],...!((f=F?.signInWithSolana)===null||f===void 0)&&f.expirationTime?[`Expiration Time: ${F.signInWithSolana.expirationTime}`]:[],...!((p=F?.signInWithSolana)===null||p===void 0)&&p.chainId?[`Chain ID: ${F.signInWithSolana.chainId}`]:[],...!((g=F?.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${F.signInWithSolana.nonce}`]:[],...!((v=F?.signInWithSolana)===null||v===void 0)&&v.requestId?[`Request ID: ${F.signInWithSolana.requestId}`]:[],...!((E=(y=F?.signInWithSolana)===null||y===void 0?void 0:y.resources)===null||E===void 0)&&E.length?["Resources",...F.signInWithSolana.resources.map(ie=>`- ${ie}`)]:[]].join(`
`);const le=await H.signMessage(new TextEncoder().encode(A),"utf8");if(!le||!(le instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");P=le}}try{const{data:D,error:M}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:A,signature:Lr(P)},!((j=n.options)===null||j===void 0)&&j.captchaToken?{gotrue_meta_security:{captcha_token:(x=n.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:pn});if(M)throw M;if(!D||!D.session||!D.user){const W=new cs;return this._returnResult({data:{user:null,session:null},error:W})}return D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),this._returnResult({data:Object.assign({},D),error:M})}catch(D){if(xe(D))return this._returnResult({data:{user:null,session:null},error:D});throw D}}async _exchangeCodeForSession(n){const r=await Pr(this.storage,`${this.storageKey}-code-verifier`),[o,u]=(r??"").split("/");try{if(!o&&this.flowType==="pkce")throw new Bm;const{data:d,error:f}=await De(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:n,code_verifier:o},xform:pn});if(await Ct(this.storage,`${this.storageKey}-code-verifier`),f)throw f;if(!d||!d.session||!d.user){const p=new cs;return this._returnResult({data:{user:null,session:null,redirectType:null},error:p})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:Object.assign(Object.assign({},d),{redirectType:u??null}),error:f})}catch(d){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:{user:null,session:null,redirectType:null},error:d});throw d}}async signInWithIdToken(n){try{const{options:r,provider:o,token:u,access_token:d,nonce:f}=n,p=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:o,id_token:u,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:pn}),{data:g,error:v}=p;if(v)return this._returnResult({data:{user:null,session:null},error:v});if(!g||!g.session||!g.user){const y=new cs;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:v})}catch(r){if(xe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(n){var r,o,u,d,f;try{if("email"in n){const{email:p,options:g}=n;let v=null,y=null;this.flowType==="pkce"&&([v,y]=await us(this.storage,this.storageKey));const{error:E}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:p,data:(r=g?.data)!==null&&r!==void 0?r:{},create_user:(o=g?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:g?.captchaToken},code_challenge:v,code_challenge_method:y},redirectTo:g?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:E})}if("phone"in n){const{phone:p,options:g}=n,{data:v,error:y}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:p,data:(u=g?.data)!==null&&u!==void 0?u:{},create_user:(d=g?.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:g?.captchaToken},channel:(f=g?.channel)!==null&&f!==void 0?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:v?.message_id},error:y})}throw new Ea("You must provide either an email or phone number.")}catch(p){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async verifyOtp(n){var r,o;try{let u,d;"options"in n&&(u=(r=n.options)===null||r===void 0?void 0:r.redirectTo,d=(o=n.options)===null||o===void 0?void 0:o.captchaToken);const{data:f,error:p}=await De(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},n),{gotrue_meta_security:{captcha_token:d}}),redirectTo:u,xform:pn});if(p)throw p;if(!f)throw new Error("An error occurred on token verification.");const g=f.session,v=f.user;return g?.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(n.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:v,session:g},error:null})}catch(u){if(xe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async signInWithSSO(n){var r,o,u,d,f;try{let p=null,g=null;this.flowType==="pkce"&&([p,g]=await us(this.storage,this.storageKey));const v=await De(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in n?{provider_id:n.providerId}:null),"domain"in n?{domain:n.domain}:null),{redirect_to:(o=(r=n.options)===null||r===void 0?void 0:r.redirectTo)!==null&&o!==void 0?o:void 0}),!((u=n?.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:n.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:p,code_challenge_method:g}),headers:this.headers,xform:hg});return!((d=v.data)===null||d===void 0)&&d.url&&Tt()&&!(!((f=n.options)===null||f===void 0)&&f.skipBrowserRedirect)&&window.location.assign(v.data.url),this._returnResult(v)}catch(p){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(p))return this._returnResult({data:null,error:p});throw p}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async n=>{const{data:{session:r},error:o}=n;if(o)throw o;if(!r)throw new Gt;const{error:u}=await De(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:u})})}catch(n){if(xe(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async resend(n){try{const r=`${this.url}/resend`;if("email"in n){const{email:o,type:u,options:d}=n,{error:f}=await De(this.fetch,"POST",r,{headers:this.headers,body:{email:o,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},redirectTo:d?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}else if("phone"in n){const{phone:o,type:u,options:d}=n,{data:f,error:p}=await De(this.fetch,"POST",r,{headers:this.headers,body:{phone:o,type:u,gotrue_meta_security:{captcha_token:d?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:p})}throw new Ea("You must provide either an email or phone number and a type")}catch(r){if(xe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(n,r){this._debug("#_acquireLock","begin",n);try{if(this.lockAcquired){const o=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),u=(async()=>(await o,await r()))();return this.pendingInLock.push((async()=>{try{await u}catch{}})()),u}return await this.lock(`lock:${this.storageKey}`,n,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const o=r();for(this.pendingInLock.push((async()=>{try{await o}catch{}})()),await o;this.pendingInLock.length;){const u=[...this.pendingInLock];await Promise.all(u),this.pendingInLock.splice(0,u.length)}return await o}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(n){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await n(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let n=null;const r=await Pr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?n=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!n)return{data:{session:null},error:null};const o=n.expires_at?n.expires_at*1e3-Date.now()<Rl:!1;if(this._debug("#__loadSession()",`session has${o?"":" not"} expired`,"expires_at",n.expires_at),!o){if(this.userStorage){const f=await Pr(this.userStorage,this.storageKey+"-user");f?.user?n.user=f.user:n.user=Il()}if(this.storage.isServer&&n.user&&!n.user.__isUserNotAvailableProxy){const f={value:this.suppressGetSessionWarning};n.user=lg(n.user,f),f.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:n},error:null}}const{data:u,error:d}=await this._callRefreshToken(n.refresh_token);return d?this._returnResult({data:{session:null},error:d}):this._returnResult({data:{session:u},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(n){if(n)return await this._getUser(n);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(n){try{return n?await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:n,xform:lr}):await this._useSession(async r=>{var o,u,d;const{data:f,error:p}=r;if(p)throw p;return!(!((o=f.session)===null||o===void 0)&&o.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Gt}:await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0,xform:lr})})}catch(r){if(xe(r))return Pl(r)&&(await this._removeSession(),await Ct(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(n,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(n,r))}async _updateUser(n,r={}){try{return await this._useSession(async o=>{const{data:u,error:d}=o;if(d)throw d;if(!u.session)throw new Gt;const f=u.session;let p=null,g=null;this.flowType==="pkce"&&n.email!=null&&([p,g]=await us(this.storage,this.storageKey));const{data:v,error:y}=await De(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},n),{code_challenge:p,code_challenge_method:g}),jwt:f.access_token,xform:lr});if(y)throw y;return f.user=v.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(o){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(o))return this._returnResult({data:{user:null},error:o});throw o}}async setSession(n){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(n))}async _setSession(n){try{if(!n.access_token||!n.refresh_token)throw new Gt;const r=Date.now()/1e3;let o=r,u=!0,d=null;const{payload:f}=Ta(n.access_token);if(f.exp&&(o=f.exp,u=o<=r),u){const{data:p,error:g}=await this._callRefreshToken(n.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!p)return{data:{user:null,session:null},error:null};d=p}else{const{data:p,error:g}=await this._getUser(n.access_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});d={access_token:n.access_token,refresh_token:n.refresh_token,user:p.user,token_type:"bearer",expires_in:o-r,expires_at:o},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return this._returnResult({data:{user:d.user,session:d},error:null})}catch(r){if(xe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(n){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(n))}async _refreshSession(n){try{return await this._useSession(async r=>{var o;if(!n){const{data:f,error:p}=r;if(p)throw p;n=(o=f.session)!==null&&o!==void 0?o:void 0}if(!n?.refresh_token)throw new Gt;const{data:u,error:d}=await this._callRefreshToken(n.refresh_token);return d?this._returnResult({data:{user:null,session:null},error:d}):u?this._returnResult({data:{user:u.user,session:u},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(xe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(n,r){try{if(!Tt())throw new Ca("No browser detected.");if(n.error||n.error_description||n.error_code)throw new Ca(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Wd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ca("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!n.code)throw new Wd("No code detected.");const{data:W,error:F}=await this._exchangeCodeForSession(n.code);if(F)throw F;const H=new URL(window.location.href);return H.searchParams.delete("code"),window.history.replaceState(window.history.state,"",H.toString()),{data:{session:W.session,redirectType:null},error:null}}const{provider_token:o,provider_refresh_token:u,access_token:d,refresh_token:f,expires_in:p,expires_at:g,token_type:v}=n;if(!d||!p||!f||!v)throw new Ca("No session defined in URL");const y=Math.round(Date.now()/1e3),E=parseInt(p);let j=y+E;g&&(j=parseInt(g));const x=j-y;x*1e3<=ms&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${E}s`);const A=j-E;y-A>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",A,j,y):y-A<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",A,j,y);const{data:P,error:D}=await this._getUser(d);if(D)throw D;const M={provider_token:o,provider_refresh_token:u,access_token:d,expires_in:E,expires_at:j,refresh_token:f,token_type:v,user:P.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:M,redirectType:n.type},error:null})}catch(o){if(xe(o))return this._returnResult({data:{session:null,redirectType:null},error:o});throw o}}_isImplicitGrantCallback(n){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),n):!!(n.access_token||n.error_description)}async _isPKCECallback(n){const r=await Pr(this.storage,`${this.storageKey}-code-verifier`);return!!(n.code&&r)}async signOut(n={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(n))}async _signOut({scope:n}={scope:"global"}){return await this._useSession(async r=>{var o;const{data:u,error:d}=r;if(d&&!Pl(d))return this._returnResult({error:d});const f=(o=u.session)===null||o===void 0?void 0:o.access_token;if(f){const{error:p}=await this.admin.signOut(f,n);if(p&&!(zm(p)&&(p.status===404||p.status===401||p.status===403)||Pl(p)))return this._returnResult({error:p})}return n!=="others"&&(await this._removeSession(),await Ct(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(n){const r=Gm(),o={id:r,callback:n,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,o),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:o}}}async _emitInitialSession(n){return await this._useSession(async r=>{var o,u;try{const{data:{session:d},error:f}=r;if(f)throw f;await((o=this.stateChangeEmitters.get(n))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",n,"session",d)}catch(d){await((u=this.stateChangeEmitters.get(n))===null||u===void 0?void 0:u.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",n,"error",d),console.error(d)}})}async resetPasswordForEmail(n,r={}){let o=null,u=null;this.flowType==="pkce"&&([o,u]=await us(this.storage,this.storageKey,!0));try{return await De(this.fetch,"POST",`${this.url}/recover`,{body:{email:n,code_challenge:o,code_challenge_method:u,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(d){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(d))return this._returnResult({data:null,error:d});throw d}}async getUserIdentities(){var n;try{const{data:r,error:o}=await this.getUser();if(o)throw o;return this._returnResult({data:{identities:(n=r.user.identities)!==null&&n!==void 0?n:[]},error:null})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(n){return"token"in n?this.linkIdentityIdToken(n):this.linkIdentityOAuth(n)}async linkIdentityOAuth(n){var r;try{const{data:o,error:u}=await this._useSession(async d=>{var f,p,g,v,y;const{data:E,error:j}=d;if(j)throw j;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,n.provider,{redirectTo:(f=n.options)===null||f===void 0?void 0:f.redirectTo,scopes:(p=n.options)===null||p===void 0?void 0:p.scopes,queryParams:(g=n.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await De(this.fetch,"GET",x,{headers:this.headers,jwt:(y=(v=E.session)===null||v===void 0?void 0:v.access_token)!==null&&y!==void 0?y:void 0})});if(u)throw u;return Tt()&&!(!((r=n.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(o?.url),this._returnResult({data:{provider:n.provider,url:o?.url},error:null})}catch(o){if(xe(o))return this._returnResult({data:{provider:n.provider,url:null},error:o});throw o}}async linkIdentityIdToken(n){return await this._useSession(async r=>{var o;try{const{error:u,data:{session:d}}=r;if(u)throw u;const{options:f,provider:p,token:g,access_token:v,nonce:y}=n,E=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(o=d?.access_token)!==null&&o!==void 0?o:void 0,body:{provider:p,id_token:g,access_token:v,nonce:y,link_identity:!0,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:pn}),{data:j,error:x}=E;return x?this._returnResult({data:{user:null,session:null},error:x}):!j||!j.session||!j.user?this._returnResult({data:{user:null,session:null},error:new cs}):(j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("USER_UPDATED",j.session)),this._returnResult({data:j,error:x}))}catch(u){if(await Ct(this.storage,`${this.storageKey}-code-verifier`),xe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}})}async unlinkIdentity(n){try{return await this._useSession(async r=>{var o,u;const{data:d,error:f}=r;if(f)throw f;return await De(this.fetch,"DELETE",`${this.url}/user/identities/${n.identity_id}`,{headers:this.headers,jwt:(u=(o=d.session)===null||o===void 0?void 0:o.access_token)!==null&&u!==void 0?u:void 0})})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(n){const r=`#_refreshAccessToken(${n.substring(0,5)}...)`;this._debug(r,"begin");try{const o=Date.now();return await Xm(async u=>(u>0&&await Ym(200*Math.pow(2,u-1)),this._debug(r,"refreshing attempt",u),await De(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:n},headers:this.headers,xform:pn})),(u,d)=>{const f=200*Math.pow(2,u);return d&&Ol(d)&&Date.now()+f-o<ms})}catch(o){if(this._debug(r,"error",o),xe(o))return this._returnResult({data:{session:null,user:null},error:o});throw o}finally{this._debug(r,"end")}}_isValidSession(n){return typeof n=="object"&&n!==null&&"access_token"in n&&"refresh_token"in n&&"expires_at"in n}async _handleProviderSignIn(n,r){const o=await this._getUrlForProvider(`${this.url}/authorize`,n,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",n,"options",r,"url",o),Tt()&&!r.skipBrowserRedirect&&window.location.assign(o),{data:{provider:n,url:o},error:null}}async _recoverAndRefresh(){var n,r;const o="#_recoverAndRefresh()";this._debug(o,"begin");try{const u=await Pr(this.storage,this.storageKey);if(u&&this.userStorage){let f=await Pr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:u.user},await gs(this.userStorage,this.storageKey+"-user",f)),u.user=(n=f?.user)!==null&&n!==void 0?n:Il()}else if(u&&!u.user&&!u.user){const f=await Pr(this.storage,this.storageKey+"-user");f&&f?.user?(u.user=f.user,await Ct(this.storage,this.storageKey+"-user"),await gs(this.storage,this.storageKey,u)):u.user=Il()}if(this._debug(o,"session from storage",u),!this._isValidSession(u)){this._debug(o,"session is not valid"),u!==null&&await this._removeSession();return}const d=((r=u.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Rl;if(this._debug(o,`session has${d?"":" not"} expired with margin of ${Rl}s`),d){if(this.autoRefreshToken&&u.refresh_token){const{error:f}=await this._callRefreshToken(u.refresh_token);f&&(console.error(f),Ol(f)||(this._debug(o,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(u.user&&u.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:p}=await this._getUser(u.access_token);!p&&f?.user?(u.user=f.user,await this._saveSession(u),await this._notifyAllSubscribers("SIGNED_IN",u)):this._debug(o,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(o,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",u)}catch(u){this._debug(o,"error",u),console.error(u);return}finally{this._debug(o,"end")}}async _callRefreshToken(n){var r,o;if(!n)throw new Gt;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const u=`#_callRefreshToken(${n.substring(0,5)}...)`;this._debug(u,"begin");try{this.refreshingDeferred=new Da;const{data:d,error:f}=await this._refreshAccessToken(n);if(f)throw f;if(!d.session)throw new Gt;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const p={data:d.session,error:null};return this.refreshingDeferred.resolve(p),p}catch(d){if(this._debug(u,"error",d),xe(d)){const f={data:null,error:d};return Ol(d)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(f),f}throw(o=this.refreshingDeferred)===null||o===void 0||o.reject(d),d}finally{this.refreshingDeferred=null,this._debug(u,"end")}}async _notifyAllSubscribers(n,r,o=!0){const u=`#_notifyAllSubscribers(${n})`;this._debug(u,"begin",r,`broadcast = ${o}`);try{this.broadcastChannel&&o&&this.broadcastChannel.postMessage({event:n,session:r});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async p=>{try{await p.callback(n,r)}catch(g){d.push(g)}});if(await Promise.all(f),d.length>0){for(let p=0;p<d.length;p+=1)console.error(d[p]);throw d[0]}}finally{this._debug(u,"end")}}async _saveSession(n){this._debug("#_saveSession()",n),this.suppressGetSessionWarning=!0,await Ct(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},n),o=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!o&&r.user&&await gs(this.userStorage,this.storageKey+"-user",{user:r.user});const u=Object.assign({},r);delete u.user;const d=Gd(u);await gs(this.storage,this.storageKey,d)}else{const u=Gd(r);await gs(this.storage,this.storageKey,u)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ct(this.storage,this.storageKey),await Ct(this.storage,this.storageKey+"-code-verifier"),await Ct(this.storage,this.storageKey+"-user"),this.userStorage&&await Ct(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const n=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{n&&Tt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",n)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const n=setInterval(()=>this._autoRefreshTokenTick(),ms);this.autoRefreshTicker=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const n=this.autoRefreshTicker;this.autoRefreshTicker=null,n&&clearInterval(n);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const n=Date.now();try{return await this._useSession(async r=>{const{data:{session:o}}=r;if(!o||!o.refresh_token||!o.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const u=Math.floor((o.expires_at*1e3-n)/ms);this._debug("#_autoRefreshTokenTick()",`access token expires in ${u} ticks, a tick lasts ${ms}ms, refresh threshold is ${Wl} ticks`),u<=Wl&&await this._callRefreshToken(o.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(n){if(n.isAcquireTimeout||n instanceof xh)this._debug("auto refresh token tick lock not available");else throw n}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Tt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(n){this._debug("#visibilityChangedCallback","error",n)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(n){console.error("_handleVisibilityChange",n)}}async _onVisibilityChanged(n){const r=`#_onVisibilityChanged(${n})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),n||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(n,r,o){const u=[`provider=${encodeURIComponent(r)}`];if(o?.redirectTo&&u.push(`redirect_to=${encodeURIComponent(o.redirectTo)}`),o?.scopes&&u.push(`scopes=${encodeURIComponent(o.scopes)}`),this.flowType==="pkce"){const[d,f]=await us(this.storage,this.storageKey),p=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});u.push(p.toString())}if(o?.queryParams){const d=new URLSearchParams(o.queryParams);u.push(d.toString())}return o?.skipBrowserRedirect&&u.push(`skip_http_redirect=${o.skipBrowserRedirect}`),`${n}?${u.join("&")}`}async _unenroll(n){try{return await this._useSession(async r=>{var o;const{data:u,error:d}=r;return d?this._returnResult({data:null,error:d}):await De(this.fetch,"DELETE",`${this.url}/factors/${n.factorId}`,{headers:this.headers,jwt:(o=u?.session)===null||o===void 0?void 0:o.access_token})})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(n){try{return await this._useSession(async r=>{var o,u;const{data:d,error:f}=r;if(f)return this._returnResult({data:null,error:f});const p=Object.assign({friendly_name:n.friendlyName,factor_type:n.factorType},n.factorType==="phone"?{phone:n.phone}:n.factorType==="totp"?{issuer:n.issuer}:{}),{data:g,error:v}=await De(this.fetch,"POST",`${this.url}/factors`,{body:p,headers:this.headers,jwt:(o=d?.session)===null||o===void 0?void 0:o.access_token});return v?this._returnResult({data:null,error:v}):(n.factorType==="totp"&&g.type==="totp"&&(!((u=g?.totp)===null||u===void 0)&&u.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(n){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var o;const{data:u,error:d}=r;if(d)return this._returnResult({data:null,error:d});const f=Object.assign({challenge_id:n.challengeId},"webauthn"in n?{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_response:n.webauthn.type==="create"?Eg(n.webauthn.credential_response):Cg(n.webauthn.credential_response)})}:{code:n.code}),{data:p,error:g}=await De(this.fetch,"POST",`${this.url}/factors/${n.factorId}/verify`,{body:f,headers:this.headers,jwt:(o=u?.session)===null||o===void 0?void 0:o.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+p.expires_in},p)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",p),this._returnResult({data:p,error:g}))})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(n){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var o;const{data:u,error:d}=r;if(d)return this._returnResult({data:null,error:d});const f=await De(this.fetch,"POST",`${this.url}/factors/${n.factorId}/challenge`,{body:n,headers:this.headers,jwt:(o=u?.session)===null||o===void 0?void 0:o.access_token});if(f.error)return f;const{data:p}=f;if(p.type!=="webauthn")return{data:p,error:null};switch(p.webauthn.type){case"create":return{data:Object.assign(Object.assign({},p),{webauthn:Object.assign(Object.assign({},p.webauthn),{credential_options:Object.assign(Object.assign({},p.webauthn.credential_options),{publicKey:jg(p.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},p),{webauthn:Object.assign(Object.assign({},p.webauthn),{credential_options:Object.assign(Object.assign({},p.webauthn.credential_options),{publicKey:Ng(p.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(n){const{data:r,error:o}=await this._challenge({factorId:n.factorId});return o?this._returnResult({data:null,error:o}):await this._verify({factorId:n.factorId,challengeId:r.id,code:n.code})}async _listFactors(){var n;const{data:{user:r},error:o}=await this.getUser();if(o)return{data:null,error:o};const u={all:[],phone:[],totp:[],webauthn:[]};for(const d of(n=r?.factors)!==null&&n!==void 0?n:[])u.all.push(d),d.status==="verified"&&u[d.factor_type].push(d);return{data:u,error:null}}async _getAuthenticatorAssuranceLevel(n){var r,o,u,d;if(n)try{const{payload:x}=Ta(n);let A=null;x.aal&&(A=x.aal);let P=A;const{data:{user:D},error:M}=await this.getUser(n);if(M)return this._returnResult({data:null,error:M});((o=(r=D?.factors)===null||r===void 0?void 0:r.filter(H=>H.status==="verified"))!==null&&o!==void 0?o:[]).length>0&&(P="aal2");const F=x.amr||[];return{data:{currentLevel:A,nextLevel:P,currentAuthenticationMethods:F},error:null}}catch(x){if(xe(x))return this._returnResult({data:null,error:x});throw x}const{data:{session:f},error:p}=await this.getSession();if(p)return this._returnResult({data:null,error:p});if(!f)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:g}=Ta(f.access_token);let v=null;g.aal&&(v=g.aal);let y=v;((d=(u=f.user.factors)===null||u===void 0?void 0:u.filter(x=>x.status==="verified"))!==null&&d!==void 0?d:[]).length>0&&(y="aal2");const j=g.amr||[];return{data:{currentLevel:v,nextLevel:y,currentAuthenticationMethods:j},error:null}}async _getAuthorizationDetails(n){try{return await this._useSession(async r=>{const{data:{session:o},error:u}=r;return u?this._returnResult({data:null,error:u}):o?await De(this.fetch,"GET",`${this.url}/oauth/authorizations/${n}`,{headers:this.headers,jwt:o.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new Gt})})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(n,r){try{return await this._useSession(async o=>{const{data:{session:u},error:d}=o;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new Gt});const f=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"approve"},xform:p=>({data:p,error:null})});return f.data&&f.data.redirect_url&&Tt()&&!r?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(o){if(xe(o))return this._returnResult({data:null,error:o});throw o}}async _denyAuthorization(n,r){try{return await this._useSession(async o=>{const{data:{session:u},error:d}=o;if(d)return this._returnResult({data:null,error:d});if(!u)return this._returnResult({data:null,error:new Gt});const f=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:u.access_token,body:{action:"deny"},xform:p=>({data:p,error:null})});return f.data&&f.data.redirect_url&&Tt()&&!r?.skipBrowserRedirect&&window.location.assign(f.data.redirect_url),f})}catch(o){if(xe(o))return this._returnResult({data:null,error:o});throw o}}async _listOAuthGrants(){try{return await this._useSession(async n=>{const{data:{session:r},error:o}=n;return o?this._returnResult({data:null,error:o}):r?await De(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:u=>({data:u,error:null})}):this._returnResult({data:null,error:new Gt})})}catch(n){if(xe(n))return this._returnResult({data:null,error:n});throw n}}async _revokeOAuthGrant(n){try{return await this._useSession(async r=>{const{data:{session:o},error:u}=r;return u?this._returnResult({data:null,error:u}):o?(await De(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:o.access_token,query:{client_id:n.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Gt})})}catch(r){if(xe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(n,r={keys:[]}){let o=r.keys.find(p=>p.kid===n);if(o)return o;const u=Date.now();if(o=this.jwks.keys.find(p=>p.kid===n),o&&this.jwks_cached_at+Um>u)return o;const{data:d,error:f}=await De(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=u,o=d.keys.find(p=>p.kid===n),!o)?null:o}async getClaims(n,r={}){try{let o=n;if(!o){const{data:x,error:A}=await this.getSession();if(A||!x.session)return this._returnResult({data:null,error:A});o=x.session.access_token}const{header:u,payload:d,signature:f,raw:{header:p,payload:g}}=Ta(o);r?.allowExpired||ig(d.exp);const v=!u.alg||u.alg.startsWith("HS")||!u.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(u.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!v){const{error:x}=await this.getUser(o);if(x)throw x;return{data:{claims:d,header:u,signature:f},error:null}}const y=ag(u.alg),E=await crypto.subtle.importKey("jwk",v,y,!0,["verify"]);if(!await crypto.subtle.verify(y,E,f,Vm(`${p}.${g}`)))throw new Vl("Invalid JWT signature");return{data:{claims:d,header:u,signature:f},error:null}}catch(o){if(xe(o))return this._returnResult({data:null,error:o});throw o}}}ci.nextInstanceID={};const Ug=ci,$g="2.97.0";let ti="";typeof Deno<"u"?ti="deno":typeof document<"u"?ti="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ti="react-native":ti="node";const zg={"X-Client-Info":`supabase-js-${ti}/${$g}`},Fg={headers:zg},Bg={schema:"public"},Mg={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Wg={};function ui(s){"@babel/helpers - typeof";return ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ui(s)}function qg(s,n){if(ui(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var o=r.call(s,n);if(ui(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(s)}function Kg(s){var n=qg(s,"string");return ui(n)=="symbol"?n:n+""}function Vg(s,n,r){return(n=Kg(n))in s?Object.defineProperty(s,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[n]=r,s}function nh(s,n){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);n&&(o=o.filter(function(u){return Object.getOwnPropertyDescriptor(s,u).enumerable})),r.push.apply(r,o)}return r}function ht(s){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?nh(Object(r),!0).forEach(function(o){Vg(s,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):nh(Object(r)).forEach(function(o){Object.defineProperty(s,o,Object.getOwnPropertyDescriptor(r,o))})}return s}const Hg=s=>s?(...n)=>s(...n):(...n)=>fetch(...n),Gg=()=>Headers,Jg=(s,n,r)=>{const o=Hg(r),u=Gg();return async(d,f)=>{var p;const g=(p=await n())!==null&&p!==void 0?p:s;let v=new u(f?.headers);return v.has("apikey")||v.set("apikey",s),v.has("Authorization")||v.set("Authorization",`Bearer ${g}`),o(d,ht(ht({},f),{},{headers:v}))}};function Qg(s){return s.endsWith("/")?s:s+"/"}function Yg(s,n){var r,o;const{db:u,auth:d,realtime:f,global:p}=s,{db:g,auth:v,realtime:y,global:E}=n,j={db:ht(ht({},g),u),auth:ht(ht({},v),d),realtime:ht(ht({},y),f),storage:{},global:ht(ht(ht({},E),p),{},{headers:ht(ht({},(r=E?.headers)!==null&&r!==void 0?r:{}),(o=p?.headers)!==null&&o!==void 0?o:{})}),accessToken:async()=>""};return s.accessToken?j.accessToken=s.accessToken:delete j.accessToken,j}function Xg(s){const n=s?.trim();if(!n)throw new Error("supabaseUrl is required.");if(!n.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Qg(n))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Zg=class extends Ug{constructor(s){super(s)}},ev=class{constructor(s,n,r){var o,u;this.supabaseUrl=s,this.supabaseKey=n;const d=Xg(s);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,p={db:Bg,realtime:Wg,auth:ht(ht({},Mg),{},{storageKey:f}),global:Fg},g=Yg(r??{},p);if(this.storageKey=(o=g.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(u=g.global.headers)!==null&&u!==void 0?u:{},g.accessToken)this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(y,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}});else{var v;this.auth=this._initSupabaseAuthClient((v=g.auth)!==null&&v!==void 0?v:{},this.headers,g.global.fetch)}this.fetch=Jg(n,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(ht({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(y=>this.realtime.setAuth(y)).catch(y=>console.warn("Failed to set initial Realtime auth token:",y)),this.rest=new zp(new URL("rest/v1",d).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch,timeout:g.db.timeout,urlLengthLimit:g.db.urlLengthLimit}),this.storage=new Om(this.storageUrl.href,this.headers,this.fetch,r?.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new Pp(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,n={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(s,n,r)}channel(s,n={config:{}}){return this.realtime.channel(s,n)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var s=this,n,r;if(s.accessToken)return await s.accessToken();const{data:o}=await s.auth.getSession();return(n=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&n!==void 0?n:s.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:u,storageKey:d,flowType:f,lock:p,debug:g,throwOnError:v},y,E){const j={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Zg({url:this.authUrl.href,headers:ht(ht({},j),y),storageKey:d,autoRefreshToken:s,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:u,flowType:f,lock:p,debug:g,throwOnError:v,fetch:E,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(s){return new nm(this.realtimeUrl.href,ht(ht({},s),{},{params:ht(ht({},{apikey:this.supabaseKey}),s?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,n)=>{this._handleTokenChanged(s,"CLIENT",n?.access_token)})}_handleTokenChanged(s,n,r){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):s==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const tv=(s,n,r)=>new ev(s,n,r);function nv(){if(typeof window<"u")return!1;const s=globalThis.process;if(!s)return!1;const n=s.version;if(n==null)return!1;const r=n.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}nv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ue=tv("https://dnletmkgmxiebcstwkqa.supabase.co","sb_publishable_C4Mm6r-GLilgbOoYJLUxSA_5V9naOFE"),rh=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function rv(){const s=new Date,n=s.getDay(),r=s.getDate()-n+(n===0?-6:1);return new Date(s.setDate(r)).toISOString().slice(0,10)}const dt=rv();function Dr(s){return{id:s.id,title:s.title,source:s.source||"Added manually",url:s.url||null,time:s.time_mins||30,tags:s.tags||[],category:s.category||"dinner",prepNote:s.prep_note||void 0,pdfUrl:s.pdf_url||void 0,ingredients:s.ingredients||[],thumbnailUrl:s.thumbnail_url||null,description:s.description||null,instructions:s.instructions||[],servings:s.servings||null,rawIngredients:s.raw_ingredients||[],inLibrary:s.in_library!==!1}}function Nh(s){return{title:s.title,source:s.source,url:s.url||null,time_mins:s.time||30,tags:s.tags||[],category:s.category||"dinner",prep_note:s.prepNote||null,pdf_url:s.pdfUrl||null,ingredients:s.ingredients||[],thumbnail_url:s.thumbnailUrl||null,description:s.description||null,instructions:s.instructions||[],servings:s.servings||null,raw_ingredients:s.rawIngredients||[],in_library:s.inLibrary!==!1}}async function sv(){const{data:s,error:n}=await ue.from("recipes").select("*").order("id");return n?(console.error("fetchRecipes",n),[]):s}async function Ll(s){const{data:n,error:r}=await ue.from("recipes").insert(Nh(s)).select().single();if(r)throw console.error("addRecipe",r),r;return n}async function Hl(s,n){const{error:r}=await ue.from("recipes").update(Nh(n)).eq("id",s);r&&console.error("updateRecipe",r)}async function sh(s){const{error:n}=await ue.from("recipes").delete().eq("id",s);n&&console.error("deleteRecipe",n)}function Eh(s){return{id:s.id,itemType:s.item_type,recipe:s.recipe?Dr(s.recipe):null,ingredients:s.ingredients||[],cookTime:s.cook_time||null,thumbnailUrl:s.thumbnail_url||null,note:s.note||null,sortOrder:s.sort_order??0}}async function ih(s){const{data:n,error:r}=await ue.from("week_plan_items").select("*, recipe:recipes(*)").eq("week_start",s).order("day").order("sort_order");if(r)return console.error("fetchWeekPlanItems",r),rh.map(u=>({day:u,items:[]}));const o={};return n.forEach(u=>{o[u.day]||(o[u.day]=[]),o[u.day].push(Eh(u))}),rh.map((u,d)=>({day:u,items:o[d]||[]}))}async function Dl(s,n,r){const o={week_start:s,day:n,sort_order:r.sortOrder??0,item_type:r.itemType,recipe_id:r.recipeId||null,ingredients:r.ingredients||null,cook_time:r.cookTime||null,thumbnail_url:r.thumbnailUrl||null,note:r.note||null},{data:u,error:d}=await ue.from("week_plan_items").insert(o).select("*, recipe:recipes(*)").single();if(d)throw console.error("addWeekPlanItem",d),d;return Eh(u)}async function iv(s){const{error:n}=await ue.from("week_plan_items").delete().eq("id",s);n&&console.error("removeWeekPlanItem",n)}async function av(s,n,r){const{error:o}=await ue.from("week_plan_items").update({day:n,sort_order:r}).eq("id",s);o&&console.error("moveWeekPlanItem",o)}async function ov(s,n){const{error:r}=await ue.from("week_plan_items").delete().eq("week_start",s).eq("day",n);r&&console.error("clearDayItems",r)}async function lv(s){const{error:n}=await ue.from("week_plan_items").delete().eq("week_start",s);n&&console.error("clearWeekPlanItems",n)}async function cv(s){const{data:n,error:r}=await ue.from("week_plan_items").select("id").eq("week_start",s).limit(1);if(r){console.error("migrateWeekPlanToItems check",r);return}if(n&&n.length>0)return;const{data:o,error:u}=await ue.from("week_plan").select("*, recipe:recipes(*)").eq("week_start",s);if(u){console.error("migrateWeekPlanToItems read",u);return}if(!o||o.length===0)return;const d=[];if(o.forEach(f=>{f.recipe_id&&f.recipe?d.push({week_start:s,day:f.day,sort_order:0,item_type:"recipe",recipe_id:f.recipe_id,ingredients:f.recipe.ingredients||null,cook_time:f.recipe.time_mins||null,thumbnail_url:f.recipe.thumbnail_url||null}):f.note&&d.push({week_start:s,day:f.day,sort_order:0,item_type:"note",note:f.note})}),d.length>0){const{error:f}=await ue.from("week_plan_items").insert(d);f&&console.error("migrateWeekPlanToItems insert",f)}}async function ah(){const{data:s,error:n}=await ue.from("batch_prep").select("*, recipe:recipes(*)").eq("week_start",dt);return n?(console.error("fetchBatchPrep",n),[]):s.map(r=>r.recipe?Dr(r.recipe):null).filter(Boolean)}async function oh(s,n){const{error:r}=await ue.from("batch_prep").insert({week_start:s,recipe_id:n});r&&console.error("addBatchItem",r)}async function uv(s,n){const{error:r}=await ue.from("batch_prep").delete().eq("week_start",s).eq("recipe_id",n);r&&console.error("removeBatchItem",r)}async function dv(s){const{error:n}=await ue.from("batch_prep").delete().eq("week_start",s);n&&console.error("clearBatchPrep",n)}async function hv(s){const{data:n,error:r}=await ue.from("recipes").insert({title:s.title,url:s.url||null,source:s.source||"",category:s.category||"dinner",in_library:!1}).select().single();if(r)throw console.error("addRadarItem",r),r;return Dr(n)}async function fv(s){const{error:n}=await ue.from("recipes").update({in_library:!0}).eq("id",s);n&&console.error("promoteToLibrary",n)}async function pv(){const{data:s,error:n}=await ue.from("fridge").select("*").order("id");return n?(console.error("fetchFridge",n),[]):s.map(r=>({id:r.id,item:r.item,s:r.status}))}async function mv(s,n){const{data:r,error:o}=await ue.from("fridge").insert({item:s,status:n||"ok"}).select().single();if(o)throw console.error("addFridgeItem",o),o;return{id:r.id,item:r.item,s:r.status}}async function gv(s,n){const r={};"item"in n&&(r.item=n.item),"s"in n&&(r.status=n.s);const{error:o}=await ue.from("fridge").update(r).eq("id",s);o&&console.error("updateFridgeItem",o)}async function vv(s){const{error:n}=await ue.from("fridge").delete().eq("id",s);n&&console.error("removeFridgeItem",n)}async function yv(){const{data:s,error:n}=await ue.from("freezer").select("*").order("id");return n?(console.error("fetchFreezer",n),[]):s.map(r=>({id:r.id,item:r.item,qty:r.qty??1}))}async function wv(s,n){const{data:r,error:o}=await ue.from("freezer").insert({item:s,qty:n??1}).select().single();if(o)throw console.error("addFreezerItem",o),o;return{id:r.id,item:r.item,qty:r.qty}}async function _v(s,n){const r={};"item"in n&&(r.item=n.item),"qty"in n&&(r.qty=n.qty);const{error:o}=await ue.from("freezer").update(r).eq("id",s);o&&console.error("updateFreezerItem",o)}async function lh(s){const{error:n}=await ue.from("freezer").delete().eq("id",s);n&&console.error("removeFreezerItem",n)}async function kv(){const{data:s,error:n}=await ue.from("staples").select("*").order("name");return n?(console.error("fetchStaples",n),[]):s.map(r=>({name:r.name,status:r.status||"ok"}))}async function Sv(s){const{error:n}=await ue.from("staples").insert({name:s,status:"ok"});n&&console.error("addStaple",n)}async function xv(s,n){const{error:r}=await ue.from("staples").update({status:n}).eq("name",s);r&&console.error("updateStaple",r)}async function bv(s){const{error:n}=await ue.from("staples").delete().eq("name",s);n&&console.error("removeStaple",n)}async function jv(){const{data:s,error:n}=await ue.from("regulars").select("*").order("name");return n?(console.error("fetchRegulars",n),[]):s.map(r=>({id:r.id,name:r.name}))}async function Nv(s){const{data:n,error:r}=await ue.from("regulars").insert({name:s}).select().single();if(r)throw console.error("addRegular",r),r;return{id:n.id,name:n.name}}async function Ev(s){const{error:n}=await ue.from("regulars").delete().eq("id",s);n&&console.error("removeRegular",n)}async function Cv(){const{data:s,error:n}=await ue.from("prefs").select("*").single();return n?(console.error("fetchPrefs",n),{fishMin:1,vegMin:2,readyBy:"18:30"}):{fishMin:s.fish_min??1,vegMin:s.veg_min??2,readyBy:s.ready_by||"18:30"}}async function Tv(s){const{error:n}=await ue.from("prefs").upsert({id:1,fish_min:s.fishMin,veg_min:s.vegMin,ready_by:s.readyBy});n&&console.error("updatePrefs",n)}async function Rv(){const{data:s,error:n}=await ue.from("custom_tags").select("name").order("name");return n?(console.error("fetchCustomTags",n),[]):s.map(r=>r.name)}async function Pv(s){const{error:n}=await ue.from("custom_tags").insert({name:s});n&&console.error("addCustomTag",n)}async function Ov(s){const{error:n}=await ue.from("custom_tags").delete().eq("name",s);n&&console.error("removeCustomTag",n)}async function Iv(){const{data:s,error:n}=await ue.from("custom_categories").select("name").order("name");return n?(console.error("fetchCustomCategories",n),[]):s.map(r=>r.name)}async function Av(s){const{error:n}=await ue.from("custom_categories").insert({name:s});n&&console.error("addCustomCategory",n)}async function Lv(s){const{error:n}=await ue.from("custom_categories").delete().eq("name",s);n&&console.error("removeCustomCategory",n)}async function Dv(){const{data:s,error:n}=await ue.from("shop_filters").select("name").order("name");return n?(console.error("fetchShopFilters",n),[]):s.map(r=>r.name)}async function Uv(s){const{error:n}=await ue.from("shop_filters").insert({name:s.toLowerCase().trim()});n&&console.error("addShopFilter",n)}async function $v(s){const{error:n}=await ue.from("shop_filters").delete().eq("name",s);n&&console.error("removeShopFilter",n)}async function zv(){const{data:s,error:n}=await ue.from("shop_section_keywords").select("section, keyword").order("keyword");if(n)return console.error("fetchShopSectionKeywords",n),{};const r={};return s.forEach(o=>{r[o.section]||(r[o.section]=[]),r[o.section].push(o.keyword)}),r}async function Fv(s,n){const{error:r}=await ue.from("shop_section_keywords").insert({section:s,keyword:n.toLowerCase().trim()});r&&console.error("addShopSectionKeyword",r)}async function Bv(s,n){const{error:r}=await ue.from("shop_section_keywords").delete().eq("section",s).eq("keyword",n);r&&console.error("removeShopSectionKeyword",r)}async function ch(){const{data:s,error:n}=await ue.from("shop_checked").select("key").eq("week_start",dt);if(n)return console.error("fetchShopChecked",n),{};const r={};return s.forEach(o=>{r[o.key]=!0}),r}async function Mv(s,n,r){if(r){const{error:o}=await ue.from("shop_checked").upsert({week_start:s,key:n},{onConflict:"week_start,key"});o&&console.error("toggleShopChecked",o)}else{const{error:o}=await ue.from("shop_checked").delete().eq("week_start",s).eq("key",n);o&&console.error("toggleShopChecked",o)}}async function Wv(){const{data:s,error:n}=await ue.from("reg_checked").select("regular_id").eq("week_start",dt);if(n)return console.error("fetchRegChecked",n),{};const r={};return s.forEach(o=>{r[o.regular_id]=!0}),r}async function qv(s,n,r){if(r){const{error:o}=await ue.from("reg_checked").upsert({week_start:s,regular_id:n},{onConflict:"week_start,regular_id"});o&&console.error("toggleRegChecked",o)}else{const{error:o}=await ue.from("reg_checked").delete().eq("week_start",s).eq("regular_id",n);o&&console.error("toggleRegChecked",o)}}async function Kv(){const{data:s,error:n}=await ue.from("free_shop").select("*").order("id");return n?(console.error("fetchFreeShop",n),[]):s.map(r=>({id:r.id,text:r.text,done:r.done}))}async function Vv(s){const{data:n,error:r}=await ue.from("free_shop").insert({text:s,done:!1}).select().single();if(r)throw console.error("addFreeShopItem",r),r;return{id:n.id,text:n.text,done:n.done}}async function Hv(s,n){const{error:r}=await ue.from("free_shop").update(n).eq("id",s);r&&console.error("updateFreeShopItem",r)}async function Gv(s){const{error:n}=await ue.from("free_shop").delete().eq("id",s);n&&console.error("removeFreeShopItem",n)}async function Jv(){const{data:s,error:n}=await ue.from("prep_tasks").select("*").eq("week_start",dt).order("id");return n?(console.error("fetchPrepTasks",n),[]):s.map(r=>({id:r.id,task:r.task,done:r.done}))}async function Qv(s,n){const{data:r,error:o}=await ue.from("prep_tasks").insert({week_start:s,task:n,done:!1}).select().single();if(o)throw console.error("addPrepTask",o),o;return{id:r.id,task:r.task,done:r.done}}async function Yv(s,n){const{error:r}=await ue.from("prep_tasks").update(n).eq("id",s);r&&console.error("updatePrepTask",r)}async function Xv(){const{data:s,error:n}=await ue.from("prep_checked").select("key").eq("week_start",dt);if(n)return console.error("fetchPrepChecked",n),{};const r={};return s.forEach(o=>{r[o.key]=!0}),r}async function Zv(s,n,r){if(r){const{error:o}=await ue.from("prep_checked").upsert({week_start:s,key:n},{onConflict:"week_start,key"});o&&console.error("togglePrepChecked",o)}else{const{error:o}=await ue.from("prep_checked").delete().eq("week_start",s).eq("key",n);o&&console.error("togglePrepChecked",o)}}async function Ch(s,n){const r=n.name.split(".").pop(),o=`${s}.${r}`,{error:u}=await ue.storage.from("recipe-files").upload(o,n,{upsert:!0});if(u)throw console.error("uploadRecipeFile",u),u;const{data:d}=ue.storage.from("recipe-files").getPublicUrl(o);return d.publicUrl}async function Th(s,n){const r=n.split("/recipe-files/")[1];if(r){const{error:o}=await ue.storage.from("recipe-files").remove([r]);o&&console.error("removeRecipeFile",o)}}async function cr(s){try{const{data:n,error:r}=await ue.functions.invoke("fetch-thumbnail",{body:{url:s}});return r?(console.error("fetchRecipeData error:",r),{thumbnailUrl:null,scrapedData:null}):{thumbnailUrl:n?.thumbnailUrl||null,scrapedData:n?.scrapedData||null}}catch(n){return console.error("fetchRecipeData",n),{thumbnailUrl:null,scrapedData:null}}}const Rh=new Set(["cup","cups","c","tablespoon","tablespoons","tbsp","tbs","tb","teaspoon","teaspoons","tsp","ml","milliliter","milliliters","liter","liters","l","fl","oz","fluid","pound","pounds","lb","lbs","ounce","ounces","oz","g","gram","grams","kg","kilogram","kilograms","large","small","medium","whole","piece","pieces","bunch","bunches","clove","cloves","can","cans","jar","jars","package","packages","pkg","bag","bags","box","boxes","stick","sticks","head","heads","sprig","sprigs","slice","slices","pinch","dash","handful"]),ey=/^[\d/.\s-]+/,ty=/[,;]?\s*(?:to taste|for serving|for garnish|as needed|optional|divided|plus more|or more|or less|about|approximately|roughly|freshly).*$/i;function Xl(s){let n=s.trim();n=n.replace(ey,"").trim(),n=n.replace(/\(.*?\)/g,"").trim();const r=n.split(/\s+/);for(;r.length>1&&Rh.has(r[0].toLowerCase().replace(/[.,]/g,""));)r.shift();return n=r.join(" "),n=n.replace(/^of\s+/i,""),n=n.replace(ty,"").trim(),n=n.replace(/[,.\s]+$/,""),n||s.trim()}const ny=new Set(["shredded","chopped","diced","minced","fresh","dried","sliced","peeled","cooked","frozen","canned","ground","whole","large","small","medium"]);function ry(s){return Xl(s).toLowerCase().split(/[\s,\-]+/).filter(r=>r.length>=4&&!Rh.has(r)&&!ny.has(r))}function Ph(s){const n=new Map;s.map(u=>ry(u.text)).forEach((u,d)=>{if(!u.length)return;const f=u[u.length-1];n.has(f)||n.set(f,[]),n.get(f).push(d)});const o=new Map;for(const[,u]of n)if(!(u.length<2))for(const d of u){const f=u.filter(p=>p!==d).map(p=>({text:s[p].text,recipeName:s[p].recipeName}));o.set(s[d].id,f)}return o}const Ua=[{id:"produce",label:"Produce"},{id:"meat",label:"Meat & Fish"},{id:"dairy",label:"Dairy & Eggs"},{id:"pantry",label:"Pantry & Dry Goods"},{id:"bread",label:"Bread & Bakery"},{id:"frozen",label:"Frozen"},{id:"other",label:"Other"}],Oh={produce:["apple","apples","avocado","banana","basil","bean","beans","beet","bell pepper","broccoli","cabbage","carrot","carrots","cauliflower","celery","cilantro","corn","cucumber","dill","eggplant","fennel","garlic","ginger","grape","grapes","green bean","herb","jalapeo","kale","leek","lemon","lemons","lettuce","lime","limes","mango","mint","mushroom","mushrooms","onion","onions","orange","parsley","peach","pear","peas","pepper","peppers","potato","potatoes","radish","rosemary","sage","scallion","shallot","spinach","squash","strawberry","sweet potato","thyme","tomato","tomatoes","zucchini"],meat:["anchovy","bacon","beef","chicken","chorizo","clam","cod","crab","duck","fish","ground beef","ground pork","ground turkey","ham","lamb","lobster","pancetta","pork","prosciutto","salmon","sausage","scallop","shrimp","steak","tilapia","tuna","turkey"],dairy:["butter","cheddar","cheese","cottage cheese","cream","cream cheese","egg","eggs","feta","goat cheese","gruyere","half and half","heavy cream","mascarpone","milk","mozzarella","parmesan","pecorino","ricotta","sour cream","whipped cream","yogurt"],pantry:["baking powder","baking soda","bean","beans","broth","brown sugar","buckwheat","canned","cannellini","chickpea","chickpeas","chocolate","cocoa","coconut milk","cornstarch","couscous","ditalini","dried","extract","fish sauce","flour","honey","hot sauce","jam","ketchup","lentil","lentils","maple syrup","mayonnaise","mirin","miso","mustard","noodle","noodles","nutritional yeast","oat","oats","oil","olive oil","oregano","panko","paprika","pasta","pepper flakes","quinoa","rice","rice vinegar","salt","sesame oil","soy sauce","spice","stock","sugar","tahini","tomato paste","vanilla","vinegar","worcestershire"],bread:["baguette","bread","brioche","bun","buns","ciabatta","crouton","english muffin","flatbread","naan","pita","roll","rolls","sourdough","tortilla","tortillas","wrap"],frozen:["frozen","ice cream","popsicle"]};function Ih(s,n){const r=n||Oh,o=s.toLowerCase();for(const u of Ua){if(u.id==="other")continue;if((r[u.id]||[]).some(f=>o.includes(f)))return u.id}return"other"}const Ah=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Lh=s=>{const[n,r]=s.split(":").map(Number);return n*60+r},Dh=s=>{const n=Math.floor((s%1440+1440)%1440/60),r=(s%1440+1440)%1440%60;return`${n}:${String(r).padStart(2,"0")}`},sy=(s,n)=>Dh(Lh(s)-n),iy=s=>{const[n,r]=s.split(":").map(Number),o=n>=12?"pm":"am";return`${n>12?n-12:n}:${String(r).padStart(2,"0")} ${o}`};function Zl({tags:s}){return l.jsxs(l.Fragment,{children:[s.includes("fish")&&l.jsx("span",{className:"tag tag-fish",children:"Fish"}),s.includes("vegetarian")&&l.jsx("span",{className:"tag tag-veg",children:"Veg"})]})}function Gl({recipe:s,onClose:n,onSave:r,onDelete:o,onRemoveFromPlan:u,source:d="library",itemId:f,customTags:p=[],customCategories:g=[]}){const[v,y]=O.useState(!1),[E,j]=O.useState(!1),[x,A]=O.useState(s),[P,D]=O.useState(s.title),[M,W]=O.useState(s.source),[F,H]=O.useState(s.url||""),[ae,le]=O.useState(String(s.time)),[ie,be]=O.useState(s.prepNote||""),[je,ye]=O.useState(s.tags||[]),[Oe,Le]=O.useState(s.category||""),[ke,Ue]=O.useState(s.pdfUrl||""),[G,we]=O.useState(s.ingredients||[]),[me,q]=O.useState(""),[ee,R]=O.useState(s.thumbnailUrl||null),[k,C]=O.useState(s.description||null),[ce,pe]=O.useState(s.servings||null),[$,oe]=O.useState(!1),de=X=>ye(se=>se.includes(X)?se.filter(Fe=>Fe!==X):[...se,X]),Ee=X=>{const se=X.trim().toLowerCase();se&&!G.includes(se)&&we(Fe=>[...Fe,se]),q("")},Ne=X=>we(se=>se.filter((Fe,ot)=>ot!==X)),K=()=>{if(!P.trim())return;const X={...x,title:P.trim(),source:M.trim()||"Added manually",url:F.trim()||null,time:parseInt(ae)||30,prepNote:ie.trim()||void 0,category:Oe||void 0,pdfUrl:ke.trim()||void 0,tags:je,ingredients:G,thumbnailUrl:ee,description:k||null,instructions:x.instructions||[],servings:ce||null,rawIngredients:x.rawIngredients||[]};r(X),A(X),y(!1)},he=async()=>{if(!(!x.url||E)){j(!0);try{const{thumbnailUrl:X,scrapedData:se}=await cr(x.url),Fe={...x};X&&(Fe.thumbnailUrl=X),se&&(se.title&&(Fe.title=se.title),se.cookTime&&(Fe.time=se.cookTime),se.ingredients?.length&&(Fe.ingredients=se.ingredients,Fe.rawIngredients=se.ingredients),se.instructions?.length&&(Fe.instructions=se.instructions),se.description&&(Fe.description=se.description),se.servings&&(Fe.servings=se.servings)),r(Fe),A(Fe)}catch(X){console.error("refresh failed",X)}j(!1)}},V=()=>{D(x.title),W(x.source),H(x.url||""),Le(x.category||""),Ue(x.pdfUrl||""),le(String(x.time)),be(x.prepNote||""),ye([...x.tags]),we([...x.ingredients||[]]),q(""),R(x.thumbnailUrl||null),C(x.description||null),pe(x.servings||null),y(!0)},re=x;return l.jsxs("div",{className:"recipe-detail-view",children:[!v&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"detail-topbar",children:l.jsx("button",{className:"detail-back-btn",onClick:n,children:" Back"})}),l.jsxs("div",{className:"detail-scroll",children:[re.thumbnailUrl&&l.jsx("img",{className:"detail-hero-img",src:re.thumbnailUrl,alt:""}),l.jsxs("div",{className:"detail-hero",children:[l.jsx("div",{className:"detail-title",children:re.title}),l.jsx("div",{className:"detail-source",children:re.source}),l.jsxs("div",{className:"detail-meta-row",children:[l.jsxs("div",{className:"detail-meta-chip",children:[" ",re.time," min"]}),re.tags.includes("fish")&&l.jsx("div",{className:"detail-meta-chip",style:{color:"#2a6a8a",background:"#eaf4fb",borderColor:"#a8cfe0"},children:" Fish"}),re.tags.includes("vegetarian")&&l.jsx("div",{className:"detail-meta-chip",style:{color:"#4a7a46",background:"#f0f8ee",borderColor:"#b8d4b6"},children:" Veg"}),re.servings&&l.jsxs("div",{className:"detail-meta-chip",children:[" ",re.servings," servings"]})]})]}),l.jsxs("div",{className:"detail-body",children:[re.prepNote&&l.jsxs("div",{children:[l.jsx("div",{className:"detail-section-label",children:"Prep note"}),l.jsxs("div",{className:"detail-prep-note",children:[" ",re.prepNote]})]}),re.url&&l.jsxs("div",{children:[l.jsx("div",{className:"detail-section-label",children:"Recipe source"}),l.jsxs("a",{className:"detail-link",href:re.url,target:"_blank",rel:"noopener noreferrer",children:[l.jsx("span",{className:"detail-link-icon",children:""}),l.jsxs("div",{className:"detail-link-text",children:[l.jsx("div",{className:"detail-link-label",children:re.source}),l.jsx("div",{className:"detail-link-url",children:re.url})]}),l.jsx("span",{className:"detail-link-arrow",children:""})]})]}),re.ingredients&&re.ingredients.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"detail-section-label",children:"Key ingredients"}),l.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:re.ingredients.map((X,se)=>l.jsx("span",{className:"detail-ingredient-chip",children:X},se))})]}),re.rawIngredients?.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"detail-section-label",children:"Ingredients"}),l.jsx("ul",{className:"detail-ingredients",children:re.rawIngredients.map((X,se)=>l.jsx("li",{children:X},se))})]}),re.instructions?.length>0&&l.jsxs("div",{children:[l.jsx("div",{className:"detail-section-label",children:"Instructions"}),l.jsx("ol",{className:"detail-instructions",children:re.instructions.map((X,se)=>l.jsx("li",{children:X},se))})]}),re.pdfUrl&&l.jsxs("div",{children:[l.jsx("div",{className:"detail-section-label",children:"Attachment"}),/\.(jpe?g|png|gif|webp)(\?|$)/i.test(re.pdfUrl)?l.jsx("a",{href:re.pdfUrl,target:"_blank",rel:"noopener noreferrer",children:l.jsx("img",{src:re.pdfUrl,alt:"Recipe",className:"detail-attachment-img"})}):l.jsxs("a",{href:re.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"detail-link",children:[l.jsx("span",{className:"detail-link-icon",children:""}),l.jsxs("div",{className:"detail-link-text",children:[l.jsx("div",{className:"detail-link-label",children:"View PDF"}),l.jsx("div",{className:"detail-link-url",children:re.pdfUrl})]}),l.jsx("span",{className:"detail-link-arrow",children:""})]})]})]})]}),l.jsxs("div",{className:"detail-footer",children:[d==="plan"&&l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:n,children:" Back to week"}),l.jsx("button",{className:"sheet-btn sheet-btn-primary",style:{flex:1},onClick:V,children:"Edit"}),re.url&&l.jsx("button",{className:"sheet-btn sheet-btn-cancel",disabled:E,onClick:he,children:E?"Refreshing":" Refresh"}),d==="plan"?l.jsx("button",{className:"detail-delete-btn",onClick:()=>u(),children:"Remove from plan"}):l.jsx("button",{className:"detail-delete-btn",onClick:()=>{o(re.id),n()},children:"Delete"})]})]}),v&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"detail-topbar",children:[l.jsx("button",{className:"detail-back-btn",onClick:()=>y(!1),children:" Cancel"}),l.jsxs("div",{style:{fontFamily:"'Playfair Display',serif",fontSize:16,color:"var(--ink)"},children:["Edit ",l.jsx("em",{children:re.title.split(" ").slice(0,3).join(" ")})]})]}),l.jsx("div",{className:"detail-scroll",children:l.jsx("div",{className:"detail-body",children:l.jsxs("div",{style:{paddingBottom:8},children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Recipe name"}),l.jsx("input",{className:"form-input",value:P,onChange:X=>D(X.target.value),autoFocus:!0})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Source name"}),l.jsx("input",{className:"form-input",value:M,onChange:X=>W(X.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["URL ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{className:"form-input",style:{flex:1},placeholder:"https://",value:F,onChange:X=>H(X.target.value),onBlur:async()=>{if(F.trim()){const{thumbnailUrl:X,scrapedData:se}=await cr(F.trim());X&&R(X),se?.servings&&pe(se.servings)}}}),ee&&l.jsx("img",{src:ee,alt:"",style:{width:40,height:40,borderRadius:6,objectFit:"cover",flexShrink:0}})]})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Category"}),l.jsx("div",{className:"cat-select",children:[["dinner","Dinner"],["breakfast","Breakfast & Snacks"],["sweets","Sweets"],...(g||[]).map(X=>[X,X])].map(([X,se])=>l.jsx("button",{type:"button",className:"cat-btn"+(Oe===X?" active":""),onClick:()=>Le(X),children:se},X))})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Cook time (min)"}),l.jsx("input",{className:"form-input",type:"number",value:ae,onChange:X=>le(X.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Servings"}),l.jsx("input",{className:"form-input",placeholder:"e.g. 4",value:ce||"",onChange:X=>pe(X.target.value)})]})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Prep note ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsx("input",{className:"form-input",placeholder:"e.g. Marinate overnight",value:ie,onChange:X=>be(X.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Tags"}),l.jsx("div",{className:"tag-toggle-row",children:["fish","vegetarian",...p||[]].map(X=>l.jsx("button",{className:"tag-toggle"+(je.includes(X)?" on":""),onClick:()=>de(X),children:X==="fish"?" Fish":X==="vegetarian"?" Veg":X},X))})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Key ingredients ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"things to buy"})]}),l.jsxs("div",{className:"ingredient-tags",onClick:X=>X.currentTarget.querySelector("input")?.focus(),children:[G.map((X,se)=>l.jsxs("span",{className:"ingredient-tag",children:[l.jsx("span",{style:{cursor:"pointer"},onClick:Fe=>{Fe.stopPropagation(),q(X),Ne(se)},children:X}),l.jsx("button",{className:"ingredient-tag-remove",onClick:Fe=>{Fe.stopPropagation(),Ne(se)},children:""})]},se)),l.jsx("input",{className:"ingredient-tag-input",placeholder:G.length===0?"e.g. salmon fillet":"add more",value:me,onChange:X=>q(X.target.value),onKeyDown:X=>{(X.key==="Enter"||X.key===",")&&me.trim()?(X.preventDefault(),Ee(me)):X.key==="Backspace"&&!me&&G.length>0&&we(se=>se.slice(0,-1))},onBlur:()=>{me.trim()&&Ee(me)}})]}),l.jsx("div",{className:"ingredient-tag-hint",children:"Enter or comma to add  skip pantry staples"})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Attachment ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"PDF or image"})]}),ke&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[/\.(jpe?g|png|gif|webp)(\?|$)/i.test(ke)?l.jsx("img",{src:ke,alt:"",style:{width:48,height:48,borderRadius:6,objectFit:"cover"}}):l.jsx("span",{style:{fontSize:13,color:"var(--ink3)"},children:" PDF attached"}),l.jsx("button",{type:"button",style:{fontSize:11,color:"var(--ink4)",background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"3px 8px",cursor:"pointer"},onClick:async()=>{await Th(s.id,ke),Ue("")},children:"Remove"})]}),l.jsxs("label",{className:"detail-upload-btn",children:[$?"Uploading":ke?"Replace file":"Upload file",l.jsx("input",{type:"file",accept:"image/*,.pdf",style:{display:"none"},disabled:$,onChange:async X=>{const se=X.target.files?.[0];if(se){oe(!0);try{const Fe=await Ch(s.id,se);Ue(Fe)}catch(Fe){console.error(Fe)}oe(!1),X.target.value=""}}})]})]})]})})}),l.jsxs("div",{className:"detail-footer",children:[l.jsx("button",{className:"sheet-btn sheet-btn-primary",style:{flex:1},disabled:!P.trim(),onClick:K,children:"Save changes"}),l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:()=>y(!1),children:"Cancel"})]})]})]})}function ay({title:s,setTitle:n,source:r,setSource:o,url:u,setUrl:d,time:f,setTime:p,tags:g,setTags:v,ingredients:y,setIngredients:E,ingrInput:j,setIngrInput:x,category:A,setCategory:P,customTags:D=[],customCategories:M=[],thumbnailUrl:W,setThumbnailUrl:F,description:H,setDescription:ae,servings:le,setServings:ie,instructions:be,setInstructions:je,rawIngredients:ye,setRawIngredients:Oe,pdfUrl:Le,setPdfUrl:ke,recipeId:Ue,setFetchLoading:G}){const[we,me]=O.useState(!1),[q,ee]=O.useState(!1),R=V=>{me(V),G&&G(V)},[k,C]=O.useState(!1),ce=O.useRef(null),pe=O.useRef(""),$=async V=>{const re=V.trim();if(!re||re===pe.current)return;pe.current=re,R(!0),C(!1);const{thumbnailUrl:X,scrapedData:se}=await cr(re);X&&F&&F(X),se&&(!s.trim()&&se.title&&n(se.title),(!f||f===""||f==="30")&&se.cookTime&&p(String(se.cookTime)),Oe&&se.ingredients&&Oe(se.ingredients),(!y||y.length===0)&&se.ingredients&&E(se.ingredients),ae&&se.description&&ae(se.description),ie&&se.servings&&ie(se.servings),je&&se.instructions&&je(se.instructions),C(!0));try{o&&!r.trim()&&o(new URL(re).hostname.replace(/^www\./,""))}catch{}R(!1)},oe=()=>{ce.current&&(clearTimeout(ce.current),ce.current=null),$(u)},de=V=>{d(V),ce.current&&clearTimeout(ce.current),ce.current=setTimeout(()=>$(V),800)},Ee=V=>v(re=>re.includes(V)?re.filter(X=>X!==V):[...re,V]),Ne=V=>{const re=V.trim().toLowerCase();re&&!y.includes(re)&&E(X=>[...X,re]),x("")},K=V=>E(re=>re.filter((X,se)=>se!==V)),he=V=>{x(y[V]),K(V)};return l.jsxs("div",{style:{paddingBottom:8},children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Recipe name"}),l.jsx("input",{className:"form-input",placeholder:"e.g. Roast chicken with lemon",value:s,onChange:V=>n(V.target.value),autoFocus:!0})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Source name"}),l.jsx("input",{className:"form-input",placeholder:"e.g. NYT Cooking, Smitten Kitchen",value:r,onChange:V=>o(V.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["URL ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{className:"form-input",style:{flex:1},placeholder:"https://",value:u,onChange:V=>de(V.target.value),onBlur:oe}),we&&l.jsx("span",{style:{fontSize:11,color:"var(--ink4)",flexShrink:0},children:"fetching"}),!we&&W&&l.jsx("img",{src:W,alt:"",style:{width:40,height:40,borderRadius:6,objectFit:"cover",flexShrink:0}})]}),k&&l.jsx("div",{style:{fontSize:10,color:"var(--sage)",marginTop:3,fontStyle:"italic"},children:"Filled from recipe page"})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Category"}),l.jsx("div",{className:"cat-select",children:[["dinner","Dinner"],["breakfast","Breakfast & Snacks"],["sweets","Sweets"],...(M||[]).map(V=>[V,V])].map(([V,re])=>l.jsx("button",{type:"button",className:"cat-btn"+(A===V?" active":""),onClick:()=>P&&P(V),children:re},V))})]}),l.jsxs("div",{className:"form-row",children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Cook time (min)"}),l.jsx("input",{className:"form-input",type:"number",placeholder:"30",value:f,onChange:V=>p(V.target.value)})]}),ie&&l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Servings"}),l.jsx("input",{className:"form-input",placeholder:"e.g. 4",value:le||"",onChange:V=>ie(V.target.value)})]})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Tags"}),l.jsx("div",{className:"tag-toggle-row",children:["fish","vegetarian",...D||[]].map(V=>l.jsx("button",{className:"tag-toggle"+(g.includes(V)?" on":""),onClick:()=>Ee(V),children:V==="fish"?" Fish":V==="vegetarian"?" Veg":V},V))})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Key ingredients ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"things to buy, not staples"})]}),l.jsxs("div",{className:"ingredient-tags",onClick:V=>V.currentTarget.querySelector("input")?.focus(),children:[y.map((V,re)=>l.jsxs("span",{className:"ingredient-tag",children:[l.jsx("span",{style:{cursor:"pointer"},onClick:X=>{X.stopPropagation(),he(re)},children:V}),l.jsx("button",{className:"ingredient-tag-remove",onClick:X=>{X.stopPropagation(),K(re)},children:""})]},re)),l.jsx("input",{className:"ingredient-tag-input",placeholder:y.length===0?"e.g. salmon fillet":"add more",value:j,onChange:V=>x(V.target.value),onKeyDown:V=>{(V.key==="Enter"||V.key===",")&&j.trim()?(V.preventDefault(),Ne(j)):V.key==="Backspace"&&!j&&y.length>0&&E(re=>re.slice(0,-1))},onBlur:()=>{j.trim()&&Ne(j)}})]}),l.jsx("div",{className:"ingredient-tag-hint",children:"Enter or comma to add  skip staples like garlic, olive oil"})]}),ke&&Ue&&l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Attachment ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"PDF or image"})]}),Le&&l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[/\.(jpe?g|png|gif|webp)(\?|$)/i.test(Le)?l.jsx("img",{src:Le,alt:"",style:{width:48,height:48,borderRadius:6,objectFit:"cover"}}):l.jsx("span",{style:{fontSize:13,color:"var(--ink3)"},children:" PDF attached"}),l.jsx("button",{type:"button",style:{fontSize:11,color:"var(--ink4)",background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"3px 8px",cursor:"pointer"},onClick:async()=>{await Th(Ue,Le),ke("")},children:"Remove"})]}),l.jsxs("label",{className:"detail-upload-btn",children:[q?"Uploading":Le?"Replace file":"Upload file",l.jsx("input",{type:"file",accept:"image/*,.pdf",style:{display:"none"},disabled:q,onChange:async V=>{const re=V.target.files?.[0];if(re){ee(!0);try{ke(await Ch(Ue,re))}catch(X){console.error(X)}ee(!1),V.target.value=""}}})]})]})]})}function oy({onClose:s,onAdd:n,prefill:r={},customTags:o=[],customCategories:u=[]}){const[d,f]=O.useState(r.title||""),[p,g]=O.useState(r.source||""),[v,y]=O.useState(r.url||""),[E,j]=O.useState(r.time?String(r.time):""),[x,A]=O.useState(r.category||"dinner"),[P,D]=O.useState(r.tags||[]),[M,W]=O.useState(r.ingredients||[]),[F,H]=O.useState(""),[ae,le]=O.useState(r.thumbnailUrl||null),[ie,be]=O.useState(r.description||null),[je,ye]=O.useState(r.servings||null),[Oe,Le]=O.useState(r.instructions||[]),[ke,Ue]=O.useState(r.rawIngredients||[]),[G,we]=O.useState(r.pdfUrl||""),[me,q]=O.useState(!1),[ee]=O.useState(()=>Date.now()),R=()=>{if(!d.trim()&&!v.trim())return;const k=d.trim()||(()=>{try{return new URL(v.trim()).hostname.replace(/^www\./,"")}catch{return v.trim()}})();n({id:ee,title:k,source:p.trim()||"Added manually",url:v.trim()||null,category:x||"dinner",time:parseInt(E)||30,tags:P,ingredients:M,thumbnailUrl:ae,description:ie||null,instructions:Oe,servings:je||null,rawIngredients:ke,pdfUrl:G||void 0}),s()};return l.jsx("div",{className:"sheet-overlay",onClick:s,children:l.jsxs("div",{className:"sheet",onClick:k=>k.stopPropagation(),children:[l.jsx("div",{className:"sheet-handle"}),l.jsxs("div",{className:"sheet-header",children:[l.jsxs("div",{className:"sheet-title",children:["New ",l.jsx("em",{children:"Recipe"})]}),l.jsx("div",{className:"sheet-subtitle",children:"Saved to your library"})]}),l.jsx("div",{className:"sheet-body",children:l.jsx(ay,{title:d,setTitle:f,source:p,setSource:g,url:v,setUrl:y,time:E,setTime:j,category:x,setCategory:A,tags:P,setTags:D,ingredients:M,setIngredients:W,ingrInput:F,setIngrInput:H,customTags:o,customCategories:u,thumbnailUrl:ae,setThumbnailUrl:le,description:ie,setDescription:be,servings:je,setServings:ye,instructions:Oe,setInstructions:Le,rawIngredients:ke,setRawIngredients:Ue,pdfUrl:G,setPdfUrl:we,recipeId:ee,setFetchLoading:q})}),l.jsxs("div",{className:"sheet-footer",children:[l.jsx("button",{className:"sheet-btn sheet-btn-primary",disabled:!d.trim()&&!v.trim()||me,onClick:R,children:"Save to library"}),l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:s,children:"Cancel"})]})]})})}function ly({onClose:s,week:n,staples:r,freezer:o,fridge:u,regulars:d,onAddRegular:f,onRemoveRegular:p,regChecked:g,onToggleRegChecked:v,shopChecked:y,onToggleShopChecked:E,freeShop:j,onAddFreeShop:x,onToggleFreeShop:A,onRemoveFreeShop:P,shopFilters:D,shopSectionKeywords:M}){const[W,F]=O.useState(""),[H,ae]=O.useState(""),[le,ie]=O.useState(new Set),[be,je]=O.useState(new Set),[ye,Oe]=O.useState(null),Le=z=>v(z),ke=z=>p(z),Ue=z=>{const Ie=z.trim().toLowerCase();Ie&&!d.find(Be=>Be.name===Ie)&&f(Ie),ae("")},G=z=>E(z),we=z=>A(z),me=()=>{W.trim()&&(x(W.trim()),F(""))},q=z=>{z.done!==void 0?P(z.id):je(Ie=>new Set([...Ie,z.id]))},ee=r.filter(z=>z.status==="ok").map(z=>z.name.toLowerCase()),R=(o||[]).map(z=>z.item.toLowerCase()),k=(u||[]).map(z=>z.item.toLowerCase()),C=r.filter(z=>z.status==="restock").map(z=>({id:"staple:"+z.name,text:z.name,source:"restock",recipeName:"pantry restock"})),ce=(n||[]).flatMap(z=>z.items.filter(Ie=>Ie.itemType==="recipe"&&(Ie.ingredients?.length||Ie.recipe?.ingredients?.length)).flatMap(Ie=>{const Be=Ie.ingredients?.length?Ie.ingredients:Ie.recipe?.ingredients||[],Ge=Ie.recipe?.title||"Unknown";return Be.map(Ze=>({text:Ze,source:z.day,id:z.day+":"+Ie.id+":"+Ze,recipeName:Ge}))})).filter(z=>!ee.includes(z.text.toLowerCase())&&!R.includes(z.text.toLowerCase())&&!k.includes(z.text.toLowerCase())),pe=[],$={};ce.forEach(z=>{$[z.text]?($[z.text].source+=", "+z.source,$[z.text].recipeName+=", "+z.recipeName):($[z.text]={...z},pe.push($[z.text]))});const oe=[...C,...pe,...j.map(z=>({...z,source:null}))].filter(z=>!be.has(z.id)),de=r.filter(z=>z.status==="ok").map(z=>z.name.toLowerCase()),Ee=[...new Set([...de,...D])],Ne=z=>Ee.some(Ie=>Xl(z).toLowerCase().includes(Ie)),K=oe.filter(z=>z.source==="restock"||!Ne(z.text)||le.has(z.id)),he=oe.filter(z=>z.source!=="restock"&&Ne(z.text)&&!le.has(z.id)),V=Ph(K),re=d.filter(z=>!g[z.id]),X=d.filter(z=>g[z.id]),se=K.filter(z=>!y[z.id]&&!z.done),Fe=K.filter(z=>y[z.id]||z.done),ot=re.length+se.length,Rt=z=>{ie(Ie=>new Set([...Ie,z.id]))},St=z=>{ie(Ie=>{const Be=new Set(Ie);return Be.delete(z.id),Be})},mt=(z,Ie)=>{const Be=V.has(z.id),Ge=le.has(z.id);return l.jsxs("div",{className:"shop-col-item"+(Ie?" done-item":"")+(Be&&!Ie?" duplicate-item":""),style:Ie?{textDecoration:"line-through",position:"relative"}:{position:"relative"},onClick:()=>{Be&&!Ie&&Oe(ye===z.id?null:z.id)},children:[l.jsx("input",{type:"checkbox",checked:!!Ie,onChange:()=>z.done!==void 0?we(z.id):G(z.id)}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{className:"shop-col-text",children:z.text}),z.source&&l.jsx("div",{className:"shop-col-source",children:z.recipeName||z.source})]}),Ge&&!Ie&&l.jsx("button",{className:"pill-refilter",onClick:Ze=>{Ze.stopPropagation(),St(z)},title:"Move back to filtered",children:""}),l.jsx("button",{className:"shop-item-remove",onClick:Ze=>{Ze.stopPropagation(),q(z)},children:""}),ye===z.id&&V.get(z.id)&&l.jsxs("span",{className:"dup-popover",onClick:Ze=>Ze.stopPropagation(),children:["Also needed: ",V.get(z.id).map(Ze=>Ze.text+"  "+Ze.recipeName).join("; ")]})]},z.id)};return l.jsx("div",{className:"sheet-overlay",onClick:s,children:l.jsxs("div",{className:"sheet",style:{maxHeight:"92vh"},onClick:z=>{z.stopPropagation(),Oe(null)},children:[l.jsx("div",{className:"sheet-handle"}),l.jsx("div",{className:"sheet-header",style:{paddingBottom:10},children:l.jsxs("div",{className:"sheet-title",children:["Shopping ",l.jsx("em",{children:"List"}),ot>0&&l.jsx("span",{className:"shop-count-badge",children:ot})]})}),l.jsxs("div",{className:"sheet-body",style:{padding:0},children:[l.jsx("div",{className:"shop-sheet-group-label",children:"Every week"}),l.jsxs("div",{className:"shop-col-grid",children:[re.map(z=>l.jsxs("div",{className:"shop-col-item",children:[l.jsx("input",{type:"checkbox",checked:!1,onChange:()=>Le(z.id)}),l.jsx("div",{style:{flex:1,minWidth:0},children:l.jsx("div",{className:"shop-col-text",children:z.name})}),l.jsx("button",{className:"pantry-row-remove",style:{opacity:.25,fontSize:13},onClick:Ie=>{Ie.stopPropagation(),ke(z.id)},children:""})]},z.id)),X.map(z=>l.jsxs("div",{className:"shop-col-item done-item",children:[l.jsx("input",{type:"checkbox",checked:!0,onChange:()=>Le(z.id)}),l.jsx("div",{style:{flex:1,minWidth:0,textDecoration:"line-through"},children:l.jsx("div",{className:"shop-col-text",children:z.name})})]},z.id))]}),l.jsxs("div",{style:{padding:"6px 12px 10px",borderBottom:"1px solid var(--border2)",display:"flex",gap:8},children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add to weekly regulars",value:H,style:{fontSize:11},onChange:z=>ae(z.target.value),onKeyDown:z=>{z.key==="Enter"&&Ue(H)}}),l.jsx("button",{className:"pantry-add-btn",disabled:!H.trim(),onClick:()=>Ue(H),style:{fontSize:11,padding:"6px 10px"},children:"Add"})]}),se.length===0&&Fe.length===0&&j.length===0&&he.length===0?l.jsx("div",{style:{padding:"10px 20px",color:"var(--ink4)",fontSize:12,fontStyle:"italic"},children:"Plan dinners to auto-populate ingredients here."}):(()=>{const z=[...se.map(Be=>({...Be,_checked:!1})),...Fe.map(Be=>({...Be,_checked:!0}))],Ie={};return z.forEach(Be=>{const Ge=Ih(Be.text,M);Ie[Ge]||(Ie[Ge]=[]),Ie[Ge].push(Be)}),Ua.filter(Be=>Ie[Be.id]?.length).map(Be=>l.jsxs("div",{children:[l.jsx("div",{className:"shop-section-header",children:Be.label}),l.jsxs("div",{className:"shop-col-grid",children:[Ie[Be.id].filter(Ge=>!Ge._checked).map(Ge=>mt(Ge,!1)),Ie[Be.id].filter(Ge=>Ge._checked).map(Ge=>mt(Ge,!0))]})]},Be.id))})(),he.length>0&&l.jsxs("details",{className:"filtered-section",style:{padding:"0 12px 6px"},children:[l.jsxs("summary",{className:"filtered-summary",children:["Filtered out (",he.length,")"]}),l.jsx("div",{className:"filtered-note",children:"These match common staples  check your pantry"}),l.jsx("div",{className:"shop-col-grid",children:he.map(z=>l.jsx("div",{className:"shop-col-item",style:{opacity:.45,fontStyle:"italic",cursor:"pointer"},onClick:()=>Rt(z),children:l.jsx("div",{style:{flex:1,minWidth:0},children:l.jsx("div",{className:"shop-col-text",children:z.text})})},z.id))})]}),l.jsxs("div",{style:{padding:"6px 12px 10px",display:"flex",gap:8},children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add item",value:W,style:{fontSize:11},onChange:z=>F(z.target.value),onKeyDown:z=>{z.key==="Enter"&&me()}}),l.jsx("button",{className:"pantry-add-btn",disabled:!W.trim(),onClick:me,style:{fontSize:11,padding:"6px 10px"},children:"Add"})]})]}),l.jsx("div",{className:"sheet-footer",children:l.jsx("button",{className:"sheet-btn sheet-btn-cancel",style:{flex:1},onClick:s,children:"Done"})})]})})}function cy({targetDay:s,dayIndex:n,week:r,recipes:o,radar:u,onClose:d,onAddItem:f,onRemoveItem:p,onClearDay:g,onAddNote:v,onAddRecipe:y,freezer:E,onAdjustFreezerQty:j,customTags:x=[],customCategories:A=[]}){const[P,D]=O.useState("pick"),[M,W]=O.useState(""),[F,H]=O.useState(""),[ae,le]=O.useState(""),[ie,be]=O.useState("30"),[je,ye]=O.useState([]),[Oe,Le]=O.useState(""),[ke,Ue]=O.useState(!1),[G,we]=O.useState(""),[me,q]=O.useState("dinner"),[ee,R]=O.useState([]),[k,C]=O.useState(""),[ce,pe]=O.useState(null),[$,oe]=O.useState(null),[de,Ee]=O.useState(null),[Ne,K]=O.useState([]),[he,V]=O.useState([]),[re,X]=O.useState(!1),[se,Fe]=O.useState(!1),ot=O.useRef(null),Rt=O.useRef(""),[St,mt]=O.useState(null),[z,Ie]=O.useState(""),Be=o.filter(Q=>(Q.category==="dinner"||!Q.category)&&(M===""||Q.title.toLowerCase().includes(M.toLowerCase()))),Ge=Q=>{if(!E?.length||!Q.ingredients?.length)return[];const Te=Object.fromEntries(E.map(Ve=>[Ve.item.toLowerCase(),Ve]));return Q.ingredients.map(Ve=>Te[Ve.toLowerCase()]).filter(Boolean).map(Ve=>({freezerItem:Ve,deduct:1}))},Ze=Q=>{const Te=Ge(Q);Te.length?mt({recipe:Q,matches:Te}):(f(n,Q),d())},sn=async Q=>{const Te=Q.trim();if(!Te||Te===Rt.current)return;Rt.current=Te,X(!0),Fe(!1);const{thumbnailUrl:Ve,scrapedData:Je}=await cr(Te);Ve&&pe(Ve),Je&&(!F.trim()&&Je.title&&H(Je.title),ie==="30"&&Je.cookTime&&be(String(Je.cookTime)),!je.length&&Je.ingredients&&ye(Je.ingredients),Je.description&&oe(Je.description),Je.servings&&Ee(Je.servings),Je.instructions&&K(Je.instructions),Je.ingredients&&V(Je.ingredients),Fe(!0));try{G.trim()||we(new URL(Te).hostname.replace(/^www\./,""))}catch{}X(!1)},bn=()=>{ot.current&&(clearTimeout(ot.current),ot.current=null),sn(ae)},an=Q=>{le(Q),ot.current&&clearTimeout(ot.current),ot.current=setTimeout(()=>sn(Q),800)},$n=()=>{if(!F.trim()&&!ae.trim())return;const Te={title:F.trim()||(()=>{try{return new URL(ae.trim()).hostname.replace(/^www\./,"")}catch{return ae.trim()}})(),source:G.trim()||"Added manually",url:ae.trim()||null,category:ke&&me||"dinner",tags:ke?ee:[],time:parseInt(ie)||30,ingredients:je,prepNote:k.trim()||void 0,thumbnailUrl:ce,description:$||null,instructions:Ne,servings:de||null,rawIngredients:he,inLibrary:ke,_needsInsert:!0};ke&&y(Te);const Ve=Ge(Te);Ve.length?mt({recipe:Te,matches:Ve}):(f(n,Te),d())},Qt=()=>{St.matches.forEach(({freezerItem:Q,deduct:Te})=>{j(Q.id,-Te)}),f(n,St.recipe),d()},Wt=()=>{f(n,St.recipe),d()},jn=(Q,Te)=>{mt(Ve=>({...Ve,matches:Ve.matches.map(Je=>Je.freezerItem.id===Q?{...Je,deduct:Math.max(0,Je.deduct+Te)}:Je)}))},zn=s?`${s.day}day`:"Choose a night";return St?l.jsx("div",{className:"sheet-overlay",onClick:Wt,children:l.jsxs("div",{className:"sheet",onClick:Q=>Q.stopPropagation(),children:[l.jsx("div",{className:"sheet-handle"}),l.jsxs("div",{className:"deduct-prompt",children:[l.jsxs("div",{children:[l.jsx("div",{className:"deduct-title",children:"Using from freezer"}),l.jsx("div",{className:"deduct-subtitle",children:"How much should we deduct from your freezer stock?"})]}),St.matches.map(({freezerItem:Q,deduct:Te})=>l.jsxs("div",{className:"deduct-row",children:[l.jsxs("div",{className:"deduct-row-name",children:[Q.item,l.jsxs("div",{className:"deduct-row-current",children:[Q.qty," lb in stock"]})]}),l.jsxs("div",{className:"fz-stepper",children:[l.jsx("button",{className:"fz-stepper-btn",onClick:()=>jn(Q.id,-1),children:""}),l.jsx("span",{className:"fz-stepper-val",children:Te}),l.jsx("button",{className:"fz-stepper-btn",onClick:()=>jn(Q.id,1),children:"+"}),l.jsx("span",{className:"fz-unit",children:"lb"})]})]},Q.id))]}),l.jsxs("div",{className:"sheet-footer",children:[l.jsx("button",{className:"sheet-btn sheet-btn-primary",onClick:Qt,children:"Confirm & deduct"}),l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:Wt,children:"Skip"})]})]})}):l.jsx("div",{className:"sheet-overlay",onClick:d,children:l.jsxs("div",{className:"sheet",onClick:Q=>Q.stopPropagation(),children:[l.jsx("div",{className:"sheet-handle"}),l.jsxs("div",{className:"sheet-header",children:[l.jsx("div",{className:"sheet-title",children:s?.items?.length>0?l.jsxs(l.Fragment,{children:["Add to ",l.jsx("em",{children:s.day}),"'s dinner"]}):l.jsxs(l.Fragment,{children:["Plan ",l.jsx("em",{children:s?.day??"a night"})]})}),l.jsx("div",{className:"sheet-subtitle",children:zn})]}),l.jsxs("div",{className:"sheet-mode-toggle",children:[l.jsx("button",{className:"sheet-mode-btn"+(P==="pick"?" active":""),onClick:()=>D("pick"),children:"From Library"}),l.jsx("button",{className:"sheet-mode-btn"+(P==="radar"?" active":""),onClick:()=>D("radar"),children:"Try Soon"}),l.jsx("button",{className:"sheet-mode-btn"+(P==="url"?" active":""),onClick:()=>D("url"),children:"Add URL"}),l.jsx("button",{className:"sheet-mode-btn"+(P==="note"?" active":""),onClick:()=>D("note"),children:"Note"})]}),l.jsxs("div",{className:"sheet-body",children:[P==="pick"&&l.jsxs(l.Fragment,{children:[l.jsx("input",{className:"pick-search",placeholder:"Search recipes",value:M,onChange:Q=>W(Q.target.value),autoFocus:!0}),Be.map(Q=>l.jsxs("div",{className:"pick-recipe-item",onClick:()=>Ze(Q),children:[l.jsx("div",{className:"pick-thumb",children:Q.title[0]}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{className:"pick-recipe-title",children:Q.title}),l.jsxs("div",{className:"pick-recipe-meta",children:[Q.source,"  ",Q.time," min"]}),l.jsx("div",{className:"pick-tags",children:l.jsx(Zl,{tags:Q.tags})})]}),l.jsx("span",{style:{color:"var(--ink4)",fontSize:20},children:""})]},Q.id)),Be.length===0&&l.jsxs("div",{style:{padding:"24px 0",textAlign:"center",color:"var(--ink4)",fontSize:13,fontStyle:"italic"},children:['No recipes match "',M,'"']})]}),P==="radar"&&l.jsxs(l.Fragment,{children:[l.jsx("input",{className:"pick-search",placeholder:"Search try soon",value:M,onChange:Q=>W(Q.target.value),autoFocus:!0}),(()=>{const Q=(u||[]).filter(Te=>M===""||Te.title.toLowerCase().includes(M.toLowerCase()));return Q.length?Q.map(Te=>l.jsxs("div",{className:"pick-recipe-item",onClick:()=>Ze(Te),children:[l.jsx("div",{className:"pick-thumb",style:{background:"var(--accent-pale)",color:"var(--accent)"},children:""}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{className:"pick-recipe-title",children:Te.title}),l.jsxs("div",{className:"pick-recipe-meta",children:[Te.source||"Try Soon",Te.time?`  ${Te.time} min`:""]})]}),l.jsx("span",{style:{color:"var(--ink4)",fontSize:20},children:""})]},"radar-"+Te.id)):l.jsx("div",{style:{padding:"24px 0",textAlign:"center",color:"var(--ink4)",fontSize:13,fontStyle:"italic"},children:u?.length?`No items match "${M}"`:"Nothing on your Try Soon list yet"})})()]}),P==="note"&&l.jsx("div",{style:{padding:"8px 0"},children:l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"What's the plan?"}),l.jsx("input",{className:"form-input",placeholder:"e.g. cheese omelette and salad",value:z,autoFocus:!0,onChange:Q=>Ie(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&z.trim()&&(v(n,z),d())}})]})}),P==="url"&&l.jsxs("div",{style:{paddingBottom:8},children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"URL"}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{className:"form-input",style:{flex:1},placeholder:"https://",value:ae,autoFocus:!0,onChange:Q=>an(Q.target.value),onBlur:bn}),re&&l.jsx("span",{style:{fontSize:11,color:"var(--ink4)",flexShrink:0},children:"fetching"}),!re&&ce&&l.jsx("img",{src:ce,alt:"",style:{width:40,height:40,borderRadius:6,objectFit:"cover",flexShrink:0}})]}),se&&l.jsx("div",{style:{fontSize:10,color:"var(--sage)",marginTop:3,fontStyle:"italic"},children:"Fetched from page"})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Title"}),l.jsx("input",{className:"form-input",placeholder:"e.g. Roast chicken with lemon",value:F,onChange:Q=>H(Q.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Source"}),l.jsx("input",{className:"form-input",placeholder:"e.g. NYT Cooking, Smitten Kitchen",value:G,onChange:Q=>we(Q.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Cook time (min)"}),l.jsx("input",{className:"form-input",type:"number",value:ie,onChange:Q=>be(Q.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Key ingredients ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsxs("div",{className:"ingredient-tags",onClick:Q=>Q.currentTarget.querySelector("input")?.focus(),children:[je.map((Q,Te)=>l.jsxs("span",{className:"ingredient-tag",children:[l.jsx("span",{style:{cursor:"pointer"},onClick:Ve=>{Ve.stopPropagation(),Le(Q),ye(Je=>Je.filter((Nn,on)=>on!==Te))},children:Q}),l.jsx("button",{className:"ingredient-tag-remove",onClick:Ve=>{Ve.stopPropagation(),ye(Je=>Je.filter((Nn,on)=>on!==Te))},children:""})]},Te)),l.jsx("input",{className:"ingredient-tag-input",placeholder:je.length===0?"e.g. salmon fillet":"add more",value:Oe,onChange:Q=>Le(Q.target.value),onKeyDown:Q=>{const Te=Oe.trim().toLowerCase();(Q.key==="Enter"||Q.key===",")&&Te?(Q.preventDefault(),je.includes(Te)||ye(Ve=>[...Ve,Te]),Le("")):Q.key==="Backspace"&&!Oe&&je.length>0&&ye(Ve=>Ve.slice(0,-1))},onBlur:()=>{const Q=Oe.trim().toLowerCase();Q&&!je.includes(Q)&&(ye(Te=>[...Te,Q]),Le(""))}})]}),l.jsx("div",{className:"ingredient-tag-hint",children:"Enter or comma to add"})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Prep note ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsx("input",{className:"form-input",placeholder:"e.g. Marinate overnight",value:k,onChange:Q=>C(Q.target.value)})]}),l.jsxs("div",{style:{marginTop:12,borderTop:"1px solid var(--border2)",paddingTop:12},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:"var(--ink3)",cursor:"pointer",marginBottom:ke?12:0},children:[l.jsx("input",{type:"checkbox",checked:ke,onChange:Q=>Ue(Q.target.checked),style:{accentColor:"var(--accent)"}}),l.jsx("span",{children:"Save to recipe library"})]}),ke&&l.jsxs("div",{children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Category"}),l.jsx("div",{className:"cat-select",children:[["dinner","Dinner"],["breakfast","Breakfast & Snacks"],["sweets","Sweets"],...A.map(Q=>[Q,Q])].map(([Q,Te])=>l.jsx("button",{type:"button",className:"cat-btn"+(me===Q?" active":""),onClick:()=>q(Q),children:Te},Q))})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Tags"}),l.jsx("div",{className:"tag-toggle-row",children:["fish","vegetarian",...x].map(Q=>l.jsx("button",{className:"tag-toggle"+(ee.includes(Q)?" on":""),onClick:()=>R(Te=>Te.includes(Q)?Te.filter(Ve=>Ve!==Q):[...Te,Q]),children:Q==="fish"?" Fish":Q==="vegetarian"?" Veg":Q},Q))})]})]})]})]})]}),l.jsxs("div",{className:"sheet-footer",children:[P==="note"&&l.jsx("button",{className:"sheet-btn sheet-btn-primary",disabled:!z.trim(),onClick:()=>{v(n,z),d()},children:"Save note"}),P==="url"&&l.jsxs("button",{className:"sheet-btn sheet-btn-primary",disabled:!F.trim()&&!ae.trim()||re,onClick:$n,children:["Plan for ",s?.day??"this night"]}),l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:d,children:P==="note"||P==="url"?"Back":"Cancel"})]})]})})}function uy({item:s,isToday:n,isPrimary:r,readyBy:o,onDetail:u,onRemove:d,isDragging:f,onDragStart:p,onDragEnd:g,onTouchDragStart:v}){const[y,E]=O.useState(!1),j=O.useRef(null),x=O.useRef(null),A=O.useRef(null),P=O.useRef(!1),D=ye=>{j.current=ye.touches[0].clientX,x.current=ye.touches[0].clientY,P.current=!1,A.current=setTimeout(()=>{P.current=!0,v&&v(s)},500)},M=ye=>{if(!P.current&&A.current&&j.current!==null){const Oe=Math.abs(ye.touches[0].clientX-j.current),Le=Math.abs(ye.touches[0].clientY-x.current);(Oe>10||Le>10)&&(clearTimeout(A.current),A.current=null)}},W=ye=>{if(A.current&&(clearTimeout(A.current),A.current=null),P.current){P.current=!1;return}if(j.current===null)return;const Oe=ye.changedTouches[0].clientX-j.current;j.current=null,Oe<-50?E(!0):Oe>30&&E(!1)},F={draggable:!0,onDragStart:ye=>{ye.dataTransfer.effectAllowed="move",p&&p()},onDragEnd:()=>{g&&g()}};if(s.itemType==="note")return l.jsxs("div",{className:"item-card item-card-note"+(n?" today":"")+(y?" swiped":"")+(f?" dragging":""),onTouchStart:D,onTouchMove:M,onTouchEnd:W,children:[l.jsx("div",{className:"item-card-inner",...F,onClick:()=>{},children:l.jsx("div",{className:"item-note-text",children:s.note})}),l.jsx("button",{className:"item-card-remove-hover",onClick:ye=>{ye.stopPropagation(),d()},children:""}),l.jsx("div",{className:"item-card-remove-swipe",onClick:()=>d(),children:"Remove"})]});const H=s.recipe;if(!H)return null;const ae=s.cookTime||H.time||30,le=H.title||"Untitled",ie=s.thumbnailUrl||H.thumbnailUrl||null,be=!H.inLibrary,je=r?sy(o,ae):null;return l.jsxs("div",{className:"item-card"+(be?" item-card-radar":"")+(n?" today":"")+(y?" swiped":"")+(f?" dragging":""),onTouchStart:D,onTouchMove:M,onTouchEnd:W,children:[l.jsxs("div",{className:"item-card-inner",...F,onClick:()=>u(H),children:[ie?l.jsx("img",{className:"item-card-thumb",src:ie,alt:""}):l.jsx("div",{className:"item-card-thumb-placeholder",children:be?"":""}),l.jsx("div",{className:"item-card-title",children:le}),be&&l.jsx("div",{className:"item-card-radar-label",children:"Try Soon"}),l.jsx("div",{className:"item-card-meta",children:r?l.jsxs("span",{children:[je,"  ",ae," min"]}):l.jsxs("span",{children:[ae," min"]})})]}),l.jsx("button",{className:"item-card-remove-hover",onClick:ye=>{ye.stopPropagation(),d()},children:""}),l.jsx("div",{className:"item-card-remove-swipe",onClick:()=>d(),children:"Remove"})]})}function dy({recipes:s,onClose:n,onAdd:r,onAddRecipe:o,customTags:u=[],customCategories:d=[]}){const[f,p]=O.useState("pick"),[g,v]=O.useState(""),[y,E]=O.useState(""),[j,x]=O.useState(""),[A,P]=O.useState(""),[D,M]=O.useState("30"),[W,F]=O.useState([]),[H,ae]=O.useState(""),[le,ie]=O.useState(""),[be,je]=O.useState("dinner"),[ye,Oe]=O.useState([]),[Le,ke]=O.useState(""),[Ue,G]=O.useState(null),[we,me]=O.useState(null),[q,ee]=O.useState(null),[R,k]=O.useState([]),[C,ce]=O.useState([]),[pe,$]=O.useState(!1),oe=s.filter(K=>g===""||K.title.toLowerCase().includes(g.toLowerCase())),de=K=>{r(K),n()},Ee=()=>{if(!y.trim())return;const K={title:y.trim(),source:"Added manually",url:null,category:"dinner",tags:[],time:0,ingredients:[],inLibrary:!1,_needsInsert:!0};r(K),n()},Ne=()=>{if(!j.trim())return;const K={title:j.trim(),source:pe&&le.trim()||"Added manually",url:A.trim()||null,category:pe&&be||"dinner",tags:pe?ye:[],time:parseInt(D)||30,ingredients:W,prepNote:Le.trim()||void 0,thumbnailUrl:Ue,description:we||null,instructions:R,servings:q||null,rawIngredients:C,inLibrary:pe,_needsInsert:!0};pe&&o(K),r(K),n()};return l.jsx("div",{className:"sheet-overlay",onClick:n,children:l.jsxs("div",{className:"sheet",onClick:K=>K.stopPropagation(),children:[l.jsx("div",{className:"sheet-handle"}),l.jsxs("div",{className:"sheet-header",children:[l.jsxs("div",{className:"sheet-title",children:["Weekend ",l.jsx("em",{children:"Batch"})," Prep"]}),l.jsx("div",{className:"sheet-subtitle",children:"Add a recipe to make ahead this weekend"})]}),l.jsxs("div",{className:"sheet-mode-toggle",children:[l.jsx("button",{className:"sheet-mode-btn"+(f==="pick"?" active":""),onClick:()=>p("pick"),children:"From library"}),l.jsx("button",{className:"sheet-mode-btn"+(f==="note"?" active":""),onClick:()=>p("note"),children:"Add note"}),l.jsx("button",{className:"sheet-mode-btn"+(f==="new"?" active":""),onClick:()=>p("new"),children:"New recipe"})]}),l.jsxs("div",{className:"sheet-body",children:[f==="pick"&&l.jsxs(l.Fragment,{children:[l.jsx("input",{className:"pick-search",placeholder:"Search recipes",value:g,onChange:K=>v(K.target.value),autoFocus:!0}),oe.map(K=>l.jsxs("div",{className:"pick-recipe-item",onClick:()=>de(K),children:[l.jsx("div",{className:"pick-thumb",children:K.title[0]}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{className:"pick-recipe-title",children:K.title}),l.jsxs("div",{className:"pick-recipe-meta",children:[K.source,"  ",K.time," min"]}),l.jsx("div",{className:"pick-tags",children:l.jsx(Zl,{tags:K.tags})})]}),l.jsx("span",{style:{color:"var(--ink4)",fontSize:20},children:""})]},K.id)),oe.length===0&&l.jsxs("div",{style:{padding:"24px 0",textAlign:"center",color:"var(--ink4)",fontSize:13,fontStyle:"italic"},children:['No recipes match "',g,'"']})]}),f==="note"&&l.jsx("div",{style:{padding:"8px 0"},children:l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"What's the plan?"}),l.jsx("input",{className:"form-input",placeholder:"e.g. chicken stock, granola bars",value:y,autoFocus:!0,onChange:K=>E(K.target.value),onKeyDown:K=>{K.key==="Enter"&&y.trim()&&Ee()}})]})}),f==="new"&&l.jsxs("div",{style:{paddingBottom:8},children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Recipe name"}),l.jsx("input",{className:"form-input",placeholder:"e.g. Roast chicken with lemon",value:j,onChange:K=>x(K.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["URL ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("input",{className:"form-input",style:{flex:1},placeholder:"https://",value:A,onChange:K=>P(K.target.value),onBlur:async()=>{if(!A.trim())return;const{thumbnailUrl:K,scrapedData:he}=await cr(A.trim());K&&G(K),he&&(!j.trim()&&he.title&&x(he.title),D==="30"&&he.cookTime&&M(String(he.cookTime)),!W.length&&he.ingredients&&F(he.ingredients),he.description&&me(he.description),he.servings&&ee(he.servings),he.instructions&&k(he.instructions),he.ingredients&&ce(he.ingredients))}}),Ue&&l.jsx("img",{src:Ue,alt:"",style:{width:40,height:40,borderRadius:6,objectFit:"cover",flexShrink:0}})]})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Cook time (min)"}),l.jsx("input",{className:"form-input",type:"number",value:D,onChange:K=>M(K.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Key ingredients ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsxs("div",{className:"ingredient-tags",onClick:K=>K.currentTarget.querySelector("input")?.focus(),children:[W.map((K,he)=>l.jsxs("span",{className:"ingredient-tag",children:[l.jsx("span",{style:{cursor:"pointer"},onClick:V=>{V.stopPropagation(),ae(K),F(re=>re.filter((X,se)=>se!==he))},children:K}),l.jsx("button",{className:"ingredient-tag-remove",onClick:V=>{V.stopPropagation(),F(re=>re.filter((X,se)=>se!==he))},children:""})]},he)),l.jsx("input",{className:"ingredient-tag-input",placeholder:W.length===0?"e.g. salmon fillet":"add more",value:H,onChange:K=>ae(K.target.value),onKeyDown:K=>{const he=H.trim().toLowerCase();(K.key==="Enter"||K.key===",")&&he?(K.preventDefault(),W.includes(he)||F(V=>[...V,he]),ae("")):K.key==="Backspace"&&!H&&W.length>0&&F(V=>V.slice(0,-1))},onBlur:()=>{const K=H.trim().toLowerCase();K&&!W.includes(K)&&(F(he=>[...he,K]),ae(""))}})]}),l.jsx("div",{className:"ingredient-tag-hint",children:"Enter or comma to add"})]}),l.jsxs("div",{className:"form-field",children:[l.jsxs("label",{className:"form-label",children:["Prep note ",l.jsx("span",{style:{fontWeight:400,color:"var(--ink4)"},children:"optional"})]}),l.jsx("input",{className:"form-input",placeholder:"e.g. Marinate overnight",value:Le,onChange:K=>ke(K.target.value)})]}),l.jsxs("div",{style:{marginTop:12,borderTop:"1px solid var(--border2)",paddingTop:12},children:[l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:"var(--ink3)",cursor:"pointer",marginBottom:pe?12:0},children:[l.jsx("input",{type:"checkbox",checked:pe,onChange:K=>$(K.target.checked),style:{accentColor:"var(--accent)"}}),l.jsx("span",{children:"Save to recipe library"})]}),pe&&l.jsxs("div",{children:[l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Source"}),l.jsx("input",{className:"form-input",placeholder:"e.g. NYT Cooking, Smitten Kitchen",value:le,onChange:K=>ie(K.target.value)})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Category"}),l.jsx("div",{className:"cat-select",children:[["dinner","Dinner"],["breakfast","Breakfast & Snacks"],["sweets","Sweets"],...d.map(K=>[K,K])].map(([K,he])=>l.jsx("button",{type:"button",className:"cat-btn"+(be===K?" active":""),onClick:()=>je(K),children:he},K))})]}),l.jsxs("div",{className:"form-field",children:[l.jsx("label",{className:"form-label",children:"Tags"}),l.jsx("div",{className:"tag-toggle-row",children:["fish","vegetarian",...u].map(K=>l.jsx("button",{className:"tag-toggle"+(ye.includes(K)?" on":""),onClick:()=>Oe(he=>he.includes(K)?he.filter(V=>V!==K):[...he,K]),children:K==="fish"?" Fish":K==="vegetarian"?" Veg":K},K))})]})]})]})]})]}),l.jsxs("div",{className:"sheet-footer",children:[f==="note"&&l.jsx("button",{className:"sheet-btn sheet-btn-primary",disabled:!y.trim(),onClick:Ee,children:"Add"}),f==="new"&&l.jsx("button",{className:"sheet-btn sheet-btn-primary",disabled:!j.trim(),onClick:Ne,children:"Add"}),l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:n,children:"Cancel"})]})]})})}function hy({week:s,staples:n,freezer:r,fridge:o,regulars:u,regChecked:d,onToggleRegChecked:f,shopChecked:p,onToggleShopChecked:g,freeShop:v,onAddFreeShop:y,onToggleFreeShop:E,onRemoveFreeShop:j,shopFilters:x,shopSectionKeywords:A}){const[P,D]=O.useState(""),[M,W]=O.useState(new Set),[F,H]=O.useState(new Set),[ae,le]=O.useState(null),ie=n.filter($=>$.status==="ok").map($=>$.name.toLowerCase()),be=(r||[]).map($=>$.item.toLowerCase()),je=(o||[]).map($=>$.item.toLowerCase()),ye=n.filter($=>$.status==="restock").map($=>({id:"staple:"+$.name,text:$.name,source:"restock",recipeName:"pantry restock"})),Oe=(s||[]).flatMap($=>$.items.filter(oe=>oe.itemType==="recipe"&&(oe.ingredients?.length||oe.recipe?.ingredients?.length)).flatMap(oe=>{const de=oe.ingredients?.length?oe.ingredients:oe.recipe?.ingredients||[],Ee=oe.recipe?.title||"Unknown";return de.map(Ne=>({text:Ne,source:$.day,id:$.day+":"+oe.id+":"+Ne,recipeName:Ee}))})).filter($=>!ie.includes($.text.toLowerCase())&&!be.includes($.text.toLowerCase())&&!je.includes($.text.toLowerCase())),Le=[],ke={};Oe.forEach($=>{ke[$.text]?(ke[$.text].source+=", "+$.source,ke[$.text].recipeName+=", "+$.recipeName):(ke[$.text]={...$},Le.push(ke[$.text]))});const Ue=[...ye,...Le,...v].filter($=>!F.has($.id)),G=n.filter($=>$.status==="ok").map($=>$.name.toLowerCase()),we=[...new Set([...G,...x])],me=$=>we.some(oe=>Xl($).toLowerCase().includes(oe)),q=Ue.filter($=>$.source==="restock"||!me($.text)||M.has($.id)),ee=Ue.filter($=>$.source!=="restock"&&me($.text)&&!M.has($.id)),R=Ph(q),k=$=>{$.done!==void 0?E($.id):g($.id)},C=$=>{$.done!==void 0?j($.id):H(oe=>new Set([...oe,$.id]))},ce=$=>{W(oe=>new Set([...oe,$.id]))},pe=$=>{W(oe=>{const de=new Set(oe);return de.delete($.id),de})};return l.jsxs("div",{className:"week-shop-section",onClick:()=>ae&&le(null),children:[u.length>0&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"week-shop-group-label",children:"Every week"}),l.jsx("div",{className:"week-shop-pills",children:u.map($=>l.jsx("span",{className:"shop-pill"+(d[$.id]?" done":""),onClick:()=>f($.id),children:$.name},$.id))})]}),q.length>0&&(()=>{const $={};return q.forEach(oe=>{const de=Ih(oe.text,A);$[de]||($[de]=[]),$[de].push(oe)}),Ua.filter(oe=>$[oe.id]?.length).map(oe=>l.jsxs("div",{children:[l.jsx("div",{className:"shop-section-header",children:oe.label}),l.jsx("div",{className:"week-shop-pills",children:$[oe.id].map(de=>{const Ee=R.has(de.id),Ne=p[de.id]||de.done,K=M.has(de.id);return l.jsxs("span",{style:{position:"relative"},children:[l.jsxs("span",{className:"shop-pill"+(Ee?" duplicate":"")+(Ne?" done":""),onClick:he=>{Ee&&!Ne?(he.stopPropagation(),le(ae===de.id?null:de.id)):k(de)},children:[de.text,K&&!Ne&&l.jsx("button",{className:"pill-refilter",onClick:he=>{he.stopPropagation(),pe(de)},children:""}),l.jsx("button",{className:"pill-remove",onClick:he=>{he.stopPropagation(),C(de)},children:""})]}),ae===de.id&&R.get(de.id)&&l.jsxs("span",{className:"dup-popover",onClick:he=>he.stopPropagation(),children:["Also needed: ",R.get(de.id).map(he=>he.text+"  "+he.recipeName).join("; "),l.jsx("br",{}),l.jsx("span",{style:{fontSize:10,color:"var(--ink4)"},children:"Tap pill again to check off"})]})]},de.id)})})]},oe.id))})(),ee.length>0&&l.jsxs("details",{className:"filtered-section",children:[l.jsxs("summary",{className:"filtered-summary",children:["Filtered out (",ee.length,")"]}),l.jsx("div",{className:"filtered-note",children:"These match common staples  check your pantry"}),l.jsx("div",{className:"week-shop-pills",children:ee.map($=>l.jsx("span",{className:"shop-pill filtered",onClick:()=>ce($),children:$.text},$.id))})]}),u.length===0&&q.length===0&&ee.length===0&&l.jsx("div",{className:"week-shop-empty",children:"Plan dinners to populate your list."}),l.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10},children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add item",style:{fontSize:11},value:P,onChange:$=>D($.target.value),onKeyDown:$=>{$.key==="Enter"&&P.trim()&&(y(P.trim()),D(""))}}),l.jsx("button",{className:"pantry-add-btn",disabled:!P.trim(),style:{fontSize:11,padding:"6px 10px"},onClick:()=>{P.trim()&&(y(P.trim()),D(""))},children:"Add"})]})]})}function fy({goals:s,week:n,recipes:r,onOpenShop:o,shopCount:u,fridge:d,freezer:f,staples:p,regulars:g,regChecked:v,shopChecked:y,freeShop:E,radar:j,customTags:x,customCategories:A,batch:P,prepTasks:D,prepChecked:M,onAddItem:W,onRemoveItem:F,onMoveItem:H,onClearDay:ae,onAddNote:le,onAddRecipe:ie,onUpdateRecipe:be,onDeleteRecipe:je,onWeekReset:ye,onPromoteRadar:Oe,onAddBatch:Le,onRemoveBatch:ke,onAddPrepTask:Ue,onTogglePrepTask:G,onTogglePrepChecked:we,onToggleRegChecked:me,onToggleShopChecked:q,onAddFreeShop:ee,onToggleFreeShop:R,onRemoveFreeShop:k,onAdjustFreezerQty:C,shopFilters:ce,shopSectionKeywords:pe}){const[$,oe]=O.useState(!0),[de,Ee]=O.useState(!0),[Ne,K]=O.useState(!1),[he,V]=O.useState(null),[re,X]=O.useState(""),[se,Fe]=O.useState(null),[ot,Rt]=O.useState(null),[St,mt]=O.useState(null),[z,Ie]=O.useState(null),[Be,Ge]=O.useState(null),[Ze,sn]=O.useState(null),bn=B=>{z&&z.fromDayIndex!==B&&H(z.id,z.fromDayIndex,B),Ie(null),Ge(null)};O.useEffect(()=>{if(!Ze)return;const B=Me=>{Me.preventDefault();const Xe=Me.touches[0];sn(yt=>yt?{...yt,x:Xe.clientX,y:Xe.clientY}:null);const wn=document.elementFromPoint(Xe.clientX,Xe.clientY);if(wn){const yt=wn.closest("[data-day-index]");Ge(yt?parseInt(yt.dataset.dayIndex):null)}},Ce=()=>{Ze&&Be!==null&&Ze.fromDayIndex!==Be&&H(Ze.id,Ze.fromDayIndex,Be),sn(null),Ie(null),Ge(null)};return window.addEventListener("touchmove",B,{passive:!1}),window.addEventListener("touchend",Ce),()=>{window.removeEventListener("touchmove",B),window.removeEventListener("touchend",Ce)}},[Ze,Be,H]);const an=n.flatMap(B=>B.items.filter(Ce=>Ce.recipe?.prepNote).map(Ce=>({key:B.day+":"+Ce.id+":"+Ce.recipe.id,task:Ce.recipe.prepNote,day:B.day,done:!!M[B.day+":"+Ce.id+":"+Ce.recipe.id]}))),$n=(f||[]).map(B=>B.item.toLowerCase()),Qt=n.flatMap(B=>B.items.filter(Ce=>Ce.recipe?.ingredients?.length).flatMap(Ce=>Ce.recipe.ingredients.filter(Me=>$n.includes(Me.toLowerCase())).map(Me=>({key:"thaw:"+B.day+":"+Ce.id+":"+Me,ing:Me,day:B.day,done:!!M["thaw:"+B.day+":"+Ce.id+":"+Me]})))),Wt=B=>Fe({dayIndex:B}),jn=()=>Fe(null),zn=(B,Ce)=>{W(B,Ce)},Q=B=>{F(B)},Te=(B,Ce)=>{le(B,Ce)},Ve=B=>{ie(B)},Je=B=>{Le(B)},Nn=[6,0,1,2,3,4,5],on=new Date(dt+"T00:00:00"),ur=new Date().toISOString().slice(0,10),yn=Ah.map((B,Ce)=>{const Me=new Date(on);return Me.setDate(Me.getDate()+Ce),Me}).findIndex(B=>B.toISOString().slice(0,10)===ur),dr=n.flatMap(B=>B.items.filter(Ce=>Ce.itemType==="recipe"&&Ce.recipe)),hr=dr.filter(B=>B.recipe.tags?.includes("fish")).length,fr=dr.filter(B=>B.recipe.tags?.includes("vegetarian")).length,Fn=hr>=s.fishMin,Bn=fr>=s.vegMin,pr=Fn&&Bn;return ot?.recipe?l.jsx(Gl,{recipe:ot.recipe,source:"plan",itemId:ot.itemId,onClose:()=>Rt(null),onSave:B=>{be(B),Rt({...ot,recipe:B})},onRemoveFromPlan:()=>{F(ot.itemId),Rt(null)},customTags:x,customCategories:A}):l.jsxs("div",{children:[l.jsxs("div",{className:"page-header",children:[l.jsx("div",{children:l.jsxs("div",{className:"page-title",children:["This ",l.jsx("em",{children:"Week"})]})}),l.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[Ne?l.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[l.jsx("span",{style:{fontSize:11,color:"var(--ink3)"},children:"Clear everything?"}),l.jsx("button",{className:"shop-fab",style:{background:"var(--accent)",color:"#fff",borderColor:"var(--accent)",fontSize:11,padding:"6px 12px"},onClick:()=>{const B=[...new Map(n.flatMap(Ce=>Ce.items.filter(Me=>Me.recipe&&!Me.recipe.inLibrary)).map(Ce=>[Ce.recipe.id,Ce.recipe])).values()];B.length>0?V(B.map(Ce=>({recipe:Ce,checked:!0}))):ye(),K(!1)},children:"Yes"}),l.jsx("button",{className:"shop-fab",style:{fontSize:11,padding:"6px 12px"},onClick:()=>K(!1),children:"Cancel"})]}):l.jsx("button",{className:"shop-fab",style:{color:"var(--ink4)",fontSize:11,padding:"6px 12px"},onClick:()=>K(!0),children:" New week"}),l.jsxs("button",{className:"shop-fab",onClick:o,children:[" List",u>0&&l.jsx("span",{className:"shop-count-badge",children:u})]})]})]}),l.jsxs("div",{className:"goal-strip",children:[l.jsxs("div",{className:"goal-item "+(Fn?"met":"unmet"),children:[l.jsx("div",{className:"goal-dot"})," ",hr,"/",s.fishMin," fish"]}),l.jsx("div",{className:"goal-divider"}),l.jsxs("div",{className:"goal-item "+(Bn?"met":"unmet"),children:[l.jsx("div",{className:"goal-dot"})," ",fr,"/",s.vegMin," veg"]}),pr&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"goal-divider"}),l.jsxs("div",{className:"goal-item met",style:{marginLeft:"auto"},children:[l.jsx("div",{className:"goal-dot"}),"  goals met"]})]})]}),(()=>{if(!d)return null;const B=n.flatMap(Me=>Me.items.filter(Xe=>Xe.recipe?.ingredients?.length)).flatMap(Me=>Me.recipe.ingredients.map(Xe=>Xe.toLowerCase())),Ce=d.filter(Me=>Me.s==="soon"&&!B.includes(Me.item.toLowerCase()));return Ce.length?l.jsxs("div",{className:"use-soon-alert",children:[l.jsx("div",{className:"use-soon-alert-icon",children:""}),l.jsxs("div",{className:"use-soon-alert-body",children:[l.jsx("div",{className:"use-soon-alert-title",children:"Use soon  not in this week's recipes"}),l.jsx("div",{className:"use-soon-alert-items",children:Ce.map(Me=>Me.item).join("  ")})]})]}):null})(),l.jsx("div",{className:"section-header",style:{cursor:"default",marginTop:4},children:l.jsxs("div",{className:"section-header-title",children:["This Week's ",l.jsx("em",{children:"Dinners"})]})}),l.jsxs("div",{className:"week-scroll-wrapper",children:[l.jsx("div",{className:"week-scroll",children:Nn.map(B=>{const Ce=n[B];if(!Ce)return null;const Me=B===yn;return l.jsxs("div",{className:"day-col"+(Be===B?" drop-target":""),"data-day-index":B,onDragOver:Xe=>{Xe.preventDefault(),Ge(B)},onDragLeave:()=>{Be===B&&Ge(null)},onDrop:Xe=>{Xe.preventDefault(),bn(B)},children:[l.jsx("div",{className:"day-col-header"+(Me?" today":""),children:l.jsx("span",{className:"day-col-name",children:Ce.day})}),Ce.items.length===0&&l.jsx("div",{className:"day-empty-card",onClick:()=>Wt(B),children:l.jsx("span",{children:"+ plan dinner"})}),Ce.items.map((Xe,wn)=>l.jsx(uy,{item:Xe,isToday:Me,isPrimary:wn===0,readyBy:s.readyBy,onDetail:yt=>Rt({recipe:yt,itemId:Xe.id}),onRemove:()=>Q(Xe.id),isDragging:z?.id===Xe.id,onDragStart:()=>Ie({id:Xe.id,fromDayIndex:B}),onDragEnd:()=>{Ie(null),Ge(null)},onTouchDragStart:yt=>sn({id:yt.id,fromDayIndex:B,x:0,y:0,title:yt.recipe?.title||yt.note||""})},Xe.id)),Ce.items.length>0&&l.jsx("div",{className:"day-add-card",onClick:()=>Wt(B),children:l.jsx("span",{children:"+"})})]},B)})}),l.jsx("div",{className:"week-scroll-fade"})]}),Ze&&l.jsx("div",{className:"drag-ghost",style:{left:Ze.x-30,top:Ze.y-20},children:l.jsx("div",{className:"drag-ghost-inner",children:Ze.title})}),l.jsx("div",{className:"section-header",style:{cursor:"default"},children:l.jsxs("div",{className:"section-header-title",children:["Weekend ",l.jsx("em",{children:"Batch Cooking"})]})}),l.jsx("div",{className:"batch-section",children:l.jsxs("div",{className:"batch-row",children:[P.map(B=>{if(!B)return null;const Ce=B.pdfUrl||B.url||null;return l.jsxs("div",{className:"batch-recipe-card",onClick:()=>mt(B),children:[l.jsx("button",{className:"batch-card-remove",onClick:Me=>{Me.stopPropagation(),ke(B.id)},children:""}),l.jsxs("div",{className:"batch-card-body",children:[l.jsx("div",{className:"batch-card-title",children:B.title}),Ce?l.jsxs("a",{className:"batch-card-source linked",href:Ce,target:"_blank",rel:"noopener noreferrer",onClick:Me=>Me.stopPropagation(),children:[B.source,l.jsx("span",{className:"source-arrow",children:" "})]}):l.jsx("div",{className:"batch-card-source",children:B.source}),l.jsx("div",{className:"batch-card-meta",children:l.jsxs("span",{className:"batch-card-time",children:[B.time,"m"]})})]})]},B.id)}),l.jsxs("div",{className:"batch-add-card",onClick:()=>Fe({dayIndex:-1,mode:"batch"}),children:[l.jsx("span",{className:"batch-add-card-icon",children:""}),l.jsx("span",{children:"Add batch recipe"})]})]})}),l.jsxs("div",{className:"section-header",onClick:()=>Ee(B=>!B),children:[l.jsxs("div",{className:"section-header-title",children:["Weekend ",l.jsx("em",{children:"Prep"})]}),l.jsx("span",{className:"section-header-chevron"+(de?" open":""),children:""})]}),de&&l.jsxs("div",{className:"prep-section",children:[l.jsxs("div",{className:"prep-list",children:[Qt.map(B=>l.jsxs("div",{className:"prep-item",style:{opacity:B.done?.45:1},children:[l.jsx("input",{type:"checkbox",checked:B.done,onChange:()=>we(B.key)}),l.jsxs("span",{className:"prep-item-text",style:{textDecoration:B.done?"line-through":"none"},children:["Thaw ",B.ing]}),l.jsxs("span",{className:"prep-recipe-tag",style:{background:"#eaf4fb",color:"#2a6a8a",borderColor:"#a8cfe0"},children:[" ",B.day]})]},B.key)),an.map(B=>l.jsxs("div",{className:"prep-item",style:{opacity:B.done?.45:1},children:[l.jsx("input",{type:"checkbox",checked:B.done,onChange:()=>we(B.key)}),l.jsx("span",{className:"prep-item-text",style:{textDecoration:B.done?"line-through":"none"},children:B.task}),l.jsxs("span",{className:"prep-recipe-tag",children:["For ",B.day]})]},B.key)),D.map(B=>l.jsxs("div",{className:"prep-item",style:{opacity:B.done?.45:1},children:[l.jsx("input",{type:"checkbox",checked:B.done,onChange:()=>G(B.id)}),l.jsx("span",{className:"prep-item-text",style:{textDecoration:B.done?"line-through":"none"},children:B.task}),l.jsx("span",{className:"prep-recipe-tag",style:{opacity:.4},children:"custom"})]},B.id)),Qt.length===0&&an.length===0&&D.length===0&&l.jsx("div",{style:{padding:"14px 0",color:"var(--ink4)",fontSize:12,fontStyle:"italic"},children:"Prep tasks will appear here once dinners are planned."})]}),l.jsxs("div",{className:"prep-add-row",children:[l.jsx("input",{className:"prep-add-input",placeholder:"Add a prep task",value:re,onChange:B=>X(B.target.value),onKeyDown:B=>{B.key==="Enter"&&re.trim()&&(Ue(re.trim()),X(""))}}),l.jsx("button",{className:"prep-add-btn",disabled:!re.trim(),onClick:()=>{re.trim()&&(Ue(re.trim()),X(""))},children:"Add"})]})]}),l.jsxs("div",{className:"section-header",onClick:()=>oe(B=>!B),children:[l.jsxs("div",{className:"section-header-title",children:["Shopping ",l.jsx("em",{children:"List"})]}),l.jsx("span",{className:"section-header-chevron"+($?" open":""),children:""})]}),$&&l.jsx(hy,{week:n,staples:p,freezer:f,fridge:d,regulars:g,regChecked:v,onToggleRegChecked:me,shopChecked:y,onToggleShopChecked:q,freeShop:E,onAddFreeShop:ee,onToggleFreeShop:R,onRemoveFreeShop:k,shopFilters:ce,shopSectionKeywords:pe}),he&&l.jsx("div",{className:"sheet-overlay",onClick:()=>V(null),children:l.jsxs("div",{className:"sheet",onClick:B=>B.stopPropagation(),children:[l.jsx("div",{className:"sheet-handle"}),l.jsx("div",{className:"sheet-header",children:l.jsx("div",{className:"sheet-title",children:"Keep these recipes?"})}),l.jsx("p",{style:{fontSize:13,color:"var(--ink3)",margin:"0 0 12px"},children:"These radar items were in this week's plan. Save any to your library?"}),he.map((B,Ce)=>l.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 0",borderBottom:"1px solid var(--border)",cursor:"pointer"},children:[l.jsx("input",{type:"checkbox",checked:B.checked,onChange:()=>{V(Me=>Me.map((Xe,wn)=>wn===Ce?{...Xe,checked:!Xe.checked}:Xe))}}),l.jsxs("span",{style:{flex:1},children:[l.jsx("strong",{children:B.recipe.title}),B.recipe.source&&l.jsx("span",{style:{fontSize:12,color:"var(--ink3)",marginLeft:6},children:B.recipe.source})]})]},B.recipe.id)),l.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,justifyContent:"flex-end"},children:[l.jsx("button",{className:"shop-fab",style:{fontSize:12,padding:"8px 14px"},onClick:()=>{ye(),V(null)},children:"Just clear"}),l.jsx("button",{className:"shop-fab",style:{background:"var(--accent)",color:"#fff",borderColor:"var(--accent)",fontSize:12,padding:"8px 14px"},onClick:()=>{he.filter(B=>B.checked).forEach(B=>Oe(B.recipe.id)),ye(),V(null)},children:"Save & clear week"})]})]})}),St&&l.jsx("div",{className:"sheet-overlay",children:l.jsx("div",{className:"detail-overlay-panel",onClick:B=>B.stopPropagation(),children:l.jsx(Gl,{recipe:St,source:"library",onClose:()=>mt(null),onSave:B=>{be(B),mt(B)},onDelete:B=>{je(B),mt(null)},customTags:x,customCategories:A})})}),se!==null&&se.mode!=="batch"&&l.jsx(cy,{targetDay:n[se.dayIndex],dayIndex:se.dayIndex,week:n,recipes:r,radar:j,onClose:jn,onAddItem:zn,onRemoveItem:Q,onClearDay:ae,onAddNote:Te,onAddRecipe:Ve,freezer:f,onAdjustFreezerQty:C,customTags:x,customCategories:A}),se!==null&&se.mode==="batch"&&l.jsx(dy,{recipes:r,onClose:jn,onAdd:Je,onAddRecipe:ie,customTags:x,customCategories:A})]})}function py({item:s,onClose:n,onPromote:r,onPlan:o,onChangeCategory:u,customCategories:d=[]}){const f=[{k:"dinner",l:"Dinner"},{k:"breakfast",l:"Breakfast"},{k:"sweets",l:"Sweets"},...d.map(p=>({k:p,l:p}))];return l.jsx("div",{className:"sheet-overlay",onClick:n,children:l.jsxs("div",{className:"sheet",onClick:p=>p.stopPropagation(),children:[l.jsx("div",{className:"sheet-handle"}),l.jsxs("div",{className:"sheet-header",children:[l.jsx("div",{className:"sheet-title",children:l.jsx("em",{children:s.title})}),s.source&&l.jsx("div",{className:"sheet-subtitle",children:s.source})]}),l.jsxs("div",{className:"sheet-body",children:[s.url&&l.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"detail-link",children:[l.jsx("span",{className:"detail-link-icon",children:""}),l.jsxs("div",{className:"detail-link-text",children:[l.jsx("div",{className:"detail-link-label",children:"Open recipe"}),l.jsx("div",{className:"detail-link-url",children:s.url})]}),l.jsx("span",{className:"detail-link-arrow",children:""})]}),l.jsxs("div",{style:{marginTop:s.url?16:0},children:[l.jsx("div",{className:"form-label",children:"Category"}),l.jsx("div",{className:"cat-select",children:f.map(p=>l.jsx("button",{className:"cat-btn"+((s.category||"dinner")===p.k?" active":""),style:{fontSize:11,padding:"4px 10px"},onClick:()=>u(p.k),children:p.l},p.k))})]}),l.jsxs("div",{className:"radar-sheet-actions",style:{marginTop:16},children:[l.jsx("button",{className:"sheet-btn sheet-btn-primary",onClick:r,children:"Add to recipe library"}),o&&l.jsx("button",{className:"sheet-btn",style:{background:"var(--surface2)",border:"1px solid var(--border)",color:"var(--ink2)"},onClick:o,children:"Plan for this week"})]})]}),l.jsx("div",{className:"sheet-footer",children:l.jsx("button",{className:"sheet-btn sheet-btn-cancel",onClick:n,children:"Close"})})]})})}function my({recipes:s,library:n,onAddRecipe:r,onUpdateRecipe:o,onDeleteRecipe:u,radar:d,onAddRadar:f,onRemoveRadar:p,onPromoteRadar:g,customTags:v=[],customCategories:y=[]}){const[E,j]=O.useState("all"),[x,A]=O.useState(null),[P,D]=O.useState(!1),[M,W]=O.useState(null),[F,H]=O.useState(!1),[ae,le]=O.useState(""),[ie,be]=O.useState(""),[je,ye]=O.useState(""),[Oe,Le]=O.useState(!1),[ke,Ue]=O.useState("dinner"),[G,we]=O.useState({}),me=C=>we(ce=>({...ce,[C]:!ce[C]})),q=[{k:"all",l:"All"},{k:"fish",l:" Fish"},{k:"vegetarian",l:" Veg"}],ee=E==="all"?n:n.filter(C=>C.tags?.includes(E)),R=async()=>{const C=ie.trim();if(!C)return;Le(!0);const{scrapedData:ce}=await cr(C);ce&&!ae.trim()&&ce.title&&le(ce.title);try{je.trim()||ye(new URL(C).hostname.replace(/^www\./,""))}catch{}Le(!1)},k=()=>{if(!ae.trim()&&!ie.trim())return;const C=ae.trim()||(()=>{try{return new URL(ie.trim()).hostname.replace(/^www\./,"")}catch{return ie.trim()}})();f({title:C,url:ie.trim()||null,source:je.trim()||"",category:ke}),le(""),be(""),ye(""),Ue("dinner"),H(!1)};return x?l.jsx(Gl,{recipe:x,source:"library",onClose:()=>A(null),onSave:C=>{o(C),A(C)},onDelete:C=>{u(C),A(null)},customTags:v,customCategories:y}):l.jsxs("div",{className:"tab-section",children:[l.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:16},children:[l.jsxs("div",{children:[l.jsx("div",{className:"page-title",children:"Recipes"}),l.jsxs("div",{className:"page-date",children:[n.length," saved"]})]}),l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[l.jsx("div",{className:"filter-row",style:{margin:0,flex:"none"},children:q.map(C=>l.jsx("button",{className:"fpill"+(E===C.k?" active":""),onClick:()=>j(C.k),children:C.l},C.k))}),l.jsx("button",{className:"btn btn-primary",onClick:()=>D(!0),children:"+ Add"}),l.jsx("button",{style:{fontSize:11,color:"var(--sage)",background:"none",border:"1px solid var(--sage-light)",borderRadius:16,padding:"6px 12px",cursor:"pointer",fontFamily:"inherit",fontWeight:700,whiteSpace:"nowrap"},onClick:()=>H(!0),children:"+ Try Soon"})]})]}),F&&l.jsxs("div",{style:{padding:"0 18px 12px",display:"flex",flexDirection:"column",gap:6},children:[l.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Recipe name",value:ae,autoFocus:!0,style:{flex:"2 1 140px"},onChange:C=>le(C.target.value),onKeyDown:C=>C.key==="Enter"&&k()}),l.jsx("input",{className:"pantry-add-input",placeholder:"URL (optional)",value:ie,style:{flex:"3 1 180px"},onChange:C=>be(C.target.value),onBlur:R,onKeyDown:C=>C.key==="Enter"&&k()})]}),l.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[l.jsx("div",{className:"cat-select",children:[{k:"dinner",l:"Dinner"},{k:"breakfast",l:"Breakfast"},{k:"sweets",l:"Sweets"},...y.map(C=>({k:C,l:C}))].map(C=>l.jsx("button",{className:"cat-btn"+(ke===C.k?" active":""),style:{fontSize:11,padding:"4px 10px"},onClick:()=>Ue(C.k),children:C.l},C.k))}),Oe&&l.jsx("span",{style:{fontSize:11,color:"var(--ink4)",flexShrink:0},children:"fetching"}),l.jsx("button",{className:"pantry-add-btn",disabled:!ae.trim()&&!ie.trim()||Oe,onClick:k,children:"Add"}),l.jsx("button",{className:"sheet-btn sheet-btn-cancel",style:{padding:"6px 10px",fontSize:12},onClick:()=>{H(!1),le(""),be(""),ye(""),Ue("dinner")},children:"Cancel"})]})]}),(()=>{const C=[{key:"dinner",label:"Dinner"},{key:"breakfast",label:"Breakfast & Snacks"},{key:"sweets",label:"Sweets"},...y.map($=>({key:$,label:$})),{key:"",label:"Uncategorized"}],pe=[...["dinner","breakfast","sweets"],...y];return C.map(({key:$,label:oe})=>{const de=$||"uncat",Ee=ee.filter(V=>$===""?!V.category||!pe.includes(V.category):V.category===$),Ne=d.filter(V=>{const re=V.category||"dinner";return $===""?!pe.includes(re):re===$});if(!Ee.length&&!Ne.length)return null;const K=Ee.length+Ne.length,he=G[de];return l.jsxs("div",{children:[l.jsxs("div",{className:"recipe-section-label",onClick:()=>me(de),children:[l.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:[oe,!he&&l.jsx("span",{className:"recipe-section-count",children:K})]}),l.jsx("span",{style:{fontSize:9,color:"var(--ink4)",transition:"transform 0.2s",display:"inline-block",transform:he?"rotate(-90deg)":"rotate(0deg)"},children:""})]}),!he&&l.jsxs(l.Fragment,{children:[Ee.length>0&&l.jsx("div",{className:"rlist",children:Ee.map(V=>l.jsxs("div",{className:"rcard",onClick:()=>A(V),children:[V.thumbnailUrl?l.jsx("img",{className:"rcard-thumb",src:V.thumbnailUrl,alt:""}):l.jsx("div",{className:"rcard-placeholder",children:""}),l.jsxs("div",{className:"rcard-body",children:[l.jsx("div",{className:"rl-title",children:V.title}),l.jsxs("div",{className:"rl-meta",children:[V.source,"  ",V.time," min"]}),V.tags?.length>0&&l.jsx("div",{className:"rl-tags",children:l.jsx(Zl,{tags:V.tags})})]})]},V.id))}),Ne.length>0&&l.jsxs("div",{className:"radar-interleave",children:[l.jsx("div",{className:"radar-interleave-header",children:"Try Soon"}),Ne.map(V=>l.jsxs("div",{className:"radar-interleave-row",onClick:()=>W(V),children:[l.jsx("span",{className:"radar-interleave-icon",children:""}),l.jsx("span",{className:"radar-interleave-title",children:V.title}),V.source&&l.jsx("span",{className:"radar-interleave-source",children:V.source})]},V.id))]})]})]},de)})})(),M&&l.jsx(py,{item:M,onClose:()=>W(null),onPromote:()=>{g(M.id),W(null)},customCategories:y,onChangeCategory:C=>{const ce={...M,category:C};o(ce),W(ce)}}),P&&l.jsx(oy,{onClose:()=>D(!1),onAdd:C=>r(C),customTags:v,customCategories:y})]})}function gy({week:s,recipes:n,staples:r,onAddStaple:o,onCycleStaple:u,onRemoveStaple:d,regulars:f,onAddRegular:p,onRemoveRegular:g,fridge:v,onAddFridge:y,onCycleFridge:E,onRemoveFridge:j,freezer:x,onAddFreezer:A,onAdjustFreezerQty:P,onRemoveFreezer:D}){const[M,W]=O.useState(""),[F,H]=O.useState(""),[ae,le]=O.useState(""),[ie,be]=O.useState(""),je=R=>g(R),ye=R=>{const k=R.trim().toLowerCase();k&&!f.find(C=>C.name===k)&&p(k),H("")},Oe=R=>E(R),Le=R=>j(R),ke=R=>{const k=R.trim();k&&y(k,"ok"),le("")},Ue=(R,k)=>P(R,k),G=R=>D(R),we=R=>{const k=R.trim();k&&A(k,1),be("")},me=R=>u(R),q=R=>{const k=R.trim().toLowerCase();k&&!r.find(C=>C.name===k)&&o(k),W("")},ee=R=>d(R);return l.jsxs("div",{className:"tab-section",children:[l.jsxs("div",{style:{marginBottom:14},children:[l.jsx("div",{className:"page-title",children:"Pantry"}),l.jsx("div",{className:"page-date",children:"Regulars  fridge  freezer  staples"})]}),l.jsx("div",{className:"pantry-section-label",children:"Weekly regulars"}),l.jsxs("div",{className:"inv-card",style:{marginBottom:10},children:[l.jsx("div",{className:"pantry-pill-row",children:f.map(R=>l.jsxs("span",{className:"pantry-pill",children:[R.name,l.jsx("button",{className:"pp-remove",onClick:k=>{k.stopPropagation(),je(R.id)},children:""})]},R.id))}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add a weekly regular",value:F,onChange:R=>H(R.target.value),onKeyDown:R=>{R.key==="Enter"&&ye(F)}}),l.jsx("button",{className:"pantry-add-btn",disabled:!F.trim(),onClick:()=>ye(F),children:"Add"})]})]}),l.jsx("div",{className:"pantry-section-label",children:"Fridge"}),l.jsxs("div",{className:"inv-card",style:{marginBottom:10},children:[l.jsx("div",{className:"pantry-pill-row",children:v.map(R=>l.jsxs("span",{className:"pantry-pill fridge-"+R.s,onClick:()=>Oe(R.id),children:[R.item,l.jsx("button",{className:"pp-remove",onClick:k=>{k.stopPropagation(),Le(R.id)},children:""})]},R.id))}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add fridge item",value:ae,onChange:R=>le(R.target.value),onKeyDown:R=>{R.key==="Enter"&&ke(ae)}}),l.jsx("button",{className:"pantry-add-btn",disabled:!ae.trim(),onClick:()=>ke(ae),children:"Add"})]}),l.jsx("div",{style:{fontSize:10,color:"var(--ink4)",marginTop:6,fontStyle:"italic"},children:"Tap to toggle good  use soon"})]}),l.jsx("div",{className:"pantry-section-label",children:"Freezer"}),l.jsxs("div",{className:"inv-card",style:{marginBottom:10},children:[x.map(R=>l.jsxs("div",{className:"pantry-row",children:[l.jsx("span",{className:"pantry-row-name",children:R.item}),l.jsxs("div",{className:"fz-stepper",children:[l.jsx("button",{className:"fz-stepper-btn",onClick:()=>Ue(R.id,-1),children:""}),l.jsx("span",{className:"fz-stepper-val",children:R.qty}),l.jsx("button",{className:"fz-stepper-btn",onClick:()=>Ue(R.id,1),children:"+"}),l.jsx("span",{className:"fz-unit",children:"lb"})]}),l.jsx("button",{className:"pantry-row-remove",onClick:()=>G(R.id),children:""})]},R.id)),l.jsxs("div",{className:"pantry-add-row",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add freezer item",value:ie,onChange:R=>be(R.target.value),onKeyDown:R=>{R.key==="Enter"&&we(ie)}}),l.jsx("button",{className:"pantry-add-btn",disabled:!ie.trim(),onClick:()=>we(ie),children:"Add"})]})]}),l.jsx("div",{className:"pantry-section-label",children:"Staples"}),l.jsxs("div",{className:"inv-card",children:[l.jsx("div",{className:"pantry-pill-row",children:r.map(R=>l.jsxs("span",{className:"pantry-pill"+(R.status==="restock"?" fridge-soon":" fridge-ok"),onClick:()=>me(R.name),children:[R.name,l.jsx("button",{className:"pp-remove",onClick:k=>{k.stopPropagation(),ee(R.name)},children:""})]},R.name))}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add a staple",value:M,onChange:R=>W(R.target.value),onKeyDown:R=>{R.key==="Enter"&&q(M)}}),l.jsx("button",{className:"pantry-add-btn",disabled:!M.trim(),onClick:()=>q(M),children:"Add"})]}),l.jsx("div",{style:{fontSize:10,color:"var(--ink4)",marginTop:6,fontStyle:"italic"},children:"Tap to toggle stocked  needs restock"})]})]})}function vy({goals:s,updateGoal:n,customTags:r,onAddCustomTag:o,onRemoveCustomTag:u,customCategories:d,onAddCustomCategory:f,onRemoveCustomCategory:p,shopFilters:g,onAddShopFilter:v,onRemoveShopFilter:y,shopSectionKeywords:E,onAddShopSectionKeyword:j,onRemoveShopSectionKeyword:x,recipes:A,setRecipes:P}){const[D,M]=O.useState(""),[W,F]=O.useState(""),[H,ae]=O.useState(""),[le,ie]=O.useState({}),[be,je]=O.useState({}),[ye,Oe]=O.useState(null),[Le,ke]=O.useState(!1),Ue=async()=>{const G=A.filter(me=>me.url&&!me.thumbnailUrl);if(!G.length){Oe("All thumbnails up to date"),setTimeout(()=>Oe(null),2e3);return}ke(!0),Oe(`Fetching ${G.length} thumbnail${G.length>1?"s":""}`);let we=G.length;await Promise.all(G.map(async me=>{const{thumbnailUrl:q}=await cr(me.url);if(q){const ee={...me,thumbnailUrl:q};P(R=>R.map(k=>k.id===me.id?ee:k)),Hl(me.id,ee)}we--,we>0&&Oe(`Fetching ${we} thumbnail${we>1?"s":""}`)})),ke(!1),Oe("Done"),setTimeout(()=>Oe(null),2e3)};return l.jsxs("div",{className:"tab-section",children:[l.jsxs("div",{style:{marginBottom:18},children:[l.jsx("div",{className:"page-title",children:"Preferences"}),l.jsx("div",{className:"page-date",children:"Weekly goals & reminders"})]}),l.jsx("div",{style:{fontFamily:"'Playfair Display',serif",fontSize:13,fontStyle:"italic",color:"var(--ink3)",marginBottom:10},children:"Tracked automatically"}),l.jsxs("div",{className:"pref-card",style:{marginBottom:16},children:[l.jsxs("div",{className:"pref-item",children:[l.jsx("span",{className:"pi-icon",children:""}),l.jsx("span",{className:"pi-text",children:"Fish dinners per week"}),l.jsxs("div",{className:"pi-stepper",children:[l.jsx("button",{className:"pi-stepper-btn",disabled:s.fishMin<=0,onClick:()=>n("fishMin",-1),children:""}),l.jsx("div",{className:"pi-stepper-val",children:s.fishMin}),l.jsx("button",{className:"pi-stepper-btn",disabled:s.fishMin>=7,onClick:()=>n("fishMin",1),children:"+"})]})]}),l.jsxs("div",{className:"pref-item",children:[l.jsx("span",{className:"pi-icon",children:""}),l.jsx("span",{className:"pi-text",children:"Vegetarian dinners per week"}),l.jsxs("div",{className:"pi-stepper",children:[l.jsx("button",{className:"pi-stepper-btn",disabled:s.vegMin<=0,onClick:()=>n("vegMin",-1),children:""}),l.jsx("div",{className:"pi-stepper-val",children:s.vegMin}),l.jsx("button",{className:"pi-stepper-btn",disabled:s.vegMin>=7,onClick:()=>n("vegMin",1),children:"+"})]})]})]}),l.jsx("div",{style:{fontFamily:"'Playfair Display',serif",fontSize:13,fontStyle:"italic",color:"var(--ink3)",marginBottom:10},children:"Timing"}),l.jsx("div",{className:"pref-card",children:l.jsxs("div",{className:"pref-item",children:[l.jsx("span",{className:"pi-icon",children:""}),l.jsx("span",{className:"pi-text",children:"Dinner ready by"}),l.jsxs("div",{className:"pi-stepper",children:[l.jsx("button",{className:"pi-stepper-btn",onClick:()=>n("readyBy",-15),children:""}),l.jsx("div",{className:"pi-stepper-val",style:{width:42,fontSize:12},children:iy(s.readyBy)}),l.jsx("button",{className:"pi-stepper-btn",onClick:()=>n("readyBy",15),children:"+"})]})]})}),l.jsx("div",{className:"pantry-section-label",style:{marginTop:24},children:"Tags"}),l.jsxs("div",{className:"inv-card",style:{marginBottom:12},children:[l.jsxs("div",{className:"pantry-pill-row",style:{marginBottom:r.length?8:0},children:[["fish","vegetarian"].map(G=>l.jsx("span",{className:"pantry-pill",style:{opacity:.5,cursor:"default"},children:G==="fish"?" Fish":" Veg"},G)),r.map(G=>l.jsxs("span",{className:"pantry-pill",children:[G,l.jsx("button",{className:"pp-remove",onClick:()=>u(G),children:""})]},G))]}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add a tag",value:D,onChange:G=>M(G.target.value),onKeyDown:G=>{G.key==="Enter"&&D.trim()&&!["fish","vegetarian",...r].includes(D.trim().toLowerCase())&&(o(D.trim().toLowerCase()),M(""))}}),l.jsx("button",{className:"pantry-add-btn",disabled:!D.trim(),onClick:()=>{const G=D.trim().toLowerCase();G&&!["fish","vegetarian",...r].includes(G)&&(o(G),M(""))},children:"Add"})]})]}),l.jsx("div",{className:"pantry-section-label",children:"Categories"}),l.jsxs("div",{className:"inv-card",children:[l.jsxs("div",{className:"pantry-pill-row",style:{marginBottom:d.length?8:0},children:[[["dinner","Dinner"],["breakfast","Breakfast & Snacks"],["sweets","Sweets"]].map(([G,we])=>l.jsx("span",{className:"pantry-pill",style:{opacity:.5,cursor:"default"},children:we},G)),d.map(G=>l.jsxs("span",{className:"pantry-pill",children:[G,l.jsx("button",{className:"pp-remove",onClick:()=>p(G),children:""})]},G))]}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add a category",value:W,onChange:G=>F(G.target.value),onKeyDown:G=>{const we=["dinner","breakfast","sweets"];G.key==="Enter"&&W.trim()&&!we.includes(W.trim().toLowerCase())&&!d.includes(W.trim())&&(f(W.trim()),F(""))}}),l.jsx("button",{className:"pantry-add-btn",disabled:!W.trim(),onClick:()=>{const G=["dinner","breakfast","sweets"],we=W.trim();we&&!G.includes(we.toLowerCase())&&!d.includes(we)&&(f(we),F(""))},children:"Add"})]})]}),l.jsx("div",{className:"pantry-section-label",style:{marginTop:24},children:"Extra Shopping Filters"}),l.jsx("div",{style:{fontSize:11,color:"var(--ink4)",fontStyle:"italic",marginBottom:6},children:"Pantry staples are always filtered  add more here"}),l.jsxs("div",{className:"inv-card",style:{marginBottom:12},children:[l.jsx("div",{className:"pantry-pill-row",style:{marginBottom:g.length?8:0},children:g.map(G=>l.jsxs("span",{className:"pantry-pill",children:[G,l.jsx("button",{className:"pp-remove",onClick:()=>y(G),children:""})]},G))}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:"Add a filter",value:H,onChange:G=>ae(G.target.value),onKeyDown:G=>{G.key==="Enter"&&H.trim()&&!g.includes(H.trim().toLowerCase())&&(v(H.trim()),ae(""))}}),l.jsx("button",{className:"pantry-add-btn",disabled:!H.trim(),onClick:()=>{const G=H.trim().toLowerCase();G&&!g.includes(G)&&(v(G),ae(""))},children:"Add"})]})]}),l.jsx("div",{className:"pantry-section-label",style:{marginTop:24},children:"Shopping Sections"}),l.jsx("div",{style:{fontSize:11,color:"var(--ink4)",fontStyle:"italic",marginBottom:6},children:"Map ingredients to supermarket aisles"}),l.jsx("div",{className:"inv-card",style:{marginBottom:12},children:Ua.filter(G=>G.id!=="other").map(G=>{const we=(E[G.id]||[]).slice().sort(),me=le[G.id],q=be[G.id]||"";return l.jsxs("div",{style:{borderBottom:"1px solid var(--border2)"},children:[l.jsxs("div",{className:"pref-section-row",onClick:()=>ie(ee=>({...ee,[G.id]:!ee[G.id]})),children:[l.jsxs("span",{children:[G.label," ",l.jsxs("span",{style:{fontSize:11,color:"var(--ink4)",fontWeight:400},children:["(",we.length,")"]})]}),l.jsx("span",{style:{fontSize:9,color:"var(--ink4)",transition:"transform 0.2s",display:"inline-block",transform:me?"rotate(0deg)":"rotate(-90deg)"},children:""})]}),me&&l.jsxs("div",{style:{padding:"0 12px 10px"},children:[l.jsx("div",{className:"pantry-pill-row",style:{marginBottom:6},children:we.map(ee=>l.jsxs("span",{className:"pantry-pill",style:{fontSize:11},children:[ee,l.jsx("button",{className:"pp-remove",onClick:()=>x(G.id,ee),children:""})]},ee))}),l.jsxs("div",{className:"pantry-pill-add",children:[l.jsx("input",{className:"pantry-add-input",placeholder:`Add to ${G.label}`,value:q,style:{fontSize:11},onChange:ee=>je(R=>({...R,[G.id]:ee.target.value})),onKeyDown:ee=>{ee.key==="Enter"&&q.trim()&&(j(G.id,q.trim()),je(R=>({...R,[G.id]:""})))}}),l.jsx("button",{className:"pantry-add-btn",disabled:!q.trim(),style:{fontSize:11,padding:"6px 10px"},onClick:()=>{q.trim()&&(j(G.id,q.trim()),je(ee=>({...ee,[G.id]:""})))},children:"Add"})]})]})]},G.id)})}),l.jsx("div",{className:"pantry-section-label",style:{marginTop:24},children:"Thumbnails"}),l.jsxs("div",{className:"inv-card",style:{padding:"12px 14px",display:"flex",alignItems:"center",gap:10},children:[l.jsx("button",{className:"btn btn-primary",style:{fontSize:12,padding:"8px 14px"},disabled:Le,onClick:Ue,children:"Fetch missing thumbnails"}),ye&&l.jsx("span",{style:{fontSize:12,color:"var(--ink3)"},children:ye})]})]})}const yy=[{id:"week",icon:"",label:"Week"},{id:"recipes",icon:"",label:"Recipes"},{id:"pantry",icon:"",label:"Pantry"},{id:"prefs",icon:"",label:"Prefs"}];function wy(){const[s,n]=O.useState(!0),[r,o]=O.useState(()=>localStorage.getItem("mp-tab")||"week"),u=_=>{o(_),localStorage.setItem("mp-tab",_)},[d,f]=O.useState({fishMin:1,vegMin:2,readyBy:"18:30"}),[p,g]=O.useState([]),[v,y]=O.useState([]),[E,j]=O.useState([]),[x,A]=O.useState([]),[P,D]=O.useState({}),[M,W]=O.useState({}),[F,H]=O.useState([]),[ae,le]=O.useState(!1),[ie,be]=O.useState([]),[je,ye]=O.useState([]),[Oe,Le]=O.useState([]),[ke,Ue]=O.useState([]),[G,we]=O.useState(Oh),[me,q]=O.useState([]),[ee,R]=O.useState([]),[k,C]=O.useState([]),[ce,pe]=O.useState({}),[$,oe]=O.useState(0),[de,Ee]=O.useState(!1),Ne=O.useRef(null),K=O.useRef(!1),he=O.useRef(null),V=60,re=_=>{if(de)return;const N=he.current;N&&N.scrollTop===0&&(Ne.current=_.touches[0].clientY,K.current=!1)},X=O.useRef(!1);X.current=de;const se=O.useRef(0),Fe=_=>{if(X.current||Ne.current===null)return;const N=_.touches[0].clientY-Ne.current;if(N>0){K.current=!0;const U=Math.min(N*.4,80);se.current=U,oe(U),N>10&&_.preventDefault()}else K.current||(Ne.current=null)},ot=async()=>{if(Ne.current!==null&&(Ne.current=null,!X.current)){if(se.current>=V){Ee(!0),oe(V*.6);try{await Rt()}catch(_){console.error("refresh failed",_)}Ee(!1)}oe(0),se.current=0}};O.useEffect(()=>{const _=he.current;if(_)return _.addEventListener("touchmove",Fe,{passive:!1}),()=>_.removeEventListener("touchmove",Fe)});const Rt=async()=>{const[_,N,U,te,$e,rt,Qe,qe,Ke,Yt,ft,Fa,Ba,Ma,zr,gr]=await Promise.all([sv(),ah(),pv(),yv(),kv(),jv(),Cv(),Rv(),Iv(),ch(),Wv(),Kv(),Jv(),Xv(),Dv(),zv()]);y(_.map(Dr)),await cv(dt);const vr=await ih(dt);g(vr),R(N),be(U),q(te),j($e),A(rt),f(Qe),ye(qe),Le(Ke),W(Yt),D(ft),H(Fa),C(Ba),pe(Ma),Ue(zr),Object.keys(gr).length>0&&we(gr)},St=()=>{ue.channel("week_plan_items").on("postgres_changes",{event:"*",schema:"public",table:"week_plan_items"},()=>{ih(dt).then(g)}).subscribe(),ue.channel("batch_prep").on("postgres_changes",{event:"*",schema:"public",table:"batch_prep"},()=>{ah().then(R)}).subscribe(),ue.channel("shop_checked").on("postgres_changes",{event:"*",schema:"public",table:"shop_checked"},()=>{ch().then(W)}).subscribe()};O.useEffect(()=>{async function _(){try{await Rt()}catch(N){console.error("loadAll failed",N)}n(!1)}return _(),St(),()=>ue.removeAllChannels()},[]),O.useEffect(()=>{let _=!1;const N=async()=>{if(!_){_=!0;try{await Rt()}catch(Ke){console.error("reconnect refresh failed",Ke)}ue.removeAllChannels(),St(),_=!1}},U=()=>{document.visibilityState==="visible"&&N()},te=()=>N(),$e=()=>N(),rt=()=>N();document.addEventListener("visibilitychange",U),window.addEventListener("focus",te),window.addEventListener("pageshow",$e),window.addEventListener("online",rt);const Qe=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;let qe=null;return Qe&&(qe=setInterval(()=>{const Ke=ue.getChannels();(Ke.length===0||Ke.some(ft=>ft.state!=="joined"))&&(ue.removeAllChannels(),St())},3e4)),()=>{document.removeEventListener("visibilitychange",U),window.removeEventListener("focus",te),window.removeEventListener("pageshow",$e),window.removeEventListener("online",rt),qe&&clearInterval(qe)}},[]);const mt=async _=>{try{const N=await Ll(_);y(U=>[...U,Dr(N)])}catch(N){console.error(N)}},z=async _=>{y(N=>N.map(U=>U.id===_.id?_:U));try{await Hl(_.id,_)}catch(N){console.error(N)}},Ie=async _=>{y(N=>N.filter(U=>U.id!==_));try{await sh(_)}catch(N){console.error(N)}},Be=v.filter(_=>_.inLibrary),Ge=v.filter(_=>!_.inLibrary),Ze=async(_,N)=>{const te=(p[_]?.items||[]).length;if(N._needsInsert)try{const $e=await Ll(N),rt=Dr($e);y(qe=>[...qe,rt]);const Qe=await Dl(dt,_,{itemType:"recipe",recipeId:rt.id,ingredients:rt.ingredients,cookTime:rt.time,thumbnailUrl:rt.thumbnailUrl,sortOrder:te});g(qe=>qe.map((Ke,Yt)=>Yt===_?{...Ke,items:[...Ke.items,Qe]}:Ke))}catch($e){console.error($e)}else{const $e="temp-"+Date.now(),rt={id:$e,itemType:"recipe",recipe:N,ingredients:N.ingredients||[],cookTime:N.time,thumbnailUrl:N.thumbnailUrl,note:null,sortOrder:te};g(Qe=>Qe.map((qe,Ke)=>Ke===_?{...qe,items:[...qe.items,rt]}:qe));try{const Qe=await Dl(dt,_,{itemType:"recipe",recipeId:N.id,ingredients:N.ingredients,cookTime:N.time,thumbnailUrl:N.thumbnailUrl,sortOrder:te});g(qe=>qe.map((Ke,Yt)=>Yt===_?{...Ke,items:Ke.items.map(ft=>ft.id===$e?Qe:ft)}:Ke))}catch(Qe){console.error(Qe)}}},sn=async(_,N)=>{const te=(p[_]?.items||[]).length,$e="temp-"+Date.now(),rt={id:$e,itemType:"note",recipe:null,ingredients:[],cookTime:null,thumbnailUrl:null,note:N.trim(),sortOrder:te};g(Qe=>Qe.map((qe,Ke)=>Ke===_?{...qe,items:[...qe.items,rt]}:qe));try{const Qe=await Dl(dt,_,{itemType:"note",note:N.trim(),sortOrder:te});g(qe=>qe.map((Ke,Yt)=>Yt===_?{...Ke,items:Ke.items.map(ft=>ft.id===$e?Qe:ft)}:Ke))}catch(Qe){console.error(Qe)}};O.useEffect(()=>{g(_=>_.map(N=>({...N,items:N.items.map(U=>{if(!U.recipe)return U;const te=v.find($e=>$e.id===U.recipe.id);return te&&te!==U.recipe?{...U,recipe:te}:U})})))},[v]);const bn=async _=>{g(N=>N.map(U=>({...U,items:U.items.filter(te=>te.id!==_)})));try{await iv(_)}catch(N){console.error(N)}},an=async(_,N,U)=>{if(N===U)return;const $e=p[N]?.items.find(Qe=>Qe.id===_);if(!$e)return;const rt=p[U].items.length;g(Qe=>Qe.map((qe,Ke)=>Ke===N?{...qe,items:qe.items.filter(Yt=>Yt.id!==_)}:Ke===U?{...qe,items:[...qe.items,{...$e,sortOrder:rt}]}:qe));try{await av(_,U,rt)}catch(Qe){console.error(Qe)}},$n=async _=>{g(N=>N.map((U,te)=>te===_?{...U,items:[]}:U));try{await ov(dt,_)}catch(N){console.error(N)}},Qt=async()=>{g(Ah.map(_=>({day:_,items:[]}))),R([]),D({});try{await lv(dt),await dv(dt)}catch(_){console.error(_)}},Wt=async _=>{if(_._needsInsert)try{const N=await Ll(_),U=Dr(N);y(te=>[...te,U]),R(te=>[...te,U]),await oh(dt,U.id)}catch(N){console.error(N)}else{R(N=>[...N,_]);try{await oh(dt,_.id)}catch(N){console.error(N)}}},jn=async _=>{R(N=>N.filter(U=>U.id!==_));try{await uv(dt,_)}catch(N){console.error(N)}},zn=async _=>{try{const N=await hv(_);y(U=>[N,...U]),N.url&&cr(N.url).then(({thumbnailUrl:U,scrapedData:te})=>{if(!U&&!te)return;const $e={...N};U&&($e.thumbnailUrl=U),te&&(te.title&&($e.title=te.title),te.cookTime&&($e.time=te.cookTime),te.ingredients?.length&&($e.ingredients=te.ingredients,$e.rawIngredients=te.ingredients),te.instructions?.length&&($e.instructions=te.instructions),te.description&&($e.description=te.description),te.servings&&($e.servings=te.servings)),y(rt=>rt.map(Qe=>Qe.id===N.id?$e:Qe)),g(rt=>rt.map(Qe=>({...Qe,items:Qe.items.map(qe=>qe.recipe?.id===N.id?{...qe,recipe:$e}:qe)}))),Hl(N.id,$e)}).catch(U=>console.error("radar scrape failed",U))}catch(N){console.error(N)}},Q=async _=>{y(N=>N.filter(U=>U.id!==_));try{await sh(_)}catch(N){console.error(N)}},Te=async _=>{y(N=>N.map(U=>U.id===_?{...U,inLibrary:!0}:U));try{await fv(_)}catch(N){console.error(N)}},Ve=(_,N)=>f(U=>{let te;if(_==="readyBy"){const $e=Lh(U.readyBy)+N,rt=Math.max(960,Math.min(1260,$e));te={...U,readyBy:Dh(rt)}}else te={...U,[_]:Math.max(0,Math.min(7,U[_]+N))};return Tv(te),te}),Je=async(_,N)=>{try{const U=await mv(_,N);be(te=>[...te,U])}catch(U){console.error(U)}},Nn=async _=>{let N;be(U=>U.map(te=>te.id===_?(N=te.s==="ok"?"soon":"ok",{...te,s:N}):te));try{await gv(_,{s:N})}catch(U){console.error(U)}},on=async _=>{be(N=>N.filter(U=>U.id!==_));try{await vv(_)}catch(N){console.error(N)}},ur=async(_,N)=>{try{const U=await wv(_,N);q(te=>[...te,U])}catch(U){console.error(U)}},vn=async(_,N)=>{let U;q(te=>te.map($e=>$e.id===_?(U=Math.max(0,($e.qty??1)+N),{...$e,qty:U}):$e).filter($e=>$e.qty>0));try{U===0?await lh(_):await _v(_,{qty:U})}catch(te){console.error(te)}},yn=async _=>{q(N=>N.filter(U=>U.id!==_));try{await lh(_)}catch(N){console.error(N)}},dr=async _=>{j(N=>[...N,{name:_,status:"ok"}]);try{await Sv(_)}catch(N){console.error(N)}},hr=async _=>{let N;j(U=>U.map(te=>te.name===_?(N=te.status==="ok"?"restock":"ok",{...te,status:N}):te));try{await xv(_,N)}catch(U){console.error(U)}},fr=async _=>{j(N=>N.filter(U=>U.name!==_));try{await bv(_)}catch(N){console.error(N)}},Fn=async _=>{try{const N=await Nv(_);A(U=>[...U,N])}catch(N){console.error(N)}},Bn=async _=>{A(N=>N.filter(U=>U.id!==_));try{await Ev(_)}catch(N){console.error(N)}},pr=async _=>{ye(N=>[...N,_]);try{await Pv(_)}catch(N){console.error(N)}},B=async _=>{ye(N=>N.filter(U=>U!==_));try{await Ov(_)}catch(N){console.error(N)}},Ce=async _=>{Le(N=>[...N,_]);try{await Av(_)}catch(N){console.error(N)}},Me=async _=>{Le(N=>N.filter(U=>U!==_));try{await Lv(_)}catch(N){console.error(N)}},Xe=async _=>{const N=_.toLowerCase().trim();if(!(!N||ke.includes(N))){Ue(U=>[...U,N]);try{await Uv(N)}catch(U){console.error(U)}}},wn=async _=>{Ue(N=>N.filter(U=>U!==_));try{await $v(_)}catch(N){console.error(N)}},yt=async(_,N)=>{const U=N.toLowerCase().trim();if(U){we(te=>{const $e=te[_]||[];return $e.includes(U)?te:{...te,[_]:[...$e,U]}});try{await Fv(_,U)}catch(te){console.error(te)}}},Ur=async(_,N)=>{we(U=>({...U,[_]:(U[_]||[]).filter(te=>te!==N)}));try{await Bv(_,N)}catch(U){console.error(U)}},mr=async _=>{const N=M[_];W(U=>N?Object.fromEntries(Object.entries(U).filter(([te])=>te!==_)):{...U,[_]:!0});try{await Mv(dt,_,!N)}catch(U){console.error(U)}},$r=async _=>{const N=P[_];D(U=>N?Object.fromEntries(Object.entries(U).filter(([te])=>te!==_)):{...U,[_]:!0});try{await qv(dt,_,!N)}catch(U){console.error(U)}},hi=async _=>{try{const N=await Vv(_);H(U=>[...U,N])}catch(N){console.error(N)}},fi=async _=>{let N;H(U=>U.map(te=>te.id===_?(N=!te.done,{...te,done:N}):te));try{await Hv(_,{done:N})}catch(U){console.error(U)}},pi=async _=>{H(N=>N.filter(U=>U.id!==_));try{await Gv(_)}catch(N){console.error(N)}},En=async _=>{try{const N=await Qv(dt,_);C(U=>[...U,N])}catch(N){console.error(N)}},mi=async _=>{let N;C(U=>U.map(te=>te.id===_?(N=!te.done,{...te,done:N}):te));try{await Yv(_,{done:N})}catch(U){console.error(U)}},gi=async _=>{const N=ce[_];pe(U=>N?Object.fromEntries(Object.entries(U).filter(([te])=>te!==_)):{...U,[_]:!0});try{await Zv(dt,_,!N)}catch(U){console.error(U)}};if(s)return l.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",fontFamily:"Playfair Display,serif",fontSize:18,color:"var(--ink3)"},children:"Loading"});const $a=E.filter(_=>_.status==="ok").map(_=>_.name.toLowerCase()),vi=me.map(_=>_.item.toLowerCase()),yi=ie.map(_=>_.item.toLowerCase()),wi=p.flatMap(_=>_.items.filter(N=>N.recipe?.ingredients?.length)).flatMap(_=>_.recipe.ingredients).filter(_=>!$a.includes(_.toLowerCase())&&!vi.includes(_.toLowerCase())&&!yi.includes(_.toLowerCase())),_s=E.filter(_=>_.status==="restock").length,_i=x.filter(_=>!P[_.id]).length;_i+[...new Set(wi)].filter(_=>!M["Mon:"+_]&&!M["Tue:"+_]).length+_s+F.filter(_=>!_.done).length;const za={week:l.jsx(fy,{goals:d,week:p,recipes:Be,onOpenShop:()=>le(!0),shopCount:_i+_s,fridge:ie,freezer:me,staples:E,regulars:x,regChecked:P,shopChecked:M,freeShop:F,radar:Ge,customTags:je,customCategories:Oe,batch:ee,prepTasks:k,prepChecked:ce,onAddItem:Ze,onRemoveItem:bn,onMoveItem:an,onClearDay:$n,onAddNote:sn,onAddRecipe:mt,onUpdateRecipe:z,onDeleteRecipe:Ie,onWeekReset:Qt,onPromoteRadar:Te,onAddBatch:Wt,onRemoveBatch:jn,onAddPrepTask:En,onTogglePrepTask:mi,onTogglePrepChecked:gi,onToggleRegChecked:$r,onToggleShopChecked:mr,onAddFreeShop:hi,onToggleFreeShop:fi,onRemoveFreeShop:pi,shopFilters:ke,shopSectionKeywords:G,onAdjustFreezerQty:vn}),recipes:l.jsx(my,{recipes:v,library:Be,onAddRecipe:mt,onUpdateRecipe:z,onDeleteRecipe:Ie,radar:Ge,onAddRadar:zn,onRemoveRadar:Q,onPromoteRadar:Te,customTags:je,customCategories:Oe}),pantry:l.jsx(gy,{week:p,recipes:v,staples:E,onAddStaple:dr,onCycleStaple:hr,onRemoveStaple:fr,regulars:x,onAddRegular:Fn,onRemoveRegular:Bn,fridge:ie,onAddFridge:Je,onCycleFridge:Nn,onRemoveFridge:on,freezer:me,onAddFreezer:ur,onAdjustFreezerQty:vn,onRemoveFreezer:yn}),prefs:l.jsx(vy,{goals:d,updateGoal:Ve,customTags:je,onAddCustomTag:pr,onRemoveCustomTag:B,customCategories:Oe,onAddCustomCategory:Ce,onRemoveCustomCategory:Me,shopFilters:ke,onAddShopFilter:Xe,onRemoveShopFilter:wn,shopSectionKeywords:G,onAddShopSectionKeyword:yt,onRemoveShopSectionKeyword:Ur,recipes:v,setRecipes:y})};return l.jsx(l.Fragment,{children:l.jsxs("div",{className:"app",children:[l.jsxs("div",{className:"content",ref:he,onTouchStart:re,onTouchEnd:ot,children:[($>0||de)&&l.jsx("div",{className:"pull-indicator",style:{transform:`translateY(${$-36}px)`},children:l.jsx("span",{className:"pull-spinner"+(de?" spinning":""),style:de?void 0:{transform:`rotate(${$*4}deg)`},children:""})}),za[r]]}),ae&&l.jsx(ly,{onClose:()=>le(!1),week:p,staples:E,freezer:me,fridge:ie,regulars:x,onAddRegular:Fn,onRemoveRegular:Bn,regChecked:P,onToggleRegChecked:$r,shopChecked:M,onToggleShopChecked:mr,freeShop:F,onAddFreeShop:hi,onToggleFreeShop:fi,onRemoveFreeShop:pi,shopFilters:ke,shopSectionKeywords:G}),l.jsx("nav",{className:"tabs",children:yy.map(_=>l.jsxs("div",{className:"tab"+(r===_.id?" active":""),onClick:()=>u(_.id),children:[l.jsx("span",{className:"tab-icon",children:_.icon}),l.jsx("span",{className:"tab-label",children:_.label})]},_.id))})]})})}Ep.createRoot(document.getElementById("root")).render(l.jsx(O.StrictMode,{children:l.jsx(wy,{})}));
